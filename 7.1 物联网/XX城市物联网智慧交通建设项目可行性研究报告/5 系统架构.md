# 5.1 软件系统层次模型

呼市智能交通管理平台系统主要包括三层模型，分为：用户界面层、中间应用层（逻辑层）、数据管理层。利用不同的层次结构上所完成的功能不同可以实现灵活的软件开发、系统部署、系统升级。同时，当系统需求变化时可以实现快速的响应。其系统架构图如下所示：

![image-20210817144326101](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144326101.png)

数据管理层主要由中心综合数据库、子系统数据库和元数据库子系统组成，中间层应用层是由应用服务器、消息应用服务器、GIS服务器和WEB服务器组成，用户界面层主要是用户界面层针对不同的用户提供了不同的用户应用界面。用户界面层从功能上包括了指挥调度操控平台、公安内网信息发布平台、面向社会信息发布平台的数据接口三部分；从表现形式上，采用系统C/S应用及B/S应用，由一些图形界面组成。

## 5.1.1 用户界面层

用户终端提供给用户交互操作接口，供用户访问系统。用户界面层针对不同的用户提供了不同的用户应用界面。用户界面层从功能上包括了指挥调度操控平台、公安内网信息发布平台、面向社会信息发布平台的数据接口三部分；从表现形式上，包括了C/S应用及B/S应用。

## 5.1.2 中间应用层

承担事物处理的中间环节，负责和控制数据库操作，接受和处理客户端请求，负责系统的业务逻辑处理以及提供各类应用服务。中间层主要包括了消息服务中间件、支持Web Service的Web应用中间件、GIS管理中间件等。

Web应用中间件的功能主要有两个，一个是对其他应用或指挥控制集成系统的客户端提供Web Service服务，另一个功能是提供Web Server从而保证系统的B/S应用。

## 5.1.3 数据层管理层

数据层集中了系统的主要数据，完成数据库管理。以 Oracle 10g数据库为管理工具，对交通管理中所产生的数据进行统一的管理。

## 5.1.4 集成接口规范层

集成接口是指挥控制集成系统建设中的关键内容，该层涉及到其他技术子系统、交通管理数据中心以及其他外部的系统。通过这个集成接口规范指挥控制集成系统可以获取其他系统的信息，同时也能够向其他系统下达控制指令。

集成接口规范包括三类，

一类是统一消息接口，主要是用于对其他子系统进行控制与调度时使用，利用消息机制可以保证系统高效地工作，而不必为等待事件的发生加大计算机系统的开销；

第二类是数据访问接口，采用最新的Web Service技术实现数据访问接口，平台除了集成和控制接口以外，还需要提供公共的数据访问接口，包括数据采集、数据共享、安全认证等功能

第三类是地理信息数据接口（远程调用）。交通系统管理平台与PGIS地理信息基础平台之间通过地理信息接口进行数据调用与同步，将交通系统管理平台所用的地理信息数据定期从PGIS地理信息基础平台进行同步。

# 5.2 信息流架构

按照《公安交通指挥系统建设技术规范（GA/T445-2010）》的要求，智能交通管理集成系统可分为信息采集、集成指挥平台（信息交互与关联）、控制与发布三个环节。信息采集部分主要指业务系统，包含已集成到目前的业务系统和待接入的业务系统；集成指挥平台部分负责信息处理，包括地理信息系统、指挥调度系统、警卫任务系统、路况监控系统、集成应用系统、预案管理系统、勤务管理系统、事故预防与分析、机构人员管理等系统；信息控制和发布部分包括流量控制系统、网站和信息发布、查缉布控系统、交通管理综合查询、流量诱导、交通管制管理信息等系统。呼市智能交通管理平台信息流结构如下图所示：

![image-20210817144505125](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144505125.png)

# 5.3 业务架构与功能

根据不同的业务需求对智能交通管理平台进行功能划分，以集成指挥平台为核心，以路况监控、评估预警、交通信号控制、缉查布控、信息服务、业务管理等相关功能为组件，形成既相互独立又密切相关的业务体系；将呼市智能交通管理平台根据业务划分为六个部分，也即是一个指挥调度平台、五个业务应用体系。彼此既相互独立，完成一定的业务功能；又相互联系，互相提供一定的业务和数据的支持，如下图所示：

![image-20210817144530485](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144530485.png)

各业务体系具体地功能划分如下表所示：

![image-20210817144546620](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144546620.png)

![image-20210817144557061](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144557061.png)

![image-20210817144604803](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144604803.png)

# 5.4 系统性能

## 5.4.1 据精度

时间数据：可以精确到秒。

GIS经纬度数据：对于GIS的经纬度能够精确到小数点后6位。

GIS地图的显示：使用矢量地图和栅格地图。

## 5.4.2 时间响应

1）	查询的响应

数据查询响应：一般业务查询，总历时小于2秒。对于日、周、月的统计性查询，总历时小于5秒；

外场系统实时数据刷新：外场系统的实时数据采集到达智能交通管理平台软件，一般延时小于2秒，最大延时不超过5秒。

2）	指令响应

​	外场系统控制指令响应：从向外场系统发布控制指令始，到外场系统返回执行结果，总历时小于5秒；

​	平台参数设置响应：从向交通信息核心处理服务发送参数设置指令始，到核心处理服务返回执行结果，总历时小于1秒；

3）	GIS操作响应

​	地名查询响应：总历时小于1秒；

​	地图放大（缩小）响应：总历时小于1秒；

​	距离计算响应：总历时小于1秒；

​	路径选择响应：总历时小于3秒。

4）	频道切换响应：

​	从向CCTV控制主机发送频道切换指令到新画面切换到座席显示器（或者是指定大屏幕）的时间，小于3秒。

5）	大屏幕切换响应：

​	从大屏幕控制程序界面执行切换大屏幕的指令到大屏幕切换完毕的时间，小于3秒。

6）	并发访问数：

​	一小时访问人数：300

​	同时在线人数：150

​	并发访问量：80

7）	信息容量

​	流量数据：千万级

​	卡口（图片）数据：500万级

​	违法数据：百万级

8）	故障处理

​	集成软件软件故障：集成指挥平台软件（包括服务器上运行的应用服务和座席计算机运行的客户端）具有详细的运行日志，保证系统出现意外退出（如系统Bug）情况时，能很快地定位故障点；

​	集成指挥平台不会出现大面积的软件故障。

​	智能交通管理平台平均无故障时间：3000小时。

## 5.4.3 易维护性

​	智能交通管理平台系统的所有操作都有日志记录，保证人为操作失误时可以进行跟踪。

​	集成指挥平台第一次运行需求进行初始化的操作。

​	提供操作者操作5步以上回退功能。

# 5.5 系统部署规划

## 5.5.1 服务器部署规划

![image-20210817144745646](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144745646.png)

### 5.5.1.1 信号控制系统

![image-20210817144809766](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144809766.png)

### 5.5.1.2 视频监控系统

![image-20210817144832123](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144832123.png)

### 5.5.1.3 交通诱导系统

![image-20210817144856998](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144856998.png)

### 5.5.1.4 智能交通管理平台

![image-20210817144922471](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144922471.png)

![image-20210817144932884](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144932884.png)

![image-20210817144944068](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144944068.png)

![image-20210817144954182](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817144954182.png)

## 5.5.2 系统软件部署

![image-20210817145026213](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817145026213.png)

# 5.6 系统技术路线

## 5.6.1 软件总体技术路线

集成指挥平台是一个构建在各业务子系统之上的大型指挥调度系统。通过集成指挥平台，实现系统间的关联与交互、信息共享、集成联动，实现各子系统所无法单独完成的功能，为指挥调度提供综合性资源。集成指挥平台有其自身明显的应用特性，如：需要统一身份验证、系统间信息交互采用统一规范的集成协议、各系统间的数据-功能分层支撑、平台内实现业务综合应用、实时控制与数据分析应用并存。

集成指挥平台规划统一的身份验证机制，实现权限的统一管理，无论用户工作关注点是什么，所用智能交通管理平台的哪个组成部分，在整体智能交通管理平台上，他只有一个登陆用户名，系统管理员仅需要对此用户进行授权管理。

集成指挥平台各功能模块内聚封闭，对外接口抽象规范，模块间服务关系层次化。集成指挥平台在面向事件的指挥调度的实现中，综合管理控制类的应用和数据分析类应用，实现对警情周边警力资源、设备资源与预案信息的综合应用，完成警情处置。各控制系统提供的多种控制功能和多数据源分析获得的各类研判结果有相对的独立性，所以要采用模块功能内聚和多层构建的技术路线。各功能模块完成相对独立的功能，模块与模块之间有层次性的服务关系，某些模块提供业务无关的通用性基础服务，某些模块提供跨业务领域的基础服务，还有一些模块提供业务领域服务功能。业务应用实现时采用规范的接口调用方式，进行功能模块的顺序调用。

集成指挥平台与子系统的集成技术路线贯彻松散耦合的原则。智能交通管理平台需要集成的功能子系统、设备多样，各子系统的实现技术各异，各设备提供的SDK技术途径不同，所以必须抽象出规范的接口定义，包括接口调用流程、数据项和技术实现方式。对于接口调用流程和数据项，依托于业务分析、梳理、抽象，形成标准的基础流程、信息项和扩展流程、数据项，实现弹性应对系统接入。接口技术实现必须采用与开发工具无关和操作系统无关的技术手段，达到系统接入技术的广泛适应性。集成指挥调度平台接口规范正是采用此指导思想，应用TCP socket通讯技术加XML消息体的方式并用消息总线的机制，形成大多数的控制类应用的接口规范；部分数据交互交口采用webService技术实现；部分数据交互采用oracle数据库中间表、视图、存储过程的方式。以上三种集成技术路线可以应对全部的集成技术需求。

集成指挥平台应用需求存在两个明显的特征：实时控制类和数据分析展示类。对于实时控制类，用户群相对固定且数量有限（如：指挥调度，主要应用部门为主分控两级指挥中心），要求实时响应，需要复杂的协议转换和逻辑控制，对客户机具有了一定的数据处理和数据存储能力，所以适合采用C/S技术路线，实现把应用软件的计算和数据合理地分配在客户机和服务器两端，有效地降低网络通信量和服务器运算量。对于数据分析、研判展现，用户群数量不固定且基数较大（如：态势监控，有大量且不固定的公安网用户），对响应时间没有实时性要求，适合采用B/S技术路线，可以在任何地方进行操作，且相对而言不用安装任何专门的软件，降低了维护成本。

## 5.6.2 子系统建设技术路线

子系统建设总体技术路线采用自身功能模块内聚封闭和接口抽象规范的原则，业务实现按需通过接口调用多层次功能模块，完成业务功能。子系统的设备接入方采用抽象规范的接口原则，由各个适配程序完成设备接入。子系统与智能交通管理平台的对接方式遵循上述集成指挥平台接口规范。各子系统承建商完成自建的子系统功能，实现自运转。对智能交通管理平台的遵循接口规范实现系统信息共享、联动控制。

GIS应用总体技术路线为在警用GIS规范的基础上结合公安交通指挥调度应用对路网等数据的要求，扩展形成公安交通GIS数据规范，进行路网元素、路网分层、拓扑关系、公共基础GIS信息、公安交通专用GIS信息的加工，为集成指挥平台提供地理信息基础数据。遵循公安交通GIS数据规范形成公安交通专题应用。对于C/S应用，采用ARC SDE技术路线。对于B/S应用，采用栅格地图技术路线。由于采用同一GIS数据源，在配图风格、图元符号、图标上完全一致，所以C/S、B/S展现具有良好的一致性。

## 5.6.3 网络总体技术路线

呼市公安交通集成指挥平台已建和正在建设的设备包括信号机、摄像机/编码器、诱导屏/控制卡、电警、卡口、DLP大屏/控制系统等，分布在快速路、主/次干路等外场，需要大量的IP资源。支队/大队机房有大量的服务器、存储设备，也需要IP资源。一则公安网IP资源有限，不能满足规模不断扩大的外场设备IP需求；二则外场网络不可控，存在巨大的安全隐患，一旦接入外场网络，就可以在没有任何安全防范的情况下进入公安网内部，破坏后果可能很严重。所以，本次网络建设的两个目标是：首先，将所有外场设备及机房设备划归局域网（称智能交通专网），将公安网和智能交通专网分开；其次，对所有智能交通专网IP资源进行规划，形成统一的、可管理的智能交通专网。

智能交通专网又需要与公安网实现数据交互（如：三台合一、机动车、驾驶员、事故、违法等），通过在市公安局建设的边界接入平台完成。

智能交通专网也需要与公网实现数据交互（如：GPS、PDA），通过网络安全隔离技术实现智能交通专网安全。

# 5.7 三网信息交互机制

## 5.7.1 概述

本系统应用需要三网（“智能交通专网”、“公安网”、“公网”）间实现数据交互。

智能交通专网是本系统建设的主体，所有外场设备，通过各路口接入层/汇聚接入层/骨干接入层，直至核心服务层，同时按照就近原则完成部分设备直接接入汇聚接入层/骨干接入层/核心接入层，形成了整个一个树状设备网络拓扑结构。

智能交通专网需要“三台合一之事故报警”、“机动车信息”、“驾驶员信息”、“事故信息”、“违法信息”，公安网可以提供这些信息。同时，智能交通专网之集成指挥平台提供交通态势监控，各级公安机关需要访问此信息。双方信息的交互必须通过市局统一建设的边界接入平台。

智能交通专网需要“警车GPS”、“PDA信息”等，而这些系统建设在公网或必须通过公网才能实现信息交互。双方信息的交互必须通过网络安全接入平台 。

本系统承建的信息相互访问时，不会出现公网直接访问公安网或反之的情况。双方的交互一定通过智能交通专网完成。

## 5.7. 2 智能交通专网相关系统

l 信号控制系统（UTC）

l 诱导系统（VMS）

l 视频监控系统（CCTV）

l 流量采集系统

l 手动违法抓拍系统（DPC）

l 集成大屏系统

l 集成电子警察系统（PMS）

l 集成卡口系统（TGS）

## 5.7. 3 公安网相关系统

l 指挥调度系统

l 路况监控系统

l 特勤任务系统

l 集成应用系统

l 事故预防分析系统

l 综合研判系统

l 违法后处理网站

l 稽查布控系统

l 查控分析系统

## 5.7.4 公网相关系统

l 警车GPS

l PDA信息

l 交警信息网

## 5.7.5 数据交换介质

l 网闸

l 边界接入平台

![image-20210817145243677](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210817145243677.png)

## 5.7.6 数据交互

l 集成应用模块信号子系统与UTC信号控制系统数据交互

灯态消息交互

中心手动控制消息交互

方案编辑下方与UTC系统的交互

l 集成应用模块大屏子系统（DLP）与大屏系统数据交互

开关屏、模式获取与大屏子系统协议交互

组和屏与大屏子系统的消息交互

l 集成应用模块诱导子系统（VMS）与诱导管理系统数据交互

路况图与诱导发布系统的FTP传输

诱导控制消息、发布消息与诱导系统的交互

l 集成应用模块视频监控子系统（CCTV）与视频监控系统数据交互

视频浏览与视频子系统的视频流数据交互

视频控制与视频子系统流媒体协议传输

视频回放与视频流媒体之间的视频流数据读取

l 集成应用模块电子警察卡口子系统与电子警察卡口系统数据交互

电子警察卡口系统布控、撤控与电子警察

l 集成应用模块GPS、PDA与公网的警车GPS、警员定位数据交互

GPS、PDA与公网的警车GPS、警员定位数据交互，数据密度大

l 指挥调度模块事件处理与三台合一数据交互

事件处理与市局三台合一122的报警数据采集、反馈数据回传，要求实时性高，延迟要求保证在5s以内

l 综合研判系统与六合一数据的存取

目前只有六合一查询接口，有无数据读取接口，可以将相关数据读取到研判数据库

l 稽查布控系统与卡口子系统的数据交互

稽查布控系统与卡口数据流量查询、违法车辆图片提取

稽查布控系统布控、撤控数据与卡口系统下发、反馈。

l 手动违法抓拍系统与六合一数据的交互

  专网的违法数据上传至六合一平台

l 特勤任务模块与信号系统UTC之间数据交互

  特勤方案控制消息下发