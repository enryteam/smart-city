- [基于微服务架构的高速公路监控管理系统设计](https://mp.weixin.qq.com/s?__biz=MjM5MjE1NzgzMw==&mid=2649387529&idx=1&sn=dfb319ba315c14de6d0b9ef2ff804820&chksm=beb44bef89c3c2f9b0f11a122da954f17943787bee28c2d99300808a4edb6dda100656ca8cbc&scene=178&cur_album_id=1513205841187946502#rd)

> 作者：瞿家繁（中咨泰克交通工程集团有限公司）
>
> 摘要：高速公路监控管理系统在国内高速公路机电工程建设中是必不可少的系统，现在的主流系统采用传统的C/S架构，为适应未来公路信息化的快速发展，巴基斯坦KKH二期项目监控系统采用微服务架构进行设计开发，结合本项目实际情况，本文从系统架构设计、系统非功能性设计、系统功能测试等方面全面剖析了系统设计及开发的全过程。

巴基斯坦KKH二期机电工程项目，全线120公里，包含6条隧道、6座收费站、1个路段管理中心，管理中心作为该路段的收费、监控、通信的总控制中心，负责全线视频、微波车检、气象检测器、隧道内监控设备等的数据采集，对采集的数据进行分析处理，并根据分析的结果向沿线的可变信息标志发布引导和提醒信息。

本项目公路监控管理系统结合现在的云技术，采用微服务架构完成该系统的设计、开发、应用。目前，巴基斯坦公路信息化工程处于初级阶段，没有统一的标准和技术要求，因此采用现在国际上主流的微服务架构设计，为后期的扩容和兼容打下坚实的基础。

# **一 系统架构设计**

从技术架构方面，通过引入“以数据为中心的分层结构”，以及大量使用面向对象的技术和组件化技术，可以从技术角度极大提高系统的可扩展性，能较好地满足高速公路的发展需要。

从业务架构方面，通过对各类业务需求的分类、归纳和抽象，提炼出具有充分弹性的业务处理模型，能够较好地适应业务需求不断变化的现实情况。

## **（一）系统设计原则**

系统开发遵循以下技术原则。

（1）规范性：严格遵循中国交建智能交通研发中心相关技术规范和业务规范的要求。

（2）开放性：系统采用开放的接口协议与开发平台，提供统一的、开放的接口进行接入，系统的开放性主要体现在系统的易拓展性，能够方便后期的拓展，且不影响当前系统运行的稳定性。

（3）安全性：系统按照相关要求的应用进行设计，系统软硬件架构充分考虑整个系统运行的安全策略和机制。

（4）成熟性：采用成熟稳定的现今主流的硬件平台和第三方软件，以保障系统运行的稳定以及硬件平台维护的便捷性。

## **（二）总体技术架构**

针对本系统建设的需求及目标，对整个技术架构进行分层设计，每层对应一个或一类技术架构，按模块进行建设，并通过SOA标准方式集成，在整体上实现开放式的网络能力架构，具体如图1所示。

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wwwW1TFZY45stm9J38NzgkFDOanuaC4fNaaN4uNKrXLcul3ibNl2cHnFy8noXQQvvHlXynFmawBlSlWyLHGVN8w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

图1 系统总体技术架构

PC端兼容主流浏览器，包括IE11及以上、chrome等浏览器。UI层开发使用vue和jquery。系统基于springboot框架进行开发，并采用springcloud微服务分布式架构，使系统具有高稳定性和高扩展性。数据库访问采用mybatis和本地SQL互补实现的方式，实现一套代码支持Sybase、Oracle、mysql三种主流数据库，采用分布式缓存Redis3.0提高实时性，减轻数据库压力。系统分发层采用nginx的软件分发模式，并配置静态页面缓存技术，实现动态请求和静态请求分离，减轻tomcat的处理压力。接口统一采用restful风格的http接口，并使用OATH2认证，保证接口的安全性。后台采用zookeeper分布式应用程序协调服务，构建分布式后台集群，提高后台整体的稳定性和性能，避免后台的单点故障。

## **（三）总体软件架构**

系统采用分层结构开发和设计，将界面（控制）、业务逻辑和数据分离，通过微服务管理平台实现系统内部耦合链接，可以快速、灵活地增加或减少系统业务模块。系统分层结构划分为数据层、业务逻辑层和控制层，通过各层次系统构件间服务的承载关系，实现系统功能[1]。各层的应用构件利用系统服务框架所提供的基础服务实现系统设计、运行与管理机制，总体软件架构如图2所示。

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wwwW1TFZY45stm9J38NzgkFDOanuaC4f8cqrDibblB6Qibps1x9Rw8ZmRWlTeFckwtywu650SjNsw6x4TcBxqz3Q/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

图2 系统总体软件架构

## **（四）总体功能架构**

系统总体功能架构由系统模块和功能模块组成。系统模块主要包含路段监视、信息发布、视频管理、隧道管理、统计查询、事件管理、基础数据管理、系统安全管理等，每个系统模块为实现功能，需要增加各种功能模块以完善系统模块的整体功能，总体系统功能架构如图3所示。

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wwwW1TFZY45stm9J38NzgkFDOanuaC4fb4ia9EOpVBrLtSKLKo98nMfaMLksq4fIjc0bYgvMp25dycyKLE0agAg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

图3 系统总体功能架构

# **二 系统非功能性设计**

## **（一）总体设计**

（1）整个应用系统的设计应具有良好的灵活性、可操作性和易扩展性，系统软件的结构应更灵活，技术上应采用面向对象和中间件等。

（2）保障应用系统和硬件平台的稳定性，能够连续7×24小时不间断工作。

（3）应用系统具有较高的自动化程度，能够实现一定程度的自主调度、告警、恢复等。

（4）具有完善的系统安全机制，拥有操作权限管理功能，能够对每次操作有详细的记录，对每次非法操作产生告警，能为系统管理员提供多种发现系统故障和非法登录的手段。

（5）采用简洁、直观、友好的英文人机界面。

（6）具备一定容错措施，允许操作人员有限范围内的误操作。

（7）支持英文、乌尔都语、中文字符集等巴基斯坦和中国国家标准规定的字符处理，可进行处理、显示和打印。

（8）支持云计算技术。

（9）第三方软件采用主流品牌。

（10）软件应能支持IPv4/IPv6双栈（支持IPv4/IPv6协议，支持Ipv4/IPv6终端用户的访问，提供基于IPv4/IPv6的业务）。

（11）软件支持第三方接口开放。

（12）软件支持主流数据库产品。

## **（二）系统安全性设计**

系统制定有稳定、可靠的安全管理策略；系统客户机及服务器安装有效的、可更新的防病毒软件；系统服务器制定具体的、可靠的安全策略。

1、应用系统安全性设计

服务端由服务平台控制，接口间传输的xml报文必须包含md5加密的通信密码，报文本身也要经过BASE64编码。

升级包数据中包含自身的md5加密码，可用其判断本升级包是否被人工修改过，同时还包含了数据的来源端和目的端，旧版本号和新版本号，有效控制了升级包的升级安全。

平台和客户端jar包有lisence授权机制，配置数据文件也同样使用加密压缩算法，保证了安全的同时，又节省了磁盘空间。

通过以上一系列的安全加密措施，保障了信息在网络中的传输安全。

2、数据存储安全性设计

对数据库的硬盘采用RAID5磁盘阵列的方式保证数据的存储安全。

3、系统稳定性设计

系统中各个模块都采用集群方式，至少两个节点同时运行，即使一个节点损坏，也不影响系统的整体稳定，保证了系统的稳定运行。

4、用户信息安全性

对用户敏感信息按要求进行脱敏；接口提供加密后的文件，并将文件和密码分开提供。

## **（三）系统人机界面设计**

考虑到巴基斯坦的官方语言为英文，因此不仅系统界面要支持英语，系统中的路段监视、视频管理、信息发布管理、设备实例管理、系统管理、统计查询等模块应用界面均需要支持英文，同时系统需要保留英语国家使用习惯，对于系统中的基础数据、字典管理、信息提示等信息均需要支持英文管理。该应用系统人机界面设计采用IE界面风格，人性化的管理页面符合用户使用习惯，具体界面设计如图4所示。

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wwwW1TFZY45stm9J38NzgkFDOanuaC4fMuDIInbP50rJXVoiczico4r6CPGapReE4B4Rs7904niaLYdgbDUpErvkA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

图4 界面设计

## **（四）可扩展性设计**

应用系统设计时应充分考虑未来智能交通业务快速发展的需要，系统架构的选择必须具有良好的可扩展性和易扩展性，便于新业务的接入。

## **（五）可靠性设计**

应用系统软件具有良好的安全性和可靠性，体现在不仅要保证数据不被非法盗用和修改，还需要保证数据的一致性，同时也要保障硬件平台的稳定可靠。对于非法登陆或系统故障等，能采取多种检查和处理手段，在关键节点做主用、备用、集群等部署，实现关键节点功能的冗余，防止因单点故障对整个系统造成较大的影响，从而保障整个系统的稳定性和可靠性。

## **（六）系统备份和容灾方案**

硬件平台数据存储采用RAID5容错阵列机制，保障系统实现自动数据备份操作，同时提供人工备份操作，可以方便快捷地恢复到原来系统中。

# **三 应用系统功能测试**

在系统实际上线运行前，需要采用多种方法来保证系统的质量，测试是非常重要的一个环节。不仅要在系统开发完成后对整个系统进行测试，在开发过程中也要进行不断的测试，包括单元测试、集成测试和验收测试3个测试阶段。每一个测试阶段都需要认真对待，在测试中不断发现问题，不断改进系统缺陷，这是系统稳定运行的必要条件，也是系统投入使用前最重要的环节。

# **四 结束语**

整个应用系统目前已经开发完毕，正进行测试中，对于测试阶段发现的问题基本已经修复。近期该系统将上线，最终上线后我们将随时跟踪客户的用户体验，及时记录在使用过程中遇到的问题，针对问题及时修复，在缺陷责任期内不断完善该系统，为后期类似项目部署该系统提供支持。

# 参考文献

[1] 唐棣，于荟.江苏有线企业信息门户系统建设与发展[J].中国新通信,2018(18).

（原文刊载于2020年第6期《中国交通信息化》）