- [智慧交通｜沪宜公路智慧车列交通仿真研究](https://mp.weixin.qq.com/s/TszOK5kRkqJ9Os15Xx5YcQ)

## 1 研究背景

2021年6月16日，钟志华院士团队负责的智慧车列系统在上海市嘉定区沪宜公路开通示范线。该示范线是嘉定新城新一轮建设和首期重大项目之一，定位为全球首套平均运营车速最快、单位时间运量最大的骨干公共交通系统。上海市城市规划设计研究院长期关注智慧交通行业发展，本次沪宜公路智慧车列交通仿真研究由上海市城市规划设计研究院交通模型工作室和同济大学智慧车列团队合作开展，这也是示范线的测试和运营的重要技术支撑。

**何谓智慧车列交通系统？**研究团队技术负责人同济大学吴兵教授介绍：“智慧车列旨在充分利用现有的道路资源，类似于把地铁搬上道路……”。其运量在理论上与轨道交通系统相当，但比轨道交通灵活性更高、出行速度更快。智慧车列交通系统由优化的交通道路系统、道路智能信息化系统、智能乘客服务与中央控制系统、智能网联车辆系统、运营安全保障系统和智能维修保养系统6大子系统构成，通过实现人、车、路的深度融合，大大提升了出行效率。相比传统的城市交通系统，智慧车列交通系统在建设运营成本、对现有交通影响、出行品质等方面具有较为明显的综合优势。

![image-20211206180659978](https://gitee.com/er-huomeng/img/raw/master/image-20211206180659978.png)

图 1 智慧车列演示动画

根据设计要求，智慧车列的平均行驶速度需要达到70km/h以上，试运营阶段的平均车速要求达到60km/h以上。为了减少车列在交叉口的延误，缩短示范线的行程时间，智慧车列团队先后提出了公交信号主动优先、信号绿波等信号优先控制的多个方案。根据示范线的运行效果，目前线路方案和交通控制方案都在调整中。本次研究重点分析主要包括公交信号优先和信号绿波方案对智慧车列运行效果的影响，以及智慧车列方案对区域路网运行的影响。

## 2 交通仿真模型

### （1）基础微观模型

沪宜公路（叶城路-陈翔路段）是本次交通仿真的研究对象，总长度约8.2  km，现状为双向6车道，沿线设有路侧型双向公交专用道（也作为合乘车道使用）。在微观路网模型中，道路的各类相关属性和要素，包括车道宽度、交叉口渠化、左转待行区、直行待行区、中央隔离带、合乘车道、机动车出入口、港湾式公交站位置等，均借助现状地形图、高精度影像图等判别后设置，与现实完全一致。

![image-20211206180711540](https://gitee.com/er-huomeng/img/raw/master/image-20211206180711540.png)

![image-20211206181130680](https://gitee.com/er-huomeng/img/raw/master/image-20211206181130680.png)

图 2 沪宜公路-双单路交叉口的影像图（上）和仿真模型（下）对比

![image-20211206180849298](https://gitee.com/er-huomeng/img/raw/master/image-20211206180849298.png)



图 3 交叉口流量和信号配时录入界面

![image-20211206180858363](https://gitee.com/er-huomeng/img/raw/master/image-20211206180858363.png)

图 4立交仿真演示

![image-20211206180909696](https://gitee.com/er-huomeng/img/raw/master/image-20211206180909696.png)

图 5 宝安公路-沪宜公路交叉口2D仿真效果示意图

![image-20211206180920903](https://gitee.com/er-huomeng/img/raw/master/image-20211206180920903.png)

图 6宝安公路-沪宜公路交叉口3D仿真效果示意图

### （2）交通需求模型及验证

TransModeler仿真的交通需求模型采用转向流量（Turn Movement）、出行矩阵和车辆行程表等多种形式。转向流量仿真的车辆，出行链不完整，应用范围有限；出行矩阵仿真的矩阵推算、验证过程则更加复杂，但更符合实际情况。**本次仿真根据调查的交叉口转向流量、沿线出入口流量、道路断面流量反推研究范围的现状出行OD。**

现状交通调查选取研究范围内49个交叉口、26个机动车出入口、8个关键断面，利用视频采集和人工智能自动识别技术，进行分时段分车种流量采集。利用宏观模型的OD矩阵作为种子矩阵，结合调查数据，对仿真范围的出行OD进行多次反推、校核，最终得到研究范围分时段、分车种的出行OD。现状出行OD类型包含小汽车、中巴车、大巴车、小货车和大货车，公交车出行按照公交线路的发车间隔来设置。

TransModeler的OD反推(OD Estimation)原理类似宏观模型的道路交通分配，反推结果包括OD矩阵和根据OD矩阵分配后的路段流量。**通过比较OD反推的分配路段流量结果和现状调查的观测流量结果，可见OD反推的结果能较好地满足现状出行需求矩阵的精度要求。**

![image-20211206180929662](https://gitee.com/er-huomeng/img/raw/master/image-20211206180929662.png)

图 7 OD反推的分配流量与现状调查的观测流量结果对比

在实际的仿真中，道路的通行能力受到运行状况、交叉口信号控制、车种比例、驾驶员行为等一系列因素的影响，并且交通仿真的路径选择具有一定的随机性。因此，微观交通仿真的结果相比于宏观模型的分配结果离散程度较高。**从仿真结果路段流量和现状调查流量的对比效果来看，仿真结果的精度在可接受的范围之内。**

![image-20211206180937957](https://gitee.com/er-huomeng/img/raw/master/image-20211206180937957.png)

图 8 仿真路段流量和调查流量对比图

根据交通仿真的结果，沪宜公路（叶城路-陈翔路段）公交专用道上的平均点车速约为30.6 km/h，公交车辆的路段平均行程车速（不考虑停站时间）约为22-28  km/h；根据实地调查的结果，沪宜公路公交车辆行驶速度（扣除进出站加减速、停站、交叉口等待等）约为31  km/h，沪宜公路合乘车道行程车速约23-27 km/h。**仿真结果和现状调查结果相近。**

![image-20211206181000323](https://gitee.com/er-huomeng/img/raw/master/image-20211206181000323.png)

图 9 沪宜公路合乘车道车速分布示意图

## 3 公交信号优先方案

公交信号优先（Transit Signal Priority,  TSP）通过调整信号相位的相序、时间，或插入专用公交相位等措施，减少公交车在交叉口的停车时间，是提高公交车服务质量的重要手段之一  。公交信号优先策略一般分为被动优先、主动优先和实时优先，其中主动优先策略最常用的方法包括绿灯延长、红灯早断和专用相位插入。

本次研究在沪宜公路（叶城路-陈翔路段）沿线信号交叉口的选取中，排除位于拥挤路段、东西向交通量较大、进口道出入口较多的交叉口，选取沪宜公路-白银路、沪宜公路-双丁路、沪宜公路-双单路、沪宜公路-樱花街共4个交叉口进行公交信号主动优先方案的仿真。这4个交叉口均有左转专用道，均为3相位固定配时的信号交叉口，其中第一相位为沪宜公路直行，第二相位为沪宜公路左转，第三相位为相交道路的直行加左转。

公交信号优先方案设计的基本思路是将沪宜公路直行相位作为优先相位，根据公交车到达交叉口时的3种信号状态分别调用对应的3种信号优先策略：

- **绿灯延长：**公交车在绿灯快要结束时到达交叉口，延长沪宜公路直行的绿灯，同时等比例缩短其他2个相位的绿灯时长；
- **红灯早断：**公交车在红灯快要结束到达交叉口，提前结束沪宜公路直行红灯；
- **相位插入：**公交车在红灯期间到达交叉口，但既不处于绿灯刚结束，也不处于红灯即将结束的状态，则插入1个公交专用相位，同时缩短后续相位的绿灯时间。

优先方案的信号相位调用位置如下图所示。

![image-20211206181010602](https://gitee.com/er-huomeng/img/raw/master/image-20211206181010602.png)

图 10公交信号优先方案调用位置示意图

![image-20211206181019611](https://gitee.com/er-huomeng/img/raw/master/image-20211206181019611.png)

图 11 公交优先控制的沪宜公路-双丁路交叉口

公交信号优先仿真采用TransModeler二次开发工具TsmApi来实现。TsmApi一般采用C#或VB语言。TsmApi的主要功能是打通 TransModeler内部与外部数据库、控制器等之间的连接，从而实现外部程序对路网（Network）、交通控制（Traffic  Manager）、公共交通（Transit）、车辆路径（Router）等模块的动态控制。

**公交信号优先仿真实现的基本逻辑是根据车辆到达交叉口的信号状态，往前追溯反推车辆到达检测断面的信号状态**。当车辆到达检测断面时，通过TsmController接口来读取交叉口信号状态，即刻判断并调用信号优先方案，并在信号周期结束后对交叉口的信号配时进行初始化。

![image-20211206181029635](https://gitee.com/er-huomeng/img/raw/master/image-20211206181029635.png)

图 12 公交信号优先的控制逻辑

## 4 信号绿波方案

**信号绿波是指通过调节各交叉口的绿灯信号起始时刻，建立一定的相位差关系**，使得干线上行驶的车辆每到达1个信号交叉口时能够刚好遇到绿灯，获得不停车的通行权，从而提高道路的通行效率。

为了使智慧车列示范线能够以60km/h的速度运行，智慧车列团队设计了180s和150s两种周期长度的绿波方案，细分为南向和北向协调的信号绿波。在TransModeler软件设置信号绿波协调控制方案后，可以直观地查看在设定车速下的绿波带控制效果，如下图所示。

![image-20211206181041362](https://gitee.com/er-huomeng/img/raw/master/image-20211206181041362.png)

图 13 沪宜公路（陈翔路-叶城路）绿波效果示意图

![image-20211206181050511](https://gitee.com/er-huomeng/img/raw/master/image-20211206181050511.png)

图 14 信号绿波效果示意图

## 5 仿真应用

微观交通仿真模型的输出结果比宏观模型更加丰富，不仅能够详细记录车辆轨迹、行程时间、行程延误等，还能根据用户定义的时间和空间精度直接输出路段的流量、密度、速度等指标。对于感应控制的交通信号，仿真软件可以记录交叉口的信号控制，对精细化交通管理的评估分析十分有利。

本次交通仿真的评价指标主要包括以下几类：

**（1）路段指标**：这是评价道路运行状况的重要依据。仿真不仅输出单个路段的公交车和社会车辆的分时段流量、密度、速度、服务水平、车辆里程、延误等指标，还可以选定多条路段或对特定道路类型进行整体评价分析。通过对比有无信号优先策略情景下的路段运行情况，可以综合研判信号控制方案对区域路网和廊道的交通影响；对比公交线路、社会车辆的延误变化，可以分别评估信号控制方案对公交车和社会车辆的交通影响。

![image-20211206180320905](https://gitee.com/er-huomeng/img/raw/master/image-20211206180320905.png)

（a）南-北               （b）北-南

图 15 沪宜公路（叶城路-陈翔路）分方向的路段平均车速分布

**（2）交叉口指标：**包括分方向和分车道的延误、排队长度、服务水平等。通过对比交叉口各个进口道的延误、排队长度指标，可以研判公交信号优先方案和信号绿波方案对单个交叉口各方向车流的影响。

**（3）信号周期和相位配时：**公交信号主动优先方案由车辆通过交叉口上游的检测断面触发，根据交叉口信号配时记录，分析信号优先策略的调用情况，研究各种优先策略的效用及适应性。

为了消除随机因子对仿真结果的影响，往往需要经过多次仿真取平均值来进行分析。而在有无措施的仿真运行中使用同一个行程表，可以减少车辆路径选择变化造成的误差。借助交通仿真应用，研究得到以下主要结论：

**（1）公交信号优先方案**

- 公交信号优先方案下，沪宜公路直行方向的车辆平均延误减少9%，其中公交车平均延误减少6%；
- 使用公交信号优先的4个交叉口，优先相位和非优先相位的延误变化情况各有不同，但交叉口总延误均有所增加。其中沪宜公路-双单路交叉口的东西进口形成拥堵；另外3个交叉口虽正常运行，但总延误略有增加。所以在使用公交信号优先方案前，需仔细评估交叉口非优先相位的交通运行状况。
- 考虑方案设计触发3种优先策略的时间窗，绿灯延长仍然是被调用次数最多的优先策略，这也是现实中应用最广泛的一种公交信号优先策略。其次是红灯早断，相位插入在仿真中被调用次数最少。

**（2）信号绿波方案**

- 绿波方案下，沪宜公路（叶城路-陈翔路）沿线交叉口的车辆延误增加，北向绿波方案影响（约2%）小于南向绿波方案的影响（约10%）。其中，沪宜公路-洪德路、沪宜公路-白银路、沪宜公路-双单路受绿波方案影响较为显著。
- 从交叉口车辆延误的变化情况来看，北向绿波方案的效益优于南向绿波方案。北向绿波方案下，沪宜公路直行车辆的平均延误减少9%、东西向相交道路的车均延误增加17%；南向绿波方案下，沪宜公路直行车辆的平均延误增加2%，东西向相交道路的车均延误增加23%。

## 结语

在建设交通强国的大背景下，“智慧车列”“自动驾驶汽车”等出行方式将会越来越多地出现在城市道路上，“实时感应控制”“车路协同”等先进的智能交通管理控制手段的应用需求越来越多。而预判智能交通方案的适应性和测度其效用是应用难点。微观交通仿真技术不仅可以实现复杂方案的仿真模拟，综合评估方案的时间和经济效益，还适用于单个交叉口或路段的精细设计和管理，与宏观交通模型实现互通互补，**在枢纽规划、城市设计、智慧交通等领域有广阔的应用前景。**

## 参考文献

1.上海发布公众号：[【交通】一路绿灯，保持匀速！嘉定这条智慧车列交通系统示范线今开通.](https://mp.weixin.qq.com/s?__biz=MjM5NTA5NzYyMA==&mid=2654353371&idx=2&sn=312c328d284787fbe5489ee3e70cbe95&scene=21#wechat_redirect)

2.马万经,杨晓光.公交信号优先控制策略研究综述[J]. 城市交通, 2010, 8(6), 70-78.

3.马万经,杨晓光.单点公交优先感应控制策略效益分析与仿真验证[J]. 仿真系统学报, 2008, 20(12), 3309-3313.

4.李克平.城市公共交通优先的管理与控制[J]. 交通与运输, 2017,05:1-3.

5.National Academies of Sciences, Engineering, and Medicine 2020. Transit Signal  Priority: Current State of the Practice[R]. Washington, DC: The National Academies Press. https://doi.org/10.17226/25816.

6.Bunch, J.A., Planning Level US 29 BRT Transit Signal Priority Analysis. Technical report[R]. Montgomery County DOT.2008

7.Dion, F., Rakha, H., and Zhang, Y., Evaluation of Potential Transit Signal  Priority Benefits along a Fixed-Time Signalized Arterial [J]. Journal of Transportation Engineering, 2004, 130(3):294–303.

8.Kamdar, V., Evaluating the Transit Signal Priority Impacts along the U.S. 1  Corridor in Northern Virginia. Master’s thesis, Virginia Polytechnic  Institute and State University, Falls Church, Va.2004.