# 基本开发环境

## 软件

### MEC设备环境

1. Ubuntu Server 16.04.7 LTS
2. GCC工具链 8.4.0
3. DBG
4. OpenSSH

### Windows开发机环境

仅作推荐，不做强制要求：

1. Visual Studio 2019 (必须功能：C++ CMake tools for Windows，增加功能请用Visual Studio Installer修改安装)

使用Visual Studio 2019进行远程开发的具体操作过程见[这里](https://docs.microsoft.com/zh-cn/cpp/build/cmake-projects-in-visual-studio?view=msvc-160)。

## 硬件

### 实验室开发板

本软件基于研扬Up Xtreme开发板进行开发，搭载CPU型号为i7-8665UE，16G DDR4内存、64G eMMC储存，后续将通过SATA接口挂载6T或以上硬盘储存数据。
其它具体对外物理接口和参数如下（摘自UP Xtreme Datasheet）：

![up1.png](https://i.loli.net/2021/01/28/jVZcK9houDCFkpg.png)

![up2.png](https://i.loli.net/2021/01/28/VUSLz2JNgO4Znld.png)

### 服务器

由于实验室开发板处于内网环境，为方便调试，设置了腾讯云上海四区公网服务器，其基本开发环境配置与开发板基本相同。请提前向文档作者申请ssh账号，用于登录及远程调试。

- 域名：`phi.ctcat.cn`
- IP：`121.4.136.4`

# MEC软件架构

MEC软件主要由数据处理、应用服务、数据发送和本地控制4个基本模块组成，基本关系如下图所示：

![image-20210602144259352](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602144259352.png)

## 数据处理模块

- 数据处理与汇聚 ：汇聚云端下发指令和数据、雷视数据融合的结果及RSU返回的车辆数据，进行结构化。

## 数据接口模块

- 数据库：对视频数据和车辆轨迹数据保存一定期限（如30日），过期数据定期清理；
- 通用数据接口：基于数据库所储存的数据，为应用服务模块提供统一的通用数据接口，支撑具体业务开展。

## 应用服务模块

- MEC应用服务调用：根据业务逻辑，按照当前开放应用列表（可更新）调用各应用模块，并通过通用数据接口获取各应用所需的数据；
- 应用：每一个应用是一个.so库，由本模块按照当前开放应用列表（可更新）进行加载；统一接口形式，输入结构化数据，决策当前应用是否被触发，并输出控制变量，即后续待发送的消息。
- 优先级控制：获取各个应用.so库输出的控制指令并对优先级进行判别，分发当下控制指令；
- 溢出控制：抛弃消息发送队列中不能在规定时延要求内发送的消息，满足时延性能要求；

## 数据发送模块

- 设备控制：根据优先级控制输出指令对各外接设备进行控制，实现交通控制。

## 本地控制模块

- 控制上述4模块的启动和关闭；
- 根据云端发送的更新指令，对各模块代码、配置文件和.so库文件进行更新；
- 监控上述4模块的运行状态，及时处理错误、异常、崩溃等事件，保障服务连续可用性；
- 日志。