# 车路协同云控平台

个人理解与整理的云控平台方案，如有问题，可联系微信公众号：lovebetterworld进行沟通。

# 一、车路协同发展的痛点问题

车路协同当前依然处于发展初期，具体实现的技术、商业模式、建设模式都还在探索尝试。

目前最典型的车路协同方案包括聪明的车（自动驾驶、V2X OBU）、智慧的路（V2X  RSU、智能感知设备、边缘计算、信号机等）、网络、云（控）平台，基本上是一个完整的云管端架构的系统。而在一些大型示范项目中，云平台包括了多项应用，既有面向交通管理的应用，也有面向智慧公交、智慧物流、车厂TSP等的服务。

打造一个完整独立的系统，对于在车联网初期进行示范试点是没有问题的，可以尽可能地进行更多的功能和性能测试。但对于最终商用，就会存在业务主体不明确等诸多问题。

车路协同从技术层面上需要有一个完整的体系架构，但从端到端的应用及服务系统角度看，**车路协同只是一种技术支撑，或者说作为应用系统中的一个子系统存在，才有可能实现真正的商业逻辑**。

以交通管理为例，目前智慧交通的交管中已包括了交通数据采集、信号优化、交通诱导、交通状况监测及应急处置等等业务。对于车路协同来说，不是另建一套系统进行交通管理，而是作为一个补充融入到原有系统中，解决原有技术解决不了的问题。

![](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210527152454180.png)

比如，原有交通数据采集中已包括了大量的视频、线圈、微波测速、浮动车、互联网的数据，车路协同技术可以增加车载终端提供的GPS、紧急故障、驾驶意图等数据，可以增加以交通参与者目标为粒度的感知覆盖面和精细度；另外，以往的交通诱导、道路状况、收费信息等的发布对象是无差别的，而通过车路协同技术可以差异化地精准到车；再如，柔性车道的控制，从面向驾驶员的可变指示牌，通过车路协同技术，可以转变为面向自动驾驶车辆和智能网联车辆的精准指引。

但是，车路协同技术并不会改变整体交通管理的业务逻辑。原有交通管理系统的形成是经过不断演进变化的，不是一蹴而就的，是错综复杂的系统。车路协同作为新技术，对原有系统的数据来源、控制方法、发布方式进行补充，并融入到实际业务系统中。

只有作为业务生产系统的一部分，为生产服务，商业模式才可能理顺，受益方是买单者。同样，车路协同技术应用到智慧公交，应用到港口、机场等，也需要融入到原有的生产系统中，和原有的车辆管理、调度、维修管理等深度融合。

## 1.1 如何入局车路协同

车路协同本质上，主要是三个核心，车端、路端、还有云平台。车端OBU设备以及路端的RSU设备，我们没有相应的研发实力，无法做硬件以及算法方面的内容，最好的切入点就是集成。一个完整的车路协同项目，通过集成其他公司的OBU、RSU、MEC，硬件方面，全部用来集成，并附带硬件自身的诸多计算能力，提供一个中心云的云控平台，做一个车路协同的<font color='red'>管理平台，物联网平台，大数据分析、计算平台，GIS可视化平台，仿真系统加数字孪生方案平台。</font>

# 二、总体架构

![image-20210713141907043](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210713141907043.png)

车路协同云控平台是综合了物联网平台、大数据、流媒体、GIS、应用、数据服务、数据接口等多个方面的一个<font color='red'>综合能力的平台</font>，开发的这个平台是提供给客户，当他们在建设智能网联车测试基地、高速测试场、园区车路协同测试基地、城市道路的车路协同测试时，有两种入局方式，第一种，加入华为生态，华为部署硬件，我们来做软件系统。第二种，作为集成开发商，集成相应的硬件，然后使用这套软件平台，这套软件平台包括哪些能力呢？

- 管理平台：提供一些基础的维护管理类功能，以满足车路协同本身的基础要求，如系统管理、路网管理、远程运维平台、公告管理等。
- 物联网平台：提供的能力是能够接入任何一个厂商的物联网设备，包括OBU、RSU、MEC、摄像头，通过一种广泛的物联网接口协议，如MQTT，开发一个微物联网平台，使我们能够面对不同的硬件都具有解决能力，对摄像头有流媒体视频接入、转发、分析、识别的能力，对于点位设备有GIS可视化、设备状态监测能力。
- 大数据分析、计算平台：能够接入海量的设备、并对数据进行数据清洗、分析、计算，从而得到有效数据，因为海量物联网设备传输的数据，大部分都是无用数据，如果对海量物联网设备数据统统做存储，过于耗费硬件成本，所以利用大数据手段，解决数据的有效性，分析得出一些有实际意义和能够进行辅助决策、第三方数据服务、可视化展示的数据是更有意义的。
- GIS可视化平台：车路协同、甚至是交通整个行业，无论入局哪一方面，GIS都是必不可少的，因为对于车辆而言，始终都是在时间和空间两个维度在做分析，对于众多传感器、物联网设备也都需要通过GIS可视化的方式进行呈现。但是这里面的GIS并不简简单单的是海量设备的或车辆的点位展示，更多的是要利用GIS的能力，将车路协同的众多场景进行可视化呈现，解决众多实际需求带来的问题。
- 仿真系统+数字孪生：这个对平台的要求能力较高，是整个平台基础开发完成后，提升整个云控平台的能力等级，锦上添花的一个方向，车路协同的现在诸多场景，应用，算法全都通过OBU、RSU、MEC处理完成，云端只是接收了一个结果数据，对于很多种条件下，其实云端的管理者更希望能够实时呈现出来当时的车辆状态，为他们的判定提供一些依据，这时候就需要仿真+数字孪生给他们提供一些辅助决策方面的东西。

## 2.1 管理平台

### 2.1.1 系统管理

#### 2.1.1.1 系统初始化

对系统状态、基础数据、用户数据、权限数据、角色数据、资源数据等进行初始化操作。

#### 2.1.1.2 系统登录/登录

实现云控平台的登录登出、操作权限的管控。

#### 2.1.1.3 管理员管理

提供云控平台的管理员账户创建、编辑、删除、查询等基础操作，并可对管理员的状态、权限等信息进行维护。

##### 2.1.1.3.1 用户管理

对场景使用用户的注册、审核、编辑等管理功能，配合场地管理功能对使用者的身份和权限进行管理。

#### 2.1.1.4 角色管理

提供平台角色的创建、编辑、删除、查询等基础操作，通过角色的管理，实现对管理员的精细化管理。

#### 2.1.1.5 权限管理

对平台的资源进行统一管理，可以实现对管理员基于菜单和接口级别的权限管控。

#### 2.1.1.6 密码管理

管理员密码的重置和修改功能。

#### 2.1.1.7 系统日志

提供基于日期、管理员等不同维护的操作日志查询、导出功能。

### 2.1.2 事件管理

#### 2.1.2.1 事件管理系统

提供V2I场景事件下发，通过选取起止点、影响范围，系统自动计算下发给RSU设备。

#### 2.1.2.2 预警中心

提供对各类V2I事件、场景等基础数据的查询功能。

### 2.1.3 应用管理

提供对V2X应用的创建、编辑、查看、删除等基础功能，为V2X开放接口服务身份鉴权、数据安全提供支撑。

### 2.1.4 电子围栏

通过可视化平台设定好场地的电子围栏，当车辆行驶在电子围栏外时，生成一条告警信息，及时通知平台管理员进行管制。

### 2.1.5 场景管理

系统支持V2V、V2I场景等场景的动态扩容，具备良好的可扩展能力，通过可视化大屏，可以动态的显示场景的效果。

### 2.1.6 公告管理

在后台通过发布一条公告信息，可以在可视化大屏顶部进行实时滚动显示。

### 2.1.7 报表管理

支持对不同维护的告警数据进行导出的功能。

### 2.1.8 数据采集服务

#### 2.1.8.1 RSU数据对接模块

对接RSU设备，实现对RSU设备数据的采集、解析、分析、存储；

#### 2.1.8.2 车载数据对接模块

对接车载终端设备，实现对车载终端数据的采集、解析、分析、存储；

#### 2.1.8.3 信号灯数据对接模块

对接信号灯数据，对信号灯实时信息进行封装和广播；

#### 2.1.8.4 交管平台对接模块

对接交管数据平台，提供云控平台的可用性，提升交通效率；

#### 2.1.8.5 气象平台对接模块

对接气象数据平台，提供V2X平台的可用性，提升交通效率；

#### 2.1.8.6 安全模块

为云控平台的设备接入提供身份认证功能，为平台数据交互提供加解密功能，以保证平台的系统和数据安全。

### 2.1.9 远程运维平台

#### 2.1.9.1 资产管理

支持管理区域内所有的OBU、RSU及摄像头、雷达等路侧集成设备的型号、厂家、设备序列号等信息，实现所管理设备的资产管理；

#### 2.1.9.2 状态监控

支持管理区域内或选定区域内设备状态查询和显示，可以分设备或者汇总显示设备的在线、离线状态、设备故障比例，并支持显示OBU和RSU的软件版本分布；

#### 2.1.9.3 配置管理

支持设备参数的查询和修改，为了操作方便支持某个设备全量参数的上传；同时支持单个参数的配置，支持输入参数名称，也支持从参数树中查找对应的参数，然后设置对应的数值；

#### 2.1.9.4 升级管理

支持设备分类，并提供不同类型的批量软件升级，升级可以是实时的也可以是定时升级，以便避开设备运行高峰；

#### 2.1.9.5 日志管理

支持debug日志，日志记录等级，支持配置日志文件大小、日志文件个数以及日志文件传输到指定目录；后续记录日志文件分类存储和加密。便于设备问题的深入分析；

#### 2.1.9.6 权限管理

支持添加用户，创建普通用户和管理员用户，并可重置密码；对升级包、参数文件进行查询操作；

告警知识库查询，用于查询相关代码及描述；参数模型等功能；

#### 2.1.9.7 端口访问策略

对RSU、OBU、边缘监测设备等设备进行端口访间策略设置，包括I原地址与目标地址设置、端口设置、协议设置等；

### 2.1.10 路网管理

融合高速路网结构和车路协同路网结构。

![image-20210519104742127](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210519104742127.png)

- 实现道路级别统计
- 实现节点数量统计
- 实现路段数量统计
- 实现车路协同覆盖总里程统计

#### 2.1.10.1 路线管理

	维护所属区域的路线管理。

- 增加路线、删除路线、修改路线、查询路线

#### 2.1.10.2 节点管理

	节点维护管理。

- 增加节点、删除节点、修改节点、查询节点

#### 2.1.10.3 路段管理

	路段管理功能维护。

- 新增路段、删除路段、修改路段、查询路段

**注：高速公路路段划分以出入口、收费站、互通立交、隧道为基础切分，对应起止点编号为相应节点ID，国省干线公路路段划分以互通立交、平面交叉口、收费站、隧道为基础切分，对应起止点编号为相应节点ID。**

#### 2.1.10.4 车道管理

车道管理功能维护。

- 新增车道、删除车道、修改车道、查询车道

车道属性：转向行为，被共享情况，连接情况，上下行，车道距道路中心线编号

### 2.1.11 接口管理

#### 2.1.11.1 接口服务安全

对开发接口的数据和调用者身份进行鉴权，保证接口的安全和通讯数据安全。

#### 2.1.11.2 开放接口服务

- V2X事件管理：以接口方式提供创建V2X事件、下发V2X消息、取消V2X消息广播等功能；

- 位置数据共享：为V2X应用提供车辆实时位置共享功能，支持V2X应用的场景开发；

- V2X事件数据共享：为V2X应用提供V2X事件数据共享功能；

## 2.2 物联网平台

- 在GIS地图上实现计算单位的可视化展示。
- 实现计算单元信息的基本维护操作，包括计算单元的添加、修改、删除和查询等操作。
- 实现计算单元的运行状态监测功能，并统计分析运行状态的原因描述信息，离线/在线比例等，故障排查分析等。

- 物联网平台：统一设备接入，海量设备管理，



### 2.2.1 设备管理

#### 2.2.1.1 设备注册

提供终端设备的注册、编辑、查询、删除功能，实现了物联网设备的全生命周期管理。

#### 2.2.1.2 设备管理

##### 2.2.1.2.1 路侧计算设备

- MEC
- 数据处理单元

##### 2.2.1.2.2 路侧通信设备

- RSU
- 通信基站

##### 2.2.1.2.3 路侧感知设备

- 摄像机
- 毫米波雷达
- 激光雷达
- 光纤传感器
- 桥梁传感器
- 边坡传感器
- 气象监测传感器

##### 2.2.1.2.4 电子标志标线

- 数字化路侧标志牌
- 情报板
- 车道标志设备

##### 2.2.1.2.5 辅助设备

- 挂杆及支架
- 交换机
- 通信管线
- 供电管线

#### 2.2.1.3 车辆管理

车辆管理：提供车辆的注册、编辑、删除、状态查询、告警记录统计等基础功能。

车端设备管理：提供车载终端的基础信息的查看及远程配置。

车辆数据：对车辆的基础数据、告警数据、通信状态、实时位置的数据管理，通过与流媒体的数据管理，可以随时回放车内外的视频监控视频。

参考如下样式：

![image-20210603094808806](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603094808806.png)

##### 2.2.1.3.1 OBU管理

- 实现车辆，车辆所属OBU的关联统计管理。

参考如下样式：

![image-20210603094825269](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603094825269.png)



##### 2.2.1.3.2 视频设备管理

提供对车内、路侧摄像头的信息查看及远程配置。

#### 2.2.1.4 设备基础信息共享

提供云控平台接入设备的基础信息的共享功能。

#### 2.2.1.5 远程配置

系统提供对设备的名称、IP、端口远程配置的能力。

### 2.2.2 设备状态监控

#### 2.2.2.1 设备状态

对所有的设备的激活状态及通信状态的监控。

#### 2.2.2.2 设备监测

##### 1. 基础设施运行状态监测

- 实现桥梁、隧道、边坡等的运行状态监测，通过RSU设备进行监测。

##### 2. 事件检测器检测

- 实现RSU设备检测到的事件信息监测。

##### 3. 情报板发布监测

- 实现情报板发布信息的监测。

### 2.2.3 运行监测

- OBU对车辆的运行状态监测，保卡车辆的加速度、转弯行为，违章行为，违法行为，驾驶行为分析，速度等的监测。
- OBU、RSU的交通量统计监测。

### 2.2.4 气象监测

接入第三方的天气：使用高德的天气查询API即可，每日限制足够使用了。

- 实现气象检测器设备监测到的气象管理。
- 对接第三方气象平台的气象监测管理，进行危险天气的预警，下发情报板，下发用户APP，互联网发布，高速入口发布，RSU广播发布等。

## 2.3 大数据平台

- 大数据平台搭建、算法分析、大数据运维，大数据组件优化。TCP/UDP/MQTT/HTTP、TLS/DLS、不同厂商、不同设备、不同报文、统一接入，统一管理。

![大数据架构](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84.png)

OBU、RSU设备的协议数据—–>Kafka—->Spark消费Kafka的数据，进行计算分析，状态用redis进行存储标识——>PostgreGIS用于一些GIS的计算—->结果集，可用于报表，大屏，接口提供等等。



三维地图服务数据对接：对接三维地图服务，为设备的轨迹纠偏、高程计算等提供大数据支持；

远程运维平台数据对接：对接运维平台基础数据，对云控平台中各个子系统的数据进行统一管理；

数据智能分析：通过对各类基础数据的智能分析，基于大数据的智能分发策略，实现自动生成V2X交通事件信息等功能，大大提升交通效率；

流媒体服务数据对接：对接流媒体视频平台，为可视化展示平台和V2X管理平台提供视频数据支撑。

### 2.3.1 平台建设

建立大数据的通用解决方案，能够满足大部分项目的大数据开发要求，并满足车路协同的大数据所需的要求。

参照上方的架构图。

### 2.3.2 数据看板

进行多维度的汇总、分析、并提供多种形式的可视化展示方式。

### 2.3.3 数据采集可视化展示系统

数据采集功能：车路协同系统数据采集、场景中构建围观仿真场景数据采集可通过GPS数据、全站仪数据、数字化、矢量化数据以及其他数据转换；

可视化展示系统功能：图形、属性数据一体化管理，自动在场景中构建微观仿真模型，模拟在时间和空间变化下的交通行为。产品的交通仿真采用微观方式，对交通流的描述以单个车辆为基本单元，车辆在道路上的跟车、超车及车道变换等微观行为，连同场景中的红绿灯、行人的状态同步得到较真实的反映；

GIS地图子系统：地理数据存储、显示、数据输入与编辑、数据管理、数据操作以及数据显示和输出等；数据建模：二维道路数据，每个图层至少一个ShapeFile(一个ShapeFile至少包括*.dbf、*,shp、*,shx与*.prj四个文件）;

三维模型数据；地图数据可数据支持自动转成三维道路，提供对应的三维模型以及道路两侧第一排建筑物的模型，用于三三维一体化引擎平台的数据展现；

## 2.4 GIS平台

### 2.4.1 地图底图展示

	实现所属区域的GIS地图展示功能，高亮显示所属区域的底图，并将所属区域外的添加遮罩，添加地图区域的边缘轮廓。

- 推荐使用GIS服务器：GeoServer，发布图层，对于道路路网，需要发布图层。

- 实现地图底图的标准图层，卫星图。

- 实现高德、百度、腾讯等第三方地图服务的接入。

- 实现车道级别的高精度地图服务，用以车路协同仿真系统的功能实现。

- 实现地图的2.5D，3D效果展示。

  参照风格如下：

![image-20210602152233472](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602152233472.png)

### 2.4.2 路网展示

	实现所属区域的路网可视化展示，并高亮显示路网，根据道路的行政等级、技术等级以相应的图例呈现路网结构。
	
	其中，根据行政等级分为：

1. 国道（国家高速公路和普通国道），简称：G

2. 省道（省级高速公路和普通省道），简称：S

3. 县道，简称：X

4. 乡道，简称：Y

5. 村道，简称：C

6. 专用公路，简称：Z

  根据公路技术等级划分为：

1. 高速公路

2. 一级公路

3. 二级公路

4. 三级公路

5. 四级公路

   参照风格如下：

![image-20210602152633394](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602152633394.png)



	其中，当地图放大到最大级别时，可看到车道级别，即路段的车道数量能够呈现出来。

![image-20210602153239728](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602153239728.png)



### 2.4.3 车辆管理

轨迹回放：提供对车辆历史行驶数据、告警数据、流媒体数据的回放；

车辆实时状态：在可视化大屏中实时显示车辆的状态：在线、离线；

车辆实时位置：基于高精度地图，在可视化大屏中实时渲染车辆的位置；

车辆实时消息：基于高精度地图，当车辆收到路侧单元广播的事件消息时，在车周围实时动态展示不同的事件效果；

车载视频监控：在后台配置好关联车辆的流媒体信息，可以在可视化大屏中实时对车内外进行视频监控；



- GIS地图上实现车辆管理统计功能。
- 实现车辆的在线地图可视化呈现，以不同图例呈现不同类型的车辆。
- 实现车辆视频的实时位置，历史轨迹，轨迹回放功能。
- 实现车辆视频的车载摄像头视频播放功能。
- 实现车辆OBU设备上传的自动故障报警功能。
- 实现车辆实时营运和暂停的功能，即区分速度为0、车辆未启动和正在行驶车辆的监控。

参考样式如下：

- 需增加图例呈现不同样式的车。
- 需设计车辆点击后的详情界面，可查看车辆详细信息，车辆轨迹，视频，行驶里程统计。
- 需实现车辆OBU监测信息描述查看。

![image-20210603103911294](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603103911294.png)

### 2.4.4 RSU管控、信号灯、情报板、标志牌点位展示

RSU实时状态：在线、离线；

RSU实时消息：基于高精度地图，当路侧单元接收到平台下发的事件消息时，在RSU周围实时动态展示不同的事件效果；

路侧视频监控：提供路侧摄像头实时监控画面的查看功能；

在GIS地图上，通过可视化的方式展示RSU、信号灯、情报板、标志牌的地理位置信息，并可进行信息查看操作。

- 实现RSU、信号灯、情报板、标志牌的点位可视化展示。

- 实现点位的点击事件操作，可查看相应点位的详细信息。

- 点位要实现聚合效果，参考点位地图可视化。

  参考样式如下：

![image-20210602153543324](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602153543324.png)

- 实现点位地图的点聚合展示。
- 当点位地图放大到最大级别，可点击相应的点位，查看详情，如RSU处有摄像头，可进行视频查看。也可查看RSU处的其他设备。

参考效果如下：

![image-20210603093143350](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603093143350.png)

### 2.4.5 实时统计信息

对云控平台整体的设备接入情况、实时消息统计、实时设备状态等统计信息进行展示。

### 2.4.6 交通事件可视化

- 实现交通事件的实时推送，并在地图上以可视化的方式呈现。

- 实现交通事件的多维度筛选功能，交通事件统计功能。

- 实现交通指标的可视化展示。

- 通过车辆OBU或路侧RSU单元检测到交通事件后，在地图上进行交通事件的可视化展示功能，根据事件的严重程度进行频率控制。

- 根据交通事件类型的不同，用以不同的图标进行展示。

  参考设计风格如下：

![image-20210602155057576](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210602155057576.png)



![image-20210712113244398](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210712113244398.png)

![image-20210712113256203](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210712113256203.png)

![image-20210712113320254](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210712113320254.png)

### 2.4.7 通知公告-发布信息可视化

滚动播报平台通知公告信息。

- 实现发布信息可视化，如情报板的可视化，RSU广播的可视化。
- 实现地图上对发布信息的手动维护工作，即修改发布信息内容，可进行实时同步发送广播。

参考样式如下：

- 其中，点位需换成情报板或标志标牌的符号。
- 可视化界面需符合情报板、标志标牌或RSU广播内容的样式。

![image-20210603093442614](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603093442614.png)

### 2.4.8 天气可视化

1：根据天气接口，查询市或区的天气情况，每12小时发布更新一次，并在GIS地图上实现可视化展示。

参考样式：

![image-20210712113127977](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210712113127977.png)

### 2.4.9 高精度三维地图

集成高精度三维地图，对V2X单元进行三维可视化展示。

三维场景展示：通过高精度地图的开放能力，对V2X交通事件进行实时的三维动态展示。

![image-20210521110604984](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210521110604984.png)

主要应用：

![image-20210603112248982](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603112248982.png)



## 2.5 车路协同智能APP

#### 2.5.1 用户注册

实现用户录入、个人用户注册；

#### 2.5.2 用户登录

建设登录认证系统，实现用户在系统登录认证，保证系统访问安全性；

#### 2.5.3 UI设计

界面UI设计；

#### 2.5.4 定位模块

获取车辆位置信息，显示GPS模块当前信号状态，使用百度/高德/等地图，支持更多的第三方地图接入，支持对接离线地图；

#### 2.5.5 语音模块车辆行驶过程中

提供预警提示语音播报，通过开关按钮开启或关闭，音量大小调节跟随设备的操作；

#### 2.5.6 跟随地图

车辆在地图的显示，可以打开跟随地图开关（默认关闭），选择后地图显示以车辆未中心，保持车辆的行驶方向一直朝北，地图改变方向变换适应道路；

#### 2.5.7 预警提醒

对从车载OBU或车路协同云传递的预警信息，进行呈现和展示，配置语音模块给予用户及时的提醒；

#### 2.5.8 车速显示

显示车辆实时的行驶速度，帮助驾驶员进行速度判断；

#### 2.5.9 常用数据

显示当前日期、时间和温度，帮助驾驶员快速使用常用信息；

#### 2.5.10 系统设置

用于设置OBU通信的IP和端口；

#### 2.5.11 测试场景制作

满足《合作式智能运输系统  车用通信系统 应用层及应用数据交互标准》17个标准场景。

#### 2.5.12 事故一键上报

对于交通事故，可以实现一键上报功能。



## 2.6 车路协同场景应用及算法

### 2.6.1 车路协同应用

车路协同的一些安全、效率、服务类的场景，结合高速上所有的业务场景，进行相应融合，可大致融合为如下8大场景：

1. 事故区域警示
2. 紧急车辆优先通行
3. 道路危险状况提醒
4. 车辆故障上报
5. 匝道车辆汇入预警
6. 道路养护提示
7. 气象环境监测与车速引导
8. 交通标志数字化发布

这8大高速业务场景里，所形成的结果导向，都是由车路协同场景的多个场景组合而成，即车路协同的场景是过程，而应用是结果。

如前向碰撞预警、紧急制动预警、异常车辆预警、车辆失控预警、前方拥堵提醒、紧急车辆提醒，以及众多违章行为，如超速、疲劳驾驶、红眼驾驶、长时间占用超车道、驶入禁行区域、占用应急车道、违停等，都是这些小类融合成为一个高速完整的业务场景。

车路协同综合态势监测大屏里，时刻监测RSU设备和所有被RSU监测到的OBU设备的状态信息。

#### 2.6.1.1 事故区域警示

- 事故参与者车辆

根据OBU可返回的接口数据，若车辆出现前向碰撞预警，紧急制动预警，异常车辆提醒，车辆失控，道路危险状况提示，急刹车，急转弯等异常状态，云控平台立刻对该车辆进行异常状态监控，分析车辆是否存在发生交通事故。若经分析得出发生事故，立刻生成一条突发交通事故事件信息，在综合态势GIS大屏上进行动态呈现，并及时告知相关人员。

当事故发生后，由事故车辆、经过车辆的车载设备、临时警示交通标志、高速安全监控等多种数据来源向V2X车路协同平台上报事故精确地点、占用车道等事故信息，联系救援中心，并通过路侧设备（RSU)向后方来车广播推送事故信息，避免损失的扩大。

- 事故后行驶的车辆

场景描述：

1. 高速上仿真模拟发生一起交通事故。

2. 事故发生后，经事故车辆自身OBU、经过车辆的OBU设备、车辆置放的安全警示标志以及高速RSU设备的监控视频，将事故向车路协同云控平台上传，包括事故车辆的车牌号，车辆大小，事故发生时间，事故发生地点进行上报，并就事故所造成的拥堵车道进行上报。

3. 事故发生后，事故相关数据上报云控平台后，立刻紧急调度周边救援车辆赶往事故现场。

4. 云控平台自动下发指令给周边RSU设备，RSU向后方0.5公里，1公里，2公里处广播事故信息，避免二次事故发生。

   ![size:800,1000](D:\selfprojects\smart-city\车路协同\云控平台\storage\2021\07-14\ka6rpfdeW0pyp662WdnztayCehEyexSAlqEaRBYF.png)

   需要实时获取周边车辆的OBU，需要获取事故周边所有的RSU设备。

   可以查看车辆的视频，轨迹，轨迹回放。

   提供车辆事故前10分钟的运行状态仿真信息，给保险行业提供支持。

#### 2.6.1.2 紧急车辆优先通行

当发生事故后，经由事故区域警示，然后调度周边紧急车辆进行救援，并通过路侧设备、标志标牌等广播推送事故信息，广播推送紧急车辆优先通行事情。

场景描述：

1. 经交通事故场景后，调度周边紧急救援车辆赶往现场。
2. 云控平台下发紧急车辆优先通行指令给路侧RSU。
3. RSU广播给周边OBU车辆，迅速让出快车道，让救援车辆能够快速赶往现场。

#### 2.6.1.3 道路危险状况提醒

交通管理部门对特定路段进行道路危险状况事件下发，包括：道路施工、大雾、雨雪、滑坡等。

当车辆行驶至事件推送范围内路段，智能路侧单元对车辆进行预警，提醒驾驶员谨慎驾驶。

限速提醒/超速告警：交通管理部门对特定路段进行限速下发，当车辆行驶过程中，超出该路段限定速度，智能路侧单元对车辆进行预警，提醒驾驶员减速行驶，适用于普通道路及高速公路等有限速的道路。

#### 2.6.1.4 车辆故障上报

结合车载设备，在故障发生时自动上报车辆故障信息和位置信息等，为故障车辆提供汽车维修和拖车服务，通过V2X车路协同平台传输至智能路侧单元，同步向周围车辆广播前方车辆故障，避免二次险情。

场景描述：

1. 车载设备OBU实时向云控平台发送车辆运行状态信息。
2. 当车辆发生故障后，云控平台实时监测到车辆故障信息，立即进行告警，上报车辆实时位置信息。
3. 服务类消息：提供周边汽车维修和拖车服务的相关联系方式。
4. 将故障车辆的信息通过RSU向周边其他OBU车辆扩散，防止造成车辆事故。

#### 2.6.1.5 匝道车辆汇入预警

车辆在高架或高速道路上正常行驶并接近匠道时，智能路侧单元将匝道汇入的车辆信息发送给直行车辆终端，对直行车辆驾驶员进行提醒，避免碰撞事故的发生。

场景描述：

1. 车辆从高速入口进入高速时，或车辆从服务区、加油站离开时，会进入匝道。
2. 当从匝道驶出时，需与高速上正在行驶的车辆进行交互。
3. RSU将匝道处和高速道路上的车辆进行广播，对高速道路上直行的驾驶员进行提醒，避免发生交通事故。

#### 2.6.1.6 道路养护提示

结合高精度定位、一键事件上报、警示安全锥桶、警示三角牌等，通过对传统的交通安全设施进行物联网化改造，并与APP数据平台无缝对接，实现道路施工和封闭管制信息的实时精准采集和发布，提升用户出行效率和安全水平。

#### 2.6.1.7 气象环境监测与车速引导

依托高速部分路段的气象监测站，将检测到的环境条件（如雨、团雾、沙尘）气象信息上报V2X平台，按照事先设定的原则变换限速值，同时将变化的限速值通过APP或者OBU发送给车辆，结合已有的视频监控分析部分路段车流量情况，通过可变限速标牌、信息提示屏等，对车辆进行车速引导。

场景描述：

1. 对高速部分行车路段，通过其气象监测站监测到的环境条件，实时上报给云控平台。
2. 云控平台根据气象信息，进行限速调整，将限速信息下发给APP，或者下发给OBU，或者下发给RSU，RSU进行广播。
3. 对拥堵路段，可通过车速诱导，疏通交通压力。

#### 2.6.1.8 交通标志数字化发布

交通标志摆脱实体的束缚，以数字化的形态存在于道路交通环境中。每一块标志都会有一个唯一的身份识别码（类似人的身份证号码）,通过无线广播的方式向道路上行驶的车辆发送识别码，车载设备通过解码获取标志的内容，从而采取相应的措施。同时可以拓展标线数字化、信号数字化、护栏数字化等，从而构建一个数字化的道路交通环境，基于此来实现车路协同。

### 2.6.2 车路协同场景算法

异常交通事件预警（逆行车辆）:行驶道路存在逆向行驶车辆时候，逆行车辆发出行驶方向异常预警，逆行车辆广播逆行位置坐标给附近正常行驶车辆，正常行驶车辆收到以上信息规避逆行车辆；

异常天气预警：RSU将积水、结冰、团雾、暴雨等异常天气状况通知给周边车辆，提醒驾驶员注意驾驶安全；

前方拥堵提醒：主车行驶前方发生交通拥堵状况，路侧单元（RSU)将拥堵路段信息发送至0BU,本应用将对驾驶员进行提醒。本应用提醒驾驶员前方路段拥堵，有助于驾驶员合理制定行车路线，提高道路通行效率；

施工区域预警：RSU将道路施工信息，包括车道、长度、施工事件通知给周边车辆，提醒驾驶员提前减速、变道，提高机动车的行驶安全与出行效率；

限速提醒：主车行驶过程中，在超出限定速度的情况下，本应用对驾驶员进行预警，提醒驾驶员减速行驶。本应用适用于普通道路及高速公路等有限速的道路。本应用辅助驾驶员避免超速行驶，消除安全隐患，减少事故的发生；

危险路段预警：主车行驶到潜在危险状况（如桥下存在较深积水、路面有深坑、道路湿滑、前方急转弯等）路段，存在发生事故风险时，本应用对驾驶员进行预警。本应用适用于城市道路、郊区道路和高速公路等容易发生危险状况的路段或者临时性存在道路危险状况的路段；

车内标牌提醒：当主车，通过平台收集路侧标志标牌等信息，同时在车端车路协同智能APP端实现车内标牌展示提醒功能；

前方道路变窄预警：主车在行进过程中，平台侧结合道路变化情况下发途径该路段车辆前方道路变窄预警信息，提醒驾驶员行驶安全；

异常车辆提醒：当车辆打开故障告警灯时，可以对外广播该信息。周围车辆根据接收到的信息进行提前绕行。RSU也会监听车辆的故障告警信息，并将该信息告知给道路上的其他车辆；

车辆失控预警：当远车出现制动防抱死系统、车身稳定性系统、牵引力控制系统、车道偏移预警系统功能触发时，对外广播此类状态信息，若主车根据收到的消息识别出该车属于车辆失控，且可能影响自身行驶路线时，则应用对驾驶员进行提醒。车辆失控预警基于通信终端，可以将车辆内部电控系统的功能触发/失控等信息，及时对外广播，便于周边车辆迅速采取避让等处置措施，避免由于某一车辆失控导致与周边车辆碰撞事故发生；

特种车辆预警：主车行驶中，收到特种车辆提醒，以对消防车、救护车、警车或其他紧急呼叫车辆等进行让行，本应用实现对消防车、救护车、警车或其他紧急呼叫车辆的让行；

前向碰撞预警：主车在车道上行驶，与在正前方同一车道的远车存在追尾碰撞危险时，应用将对驾驶员进行预警。本应用适用于普通道路或高速公路等车辆追尾碰撞危险的预警；

官区预警：当主车的相邻车道上有同向行驶的远车出现在主车盲区时，应用对HV驾驶员进行提醒；当主车准备实施变道操作时，若此时相邻车道上有同向行驶的远车处于或即将进入主车盲区，应用对HV驾驶员进行预交叉路口防碰撞：主车驶向交叉路口，与侧向行驶的远车存在碰撞危险时，应用将对HV驾驶员进行预警；

闯红灯预警：主车经过有信号控制的交叉口（车道）,车辆存在不按信号灯规定或指示行驶的风险时，应用对驾驶员进行预警；

超速预警：主车在行驶过程中车载终端检测到主车车速超过道路限速速度，即触发车速预警播报，提醒驾乘人员超速预警：

前方事故预警：RSU将感知到的交通事故、异常停车等交通突发事件通知给周边车辆，用户可避开突发交通事件区域或提前变道，提高机动车的行驶安全与出行效率。

逆向超车预警：主车行驶在道路上，因为借用逆向车道超车，与逆向车道上的逆向行驶远车存在碰撞危险时应用对主车驾驶员进行预警；

紧急制动预警：主车行驶在道路上，与前方行驶的远车存在一定距离，当前方RV 进行紧急制动时，会将这一信息通过短程无线通信广播出来。主车检测到远车的紧急制动状态，若主车判断该事件与远车相关，则对驾驶员进行不同等级的预警；

行人闯入预警：主车在行驶中，周边有行人，系统可通过边缘摄像头、雷达等设备采集行人信息，RSU获取行人信息后广播给车辆，若与行人有碰撞危险，系统提醒驾驶员注意行人；

绿波引导：当装载车载单元（0BU)的HV驶向信号灯控制交叉路口，收到由路侧单元（RSU)发送的道路数据及信号灯实时状态数据时，应用将给予驾驶员一个建议车速区间，以使车辆能够经济地、舒适地（不需要停车等待）通过信号灯路口；

左转辅助：主车在交叉路口左转，与对向驶来的远车存在碰撞危险时，本应用将对驾驶员进行预警。本应用适用于城市及郊区普通道路及公路的交叉路口，辅助驾驶员避免或减轻侧向碰撞，提高交叉路口通行安全；

公交站台播报：当车辆经过公交站台路段时，系统自动触发公交站台信息播报，提醒驾乘人员注意减速避让；

综合信息发布：通过V2X Server平台可以定向下发诸如文旅、商超活动等便民服务；



## 2.7 仿真系统、数字孪生

### 2.7.1 仿真系统

车路协同系统是一种功能复杂的大系统，进行系统功能仿真测试是系统投入运营前的必备环节。因此，针对车路协同运行控制系统的功能测试需求，建立可视化的仿真平台以支持系统的全面、高效、可重复测试。

![image-20210603113915972](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603113915972.png)

#### 1. 车路协同典型场景建模

在车路协同系统进行多车仿真时，车车信息交互模型将模拟车辆之间的信息交互。

![image-20210603114020588](https://gitee.com/AiShiYuShiJiePingXing/img/raw/master/img/image-20210603114020588.png)



### 2.7.2 数字孪生平台

产品的最后最优秀的呈现和解决方案，就是彻底实现车路协同的数字孪生平台，将车路协同的所有应用场景以数字孪生的方式进行呈现。