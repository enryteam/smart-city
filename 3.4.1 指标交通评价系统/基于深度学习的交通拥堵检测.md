- [基于深度学习的交通拥堵检测]

丁 洁,刘晋峰,杨祖莨,阎高伟

摘要:针对交通拥堵检测,提出一种利用深度学习中卷积神经网络(convolutionalneuralnetwork,CNN)对交通拥堵图像进行检测的方法。首先,使用基于TensorFlow框架设计了含有三层卷积层的神经网络分类模型。其次,利用道路拥堵与非拥堵图片对分类模型进行训练,并进行评估。最后,利用训练完成的模型进行道路拥堵检测,与多种深度学习分类模型分类方法进行对比实验,表明该卷积神经网络模型能够更有效地进行拥堵检测,检测准确率达到了98.1%。
关键词:拥堵检测;卷积神经网络;深度学习;TensorFlow

随着计算机视觉的发展及公路上全路段视频监控的实现,为基于视频图像的拥堵检测提供可能[4]。目前基于视频图像的交通拥堵检测方法大部分是对车辆数量进行检测。例如对感兴趣区域进行处理[5],提取车辆目标以统计车辆数,再根据车辆数进行交通拥堵的判断。再如,利用背景差分法和帧差法分析图像的纹理变化情况,从而得出道路空间占有率和时间占有率以判断道路拥堵的情况[6]。以上拥堵检测方法易受环境变化的影响,如光照强度及路面反光等,无法应用于不同的场景中。

近年来,卷积神经网络(convolutionalneuralnetwork,CNN)在图像处理领域的应用逐渐增多,其有着自动提取图像特征、鲁棒性很强等优点[7]。Lecun等[8]针对手写字符识别,首次提出了LeNet-5图像识别模型,获得了极佳的效果。Alex通过加深网络层数、使用CUDA进行训练等方式获得了效果更好的AlexNet[9]。

而后,谷歌提出的GoogLeNet与牛津大学提出的VGG(visualgeometrygroup)模型以较小的卷积核尺寸增强了网络的实用性及简洁性,分别获得2014年ILSVRC竞赛的第一名、第二名,但是VGG在多个迁移学习任务中的表现优于GoogLeNet[10]。之后基于CNN的分类模型有了长足发展,He等[11]在2016年提出了用于图像识别的深度残差模型ResNet,通过使用残差结构优化了深层CNN模型。Howard等[12]于2017年提出了轻量级模型MobileNet,其通过深度可分离卷积优化了模型结构,使检测速度大大提高。目前,已有研究人员将经典卷积神经网络结构应用于道路拥堵识别中,如罗荣辉等[13]通过改进AlexNet模型的网络结构来检测道路拥堵情况,检测速度达到了0.012s/帧,但是其存在模型臃肿、检测速度较慢的缺点。因此,卷积神经网络在道路拥堵识别中的应用仍有待发展。

基于以上研究,笔者提出一种利用深度学习卷积神经网络的方法进行道路拥堵判断,实现对道路拥堵的准确检测,并且检测速度得到改进。在文章第一部分设计了所使用的卷积神经网络模型结构,并对模型进行训练。在第二部分进行了对比实验,利用多种卷积神经网络模型的分类结果进行比较,并对网络结构进行了消融实验。第三部分对实验结果进行了讨论。

# 1 设计CNN分类模型

本文中所设计的基于CNN的分类模型主要由3个模块组成,如图1所示分别为:图片预处理模块、卷积神经网络模块和结果优化模块。下面将对模块内容进行详细介绍。

![image-20211108100312590](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100312590.png)

## 1.1 图片预处理模块

图片预处理模块主要进行的步骤为:
1)对图片数据进行增强,包括了随机翻转、变换亮度等,以丰富数据集;
2)对图像统一缩放为64×64大小,以便于输入至卷积层中。
其中,训练集中某图片操作结果如图2所示。

![image-20211108100337607](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100337607.png)

## 1.2 卷积神经网络模块

本文中所设计的三层卷积神经网络结构如图3所示。

![image-20211108100356297](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100356297.png)

在图3的结构中,选用了5×5与3×3的小卷积核进行特征提取,减少了参数数量,加快了训练与识别的速度。在每一层中使用Leaky-ReLU激活函数与Batch-Normalization。图4为ReLU与Leaky-ReLU函数图像,相较于普通使用的ReLU激活函数,Leaky-ReLU更全面地保留了特征信息。

![image-20211108100416496](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100416496.png)

式(1)为Leaky-ReLU函数公式,ai 是(1,+∞)区间内的固定参数。Leaky-ReLU给所有负值赋予一个非零斜率,保留了一定的特征效果。而结构图3中的Batch-Normalization层通过规范化卷积的输出,使得激活函数的输入值能进入对输入比较敏感的区域,避免了梯度消失问题[14]。

![image-20211108100441790](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100441790.png)

## 1.3 优化模块

本文中所设计的优化模块网络结构如图5所示。

![](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100517112.png)

在图5的结构中,Flatten层可将卷积层3的输出“压平”,把多维输入一维化,实现卷积层到全连接层的过渡;Dense层则为全连接层,对卷积的结果进行特征的进一步提取。其中,第一个Dense层含有128个神经元,可将卷积层3中卷积层提取的局部特征进行全连接,实现特征的融合;由于本文中针对的交通拥堵分类是二分类问题,因此第二个Dense层只含有一个神经元,作用为融合所有特征,便于之后进行类别概率计算。

损失函数为二分类交叉熵损失Sigmoid_cross_entropy,其公式为:

![image-20211108100536367](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100536367.png)

式中:t为Dense层的输出,S(t)为输出类别概率,这样就将卷积层的输出变换为二分类概率。
优化模块主要采用了DropOut算法以减轻过拟合的产生,并提高模型的泛化型。DropOut算法示意图如图6所示。

![image-20211108100609721](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100609721.png)

DropOut可以解决过拟合的原因在于[16]:
1)训练时可产生多种网络:在训练过程中,如果使用相同的数据去训练不同的网络,会得到不同的结果,那么将这些结果取平均后,可以有效避免过拟合。DropOut可以在每次训练时随机放弃一些神经元,模拟产生多种不同的网络结构;

2)减少某些神经元的敏感性:神经网络应该在学习时更具有鲁棒性,DropOut能让一些神经元不是每次都在网络中出现,这样就有效减轻了网络对特定信息的依赖。

## 1.4 模型训练

在对模型进行训练时,使用9457张图片作为数据集,其中,5000张图片为训练集,2320张图片为验证集,2137张图片为测试集。所用图片采集于山西省太原市街道内,数据集中包括了不同角度、不同光照条件下的场景图片,如图7所示,包含了不同角度、在白天夜晚条件下的场景。

在训练神经网络模型时,学习速率为0.001,每次迭代选择32张训练集图片进行训练,训练轮次epochs=1000,图8为训练过程中的损失与准确率指标的展示。

![image-20211108100657431](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100657431.png)

图8结果表明,经过1000轮训练后,本文模型所达到的验证准确率为99%。

## 1.5 消融实验

为了验证优化模块的有效性,对模型结构进行了消融实验,如表1所示,验证模型1不使用DropOut方法,其余结构不变;验证模型2不使用Leaky-ReLU激活函数而使用普通的ReLU激活函数,其余结构不变。

![image-20211108100714159](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100714159.png)

对验证模型1、验证模型2在同样的训练集下,以学习速率为0.001,每次迭代选择32张训练集图片进行训练,训练轮次epochs=1000,图9、图10为验证模型的训练结果展示。

![image-20211108100733777](https://gitee.com/er-huomeng/l-img/raw/master/image-20211108100733777.png)

图9、图10表明,验证模型1、验证模型2在训练后均已收敛,且训练集的验证准确率达99%以上。