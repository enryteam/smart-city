- [基于车辆轨迹数据的信号交叉口实时排队长度估计](https://into.tongji.edu.cn/info/1103/1520.htm)

排队长度作为信号控制交叉口最重要的运行评估指标之一，能够反映交通需求的变化，尤其是周期级的排队长度对信号控制优化和城市道路拥堵管理具有重要作用。随着智能网联、移动互联网等技术的发展与应用，海量高频互联网车辆轨迹数据的实时获取成为可能，为信号控制排队长度的估计提供了新机遇。然而，现有的基于轨迹数据的排队长度估计方法多需已知信号配时、到达模式、渗透率等信息，适用范围有一定限制。因此，本研究的目标是基于轨迹数据，在不做任何参数假设的情况下，估计周期排队长度。

本研究的方法核心是结合冲击波理论与车辆运动学模型，基于浮动车轨迹数据还原车辆的排队与消散过程。在此基础上，识别车辆的关键启停点以及到达模式拐点，从而划分出到达类型，并进一步估计信号配时、排队长度参数，其算法主要可分为四个步骤。

Step1：将车辆状态划分为三类：运动状态、停车状态以及爬行状态。其中，爬行状态用来描述车辆在加入排队车队之前，遵循的一类可近似为低速匀速运动的频繁启停操作。在此基础上，可基于轨迹数据判别车辆的关键启停点，即车辆加入排队、离开排队的时间以及位置，该过程通过带有约束条件的最小二乘拟合实现。车辆运动状态示例如图1所示，其中，M代表运动状态，C代表爬行状态，S代表停车状态。

![img](https://into.tongji.edu.cn/__local/8/1C/2C/486E8C19242729CA07D0EA84CCA_5B52AFED_3147B.png)

**图1 车辆运动状态示意图**

Step2：还原车辆到达过程。基于上一步骤所得到的车辆关键启停点信息，可识别并提取车辆到达拐点，即到达模式的分界点。此过程主要用来拟合排队车辆集结波，可通过分段线性拟合方法得到，车辆到达拐点识别示例如图2所示，其中，不同的椭圆表示不同的到达类型，椭圆间隔则为拐点。

![img](https://into.tongji.edu.cn/__local/E/75/D9/96504CB6EA1C5E5DFEB63A6E027_11B78D56_96D85.png)

**图2 车辆到达拐点识别示意图**

Step3：基于上述步骤所重构出的交通波，可进一步估计周期内的信号配时参数（红灯启亮时刻、绿灯启亮时刻）。首先，基于交通波重构所得到的消散波，确定绿灯启亮时刻，并结合下一周期绿灯启亮时刻，计算当前周期时长；同理，可基于交通波重构所得到的集结波，确定红灯的起始时刻。

Step4：确定周期内的最大排队长度以及剩余排队长度。基于重构得到的交通波，得到周期内最大排队长度，同时结合Step3估计得到的配时信息，进一步计算过饱和场景下的剩余排队信息。

本研究方法通过仿真场景予以验证，共包含60个验证场景（采样间隔分为取5s，10s，25s，渗透率为5%~100%，且间隔为5%）。作为对比，另一种基于轨迹数据的排队长度计算方法作为对比验证（Ramezani, M., and N. Geroliminis. Queue Profile Estimation in Congested Urban  Networks with Probe Data. Computer­Aided Civil and Infrastructure  Engineering, Vol. 30, No. 6, 2015, pp.  414–432），该方法首先将浮动车轨迹数据分为停车数据与运动数据两类，并通过聚类算法将运动数据分到不同的周期区间内。在此基础上，基于带有约束的最小二乘拟合估计排队车队起始点信息，并在不考虑到达模式的基础上，通过曲线拟合得到周期内最大排队长度。相比于此对比方法，本研究将车辆运动过程分为三类，可更为精确地识别车辆的关键启停点，同时，分别使用带约束的最小二乘拟合与分段线性拟合方法计算消散波与集结波，进而得到排队长度。而对比方法则将此过程视为非线性优化问题，需要三类标定参数作为输入。

仿真验证结果显示，本研究的信号参数估计精度与轨迹采样间隔呈正相关，当采样间隔为5s~25s时，其误差为0.26%~6.79%。此外，本研究与对比方法均能得到理想的排队长度估计结果，如下图所示，当采样间隔分别为5s、15s与25s时，渗透率分别低于47%，40%与20%时，本研究的平均绝对百分比误差更低，成功率更高。由此可见，本研究更能在低渗透率场景下发挥出优势。

![img](https://into.tongji.edu.cn/__local/1/5A/FB/1BEB7D05A49FB2FE9F8ED95B76E_D89CA0DD_342D5.png)

**图3 排队长度估计结果** 



​           