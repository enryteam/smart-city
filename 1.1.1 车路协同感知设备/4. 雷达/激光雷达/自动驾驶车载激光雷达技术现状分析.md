- [自动驾驶车载激光雷达技术现状分析](https://mp.weixin.qq.com/s/kSakb_BW_4STnIB48lY9oA)


**本报告将自动驾驶领域最为关键的传感器——激光雷达作为中心，**通过调研其所扮演重要角色的领域——自动驾驶，以及自动驾驶和激光雷达的国内外发展现状，深入了解激光雷达的技术背景。以目前智能车生产厂家所采用的传感层技术为切入点，通过了解、掌握这些技术的特点、基本原理、适用场景、优缺点，来进一步深入激光雷达，了解其分类、基本工作原理、主要技术指标，对用于智能车的车载激光雷达的主要厂家、产品进行调研，获得主流产品的主要性能指标参数、测试数据等。

## 1 自动驾驶车载激光雷达技术现状分析

### 1.1 研究背景与意义

早期激光雷达主要用于军事和民用地理测绘(GIS)等领域，比如地质测绘、监测树木生长、测量建筑项目进度等。随着自动驾驶的兴起，对于环境感知要求日趋严格，在自动驾驶架构中，传感层被比作为汽车的“眼睛”，包括车载摄像头等视觉系传感器和车载毫米波雷达、车载激光雷达和车载超声波雷达等雷达系传感器，其中激光雷达已经被广泛认为是实现自动驾驶的必要传感器。相比于其它类型的自动驾驶传感器，如摄像头，激光雷达探测的距离更远，精度更高。相对于摄像头而言，激光雷达由于为主动发射光束，故比较不容易受周围环境如弱光、雨雪烟尘的影响，而且摄像头在进行图像识别处理时需要消耗大量的处理器能力，而激光雷达产生的三维地图信息更容易被计算机解析。相比毫米波雷达，激光雷达的分辨率更高，并且毫米波雷达也不适用于行人检测和目标识别等工作。在自动驾驶领域，激光雷达与其它传感器互为补充，可以有效提高车辆对于周围环境感知的准确度。

本文以目前智能车生产厂家所采用的传感层技术为切入点，通过了解、掌握这些技术的特点、基本原理、适用场景、优缺点，来进一步深入研究其中对于自动驾驶最为关键的传感器——激光雷达，了解其分类、基本工作原理、主要性能指标，对用于智能车的车载激光雷达的主要厂家、产品进行调研，获得主流产品的主要性能指标参数、测试数据等。对车载激光雷达进行仿真，不仅能节省大量的燃料和经费，而且不受天气和场地的限制，因此具有巨大的经济效益。在仿真软件中，可以灵活地设置各种参数、模拟条件，同时也不存在安全隐患，因此具有巨大的社会效益。由于目前国内外对于车载激光雷达仿真系统的研究较少，本文抛砖引玉，尝试归纳、分析上述内容，最终得出车载激光雷达仿真系统的主要技术要求。

### 1.2 自动驾驶概述

SAE(国际汽车工程师协会)J3016 文件提出的五级自动驾驶分级方案是当前被普遍采用接受的标准，将自动驾驶技术分为 L0 ~ L5 共六个等级。L0 代表没有自动驾驶加入的传统人类驾驶，L1 ~ L5 则将自动驾驶的发展程度进行了分级：

表 1-1 SAE 自动驾驶定义和分级标准。

(注：参照[1]中表格修改整理)

![图片](https://gitee.com/er-huomeng/img/raw/master/640)

![image-20211206140804101](https://gitee.com/er-huomeng/img/raw/master/image-20211206140804101.png)



无人驾驶专指 L4、L5 阶段，即驾驶员不介入的情况下汽车可以完成全自动驾驶的控制动作，指向自动驾驶汽车技术发展的最终形态。

自动驾驶覆盖 L1 到 L5 整个阶段，在 L1、L2  阶段，汽车的自动驾驶系统只作为驾驶员的辅助，但能够持续地承担汽车横向或纵向某一方面的自主控制完成感知、认知、决策、控制、执行这一完整过程，其他如预警提示、短暂干预的驾驶技术(ADAS, Advanced Driver Assistance  Systems)不能完成这一完整的流程，不在自动驾驶技术范围之内。即汽车至少在某些具有关键安全性的控制功能方面(如转向、油门或制动)无需驾驶员直接操作即可自动完成控制动作。自动驾驶汽车一般使用机载传感器、GPS 和其他通信技术设备获得信息，针对安全状况进行决策规划，在某种程度上恰当地实施控制。自动驾驶包括无人驾驶。

智能驾驶指搭载先进的智能系统和多种传感器设备(包括摄像头、雷达、导航设备等)，具备复杂的环境感知、智能决策、协同控制和执行等功能，可实现安全、舒适、节能、高效行驶，并最终可替代人来操作。智能驾驶包括自动驾驶以及无人驾驶。

以上三者的关系可由下图表示：

![image-20211206140845711](https://gitee.com/er-huomeng/img/raw/master/image-20211206140845711.png)

图 1-1 无人驾驶、自动驾驶、智能驾驶关系图

### 1.3 智能车辆国内外发展现状及趋势概述

自 1886 年汽车诞生以来，结构逐步成型;1913 年，汽车开始采用流水先生产;1932 年，高速公路诞生;20 世纪  50 年代，被动安全系统，如安全带、安全气囊出现;至此，以底盘、传动、轮胎、车身、机械为核心技术的汽车逐渐开始规模化生产，同时，国内汽车工业开始起步。1970 年，Ford 最早装配防抱死制动系统(ABS, Anti-lock BrakingSystem)这一主动安全系统;1995年，Mercedes-Benz  率先配备电子稳定系统(ESP,Electronic Stability  Program);至此，以发动机、早期汽车电子技术、安全系统和节能为核心技术的汽车性能不断优化，大量资金和技术被引入，同时，国内汽车工业全面发展。2009 年，Google  开启自动驾驶项目，以汽车电子技术、自动驾驶、新能源为核心技术的汽车逐步向智能化、轻量化、电动化、网联化、出行方式共享化等方向发展;自动驾驶作为重要的发展趋势之一，将再次彻底改变出行方式。我国汽车工业起步较晚，但在新能源汽车等领域进展较快，并率先赶上自动驾驶研发热潮，有望在汽车产业发挥引领作用。

美国在 20 世纪 80 年代初已经开始自动驾驶技术的军事化应用，欧洲从  80 年代中期开始研发自动驾驶车辆，更多强调单车自动化、智能化的研究，日本的自动驾驶研发略晚于欧美，更多关注于采用智能安全系统降低事故发生率，以及采用车间通信方式辅助驾驶。在初期，自动驾驶研发在欧美日已呈现『产学研』相结合的特点，开发测试了不同程度自动化、智能化的车辆，进入 21 世纪，美国国防高等研究计划署(DARPA, Defense Advanced Research Projects  Agency)举办的挑战赛进一步提高了自动驾驶的社会关注度，激发了相关从业者的研发热情。由于深度学习算法的引入，自动驾驶技术有了爆炸性的突破。2009 年，Google  布局自动驾驶，引发了新一轮的产业热潮，更多的科技企业加入市场争夺中。2020 年前后，成为主要汽车厂商和科技企业承诺推出完全自动驾驶车辆的时间节点。

自上世纪 90 年代起，国内各高校和研究机构已经陆续开展自动驾驶的研发工作，推出多个测试车型，其中国防科技大学于 1992  年研制出第一款自动驾驶汽车CITAVT-Ⅰ 型。2009  年以来，国家自然科学基金委员会举办『中国智能车未来挑战赛』，吸引多个高校和研究机构参与，为自动驾驶技术的交流和发展起到了良好的促进作用，在此期间，一汽、北汽等传统车企也逐步布局。自国务院在 2015 年发布《中国制造  2025》起，以自动驾驶技术为重点的智能网联汽车成为未来汽车发展的重要战略方向，大批初创企业投身自动驾驶领域；2016  年，中国工信部装备工业司汽车处处长表示，正和警方合作起草自动化驾驶道路测试标准化的规定；北汽、上汽、长安等车企相继公布自动驾驶战略规划，国内自动驾驶集中爆发，多个车企公布自动驾驶的战略规划;2017 年，《汽车产业中长期发展规划》发布;筹建智能网联汽车分技术委员会，制定产业技术标准;百度公布 Apollo  计划，还有更多的初创企业脱颖而出，获得巨额投资，可以说，自动驾驶产业已经进入新技术最为火爆的中场阶段。

### 1.4 车载激光雷达国内外发展现状及趋势概述

目前，全球最大的车载激光雷达公司——Velodyne LiDAR 的前身是硅谷科技公司 Velodyne，它在 Google 布局无人驾驶汽车之前就开始在车载激光雷达产业发力，之后与 Google 合作，成为了车载激光雷达产业的龙头。其包含了专注于音频设备的 Velodyne Acoustics 公司和专注于海洋问题解决方案的  Velodyne Marine 公司，同样地，Velodyne 在 2016 年将 Velodyne LiDAR  作为一家独立的公司剥离出来，这时正处于世界范围内车载激光雷达相关技术飞速发展时期。其旗下的 HDL-64E  型机械激光雷达被广泛采用于自动驾驶车辆的测试中，不过其高昂的价格和低生产率也提醒各个科技巨头车载激光雷达的低成本化和量产化相当关键，这也正是  Tesla 一直不采用这种『3D 激光雷达』方案，而是坚持采用『毫米波雷达 + 摄像头』方案的原因。目前 Velodyne LiDAR  已经推出成本更低、线数更多的 128 线的 VLS-128  型固态激光雷达，这意味着这款激光雷达有更高的分辨率、安全性以及更低的成本，并且可以实现量产。然而，『3D  激光雷达 + 高精度导航地图 + 云计算』被认为是未来理想的综合性解决方案，也就是说，从发展趋势看，就汽车智能驾驶领域，『毫米波雷达 + 摄像头』方案终将随着车载激光雷达的成本下降而被逐渐取代。

不过，在 Velodyne 推出 VLS-128  之前，整体车载激光雷达市场上的趋势都是往低线束化、固态化发展，也就是往减少激光雷达线束发展，同时也从机械型转为固态型，比如 Quanergy  公司就在 2016 年 CES 展会上推出了与 Delphi 公司共同研发的新产品 S3，号称全球首款固态激光雷达，就连 Velodyne  公司本身也在推出混合或固态的低线束激光雷达。因为这样做可以降低成本，但是需要用数量来弥补线数的不足，也体现出未来的技术路线未定，产业龙头  Velodyne LiDAR 也不能确定到底是多线束激光雷达还是多激光雷达耦合。Velodyne LiDAR  认为对于一辆在复杂环境中高速行驶的自动驾驶汽车来说，HDL-64  的性能还不够保证安全，更高线程的激光雷达不仅可以配合一些必要的设备保证安全，还可以让自动驾驶汽车将不再需要任何其它探测障碍的传感器。但是  Velodyne LiDAR 的竞争对手 Luminar  公司也在做低线束固态激光雷达，其认为由于激光扩散的原因，距离越远，精准度越低。所以，绝大多数的自动驾驶公司在使用最先进的激光雷达的情况下，还是会选择添加其他种类的传感器。各大车载激光雷达公司之间的争论也是行业的技术现状之一，至于车载激光雷达技术之后如何发展，还需要看各科技公司的研发情况以及实际测试的结果。

从以上对国外车载激光雷达技术现状的分析中能够得到的统一趋势有低成本化、固态化、量产化，但是 Velodyne LiDAR  推出更高线束的激光雷达和其他科技厂商推出低线束激光雷达的行为并不矛盾，他们的整体方向依然是要实现激光雷达的更高分辨率和精准度，进一步保证无人驾驶的安全性，只不过前者倾向于使用更强大的设备，后者倾向于使用多激光雷达耦合并降低成本。同时，低线束激光雷达对高线束激光雷达可以起到补充的作用。

实际上国内车载激光雷达的发展不比国外起步晚，北科天绘于 2005 年成立于北京，和 Velodyne  的激光雷达计划几乎同时开始，然而目前来看，国外的车载激光雷达水平较高。尽管自动驾驶市场需求量极大，激光雷达仍面临着成本高、量产难的问题。制造门槛高，且应用领域较窄(汽车、资源勘测)，使该类产品供应商相对较少，缺乏针对车规级的成熟量产方案。要推动激光雷达解决方案落地，供应商势必要完整掌握硬件的核心技术，以便控制成本，并以配套的算法推动市场接受其方案。目前，实现激光雷达低成本的路线有：牺牲一定的精度，使用全固态、低线束激光雷达降低制作成本;提高生产率，通过量产带来的规模效益摊薄产品成本。速腾聚创、禾赛科技等公司均提供自动驾驶的『硬件 + 算法』一体化解决方案，希望以低线束、低成本、量产化的激光雷达产品打通市场;用于机器人、无人机的激光雷达产商北醒光子、思岚科技也在向自动驾驶布局。尽管部分厂商已有成品，并与其它初创公司达成合作，但能否打通主机厂和 Tier1(一级供应商)尚存疑。相较而言，在2016年，全球顶尖厂商Velodyne-LiDAR在中国的销售额已达到 1500 万美元。

### 1.5 本章小结

本章将自动驾驶领域最为关键的传感器——激光雷达作为切入点，通过调研其所扮演重要角色的领域——自动驾驶，以及自动驾驶和激光雷达的国内外发展现状，从行业和科研等多方面了解激光雷达的技术背景。

## 2 智能车辆的传感层技术分析

### 2.1 传感器介绍

在自动驾驶技术来临之前，车用传感器即用于汽车电子技术、作为车载电脑(ECU)的输入装置，能够将发动机、底盘、车身各个部分的运作工况信息以信号方式传输给车载电脑，从而使汽车运行达到最佳状态。ADAS(高级辅助驾驶系统)的广泛应用，使摄像头等用于环境感知的传感器进入公众视野，作为辅助，这些传感器将汽车周边的环境信息输入到相应的系统模块中，进行判断，提前给驾驶员预警或提供紧急防护，但不同系统的传感器间关系孤立，数据单独处理，信息尚未形成融合。在自动驾驶汽车中，定位、雷达、视觉等传感器协作融合，能够以图像、点云等形式输入收集到的环境数据，并通过算法的提取、处理和融合，进一步形成完整的汽车周边驾驶态势图，为驾驶行为决策提供依据。

除了激光雷达之外，本文再对摄像头、毫米波雷达、超声波传感器、定位传感器这部分重要传感器作简要介绍：

#### 摄像头

用摄像头代替人眼对目标(车辆、行人、交通标志)进行识别、跟踪和测量，感知到汽车周边的障碍物以及可驾驶区域，理解道路标志的语义，从而对当下的驾驶场景进行完整描述。摄像头必须先识别再测距，如果无法识别则无法测距。相对于其它传感器，摄像头的价格相对低廉，有着识别车道线、车辆等物体的基础能力，在汽车高级辅助驾驶市场已被规模使用。依据不同的图像检测原理，可分为单目摄像头和双目摄像头，根据芯片类型又可分为 CCD 摄像头和 CMOS 摄像头，等等。其优点在于摄像头是目前唯一能够辨别物体的传感器。

但是摄像头同时具有三个缺点：缺点一是逆光或光影复杂的地方难以使用;缺点二在于依赖于算法，能否辨别物体完全依赖样本的训练，样本未覆盖的物体将无法辨别，比如 Mobileye 在中国道路上应用，识别超载运货车的成功率不超过  80%;缺点三在于摄像头对于行人的识别具有不稳定性，因为行人不同于车辆，动作、服装、身体各部分变化要素很多，而且还要与街上的建筑、汽车、树木等背景图案区分开来，比如 Mobileye 在日本、德国、美国、以色列等国市区的测试结果显示，行人的成功检测率为  93.5%，距离实现完全无人驾驶还有很大差距，再如穿着吉祥物套装或着装颜色与背景相似的人或搬运东西的人极有可能无法识别。因此，摄像头的物体识别功能无可比拟，但由于依赖样本识别物体，以及识别行人具有不稳定性，摄像头应用于测距领域无法保障 100% 的稳定性，在自动驾驶领域脱离激光雷达使用只能应用于 ADAS 而不能应用于完全的无人驾驶。

从硬件方面看，计算机视觉所需的工业摄像头在技术层面相对成熟，具有较高的图像稳定性、高传输能力和抗干扰能力，且单个摄像头成本已降到 200 元以下，因此单车可以配备 6~8 个摄像头覆盖不同角度，天风证券预测，2020 年国内前后装摄像头需求量为 4184 万个。

#### 毫米波雷达

发射 1~10 毫米的电磁波，根据反射波的时间差及强度等来测量距离，汽车毫米波雷达的频段主要在 24 GHz 和 77  GHz。其优点在于性价比较高，探测距离远，精度较高，穿透雾、灰尘的能力强，能够全天候全天时工作，在很多高档轿车里都有应用;缺点是行人的反射波容易被其他物体反射波埋没，难以分辨，无法识别行人，例如采用毫米波雷达和摄像头的感知系统实现自动驾驶的  Tesla，在行人较多的闹市区会自动锁定自动驾驶功能。因此，毫米波雷达在测距领域具有较高性价比，但是其无法探测行人是一个致命弱点，只能应用于自适应巡航系统等 ADAS 系统。目前毫米波雷达市场由国外厂商垄断，国内主要的零部件供应商正在致力于车载毫米波雷达的国产化。79 GHz  毫米波雷达作为未来发展趋势，能更有效地发挥自动驾驶传感器所需的性能。

#### 超声波传感器

发射振动频率高于声波的机械波，根据反射波测量距离。其优点在于探测物体范围极广，能够探测绝大部分物体，且有较高稳定性;缺点是一般只能探测 10 米以内的距离，无法进行远距离探测。因此，超声波雷达广泛应用于倒车雷达，在自动驾驶领域常常作为短距离雷达，应用如自动泊车辅助系统。

#### 定位传感器

可以获得自身相对于全局的位置信息。其优点在于技术较为成熟，能够实现在全局视角的定位功能;缺点在于无法获得周围障碍物的位置信息。往往需要与前几个探障类传感器搭配使用。

### 2.2 传感器分类

智能车辆的传感器可以分为视觉传感器、定位传感器、雷达传感器、听觉传感器和姿态传感器。其中视觉传感器可以分为单目摄像头、双目摄像头、夜视红外摄像头;定位传感器可以分为惯性导航系统、卫星导航系统(GNSS)、高精度地图、实时动态(RTK)差分系统;雷达传感器可以分为激光雷达和毫米波雷达;听觉传感器可以分为语音识别、声音定位入口;姿态传感器可以分为车载诊断系统(OBD)、CAN 总线、惯性测量单元(IMU)、发动机等汽车工况传感器。主要的传感器为激光雷达、毫米波雷达、摄像头、超声波雷达、GNSS 辅助传感器，其中  GNSS 辅助传感器包括惯性导航系统和 RTK 差分系统。

#### 传感器分类图如下

![image-20211206141004646](https://gitee.com/er-huomeng/img/raw/master/image-20211206141004646.png)

图 2-1 智能车辆传感器分类图

需要说明的是，以上提到的智能车传感器并不一定会同时出现在一辆车上。某种传感器存在与否，取决于这辆车需要完成什么样的任务。如果只需要完成高速公路的自动驾驶，比如 Tesla 在 Model S 里使用的 Autopilot  自动辅助驾驶功能是不需要使用激光雷达的;但如果需要完成城区路段的自动驾驶，没有激光雷达，仅靠视觉传感器是很困难的。

### 2.3 传感器比较

不同传感器各有优劣。无论是『毫米波雷达 + 摄像头』方案还是『3D 激光雷达』方案都不具备独当一面的能力。前者距离实现需要解决的问题是如何达到识别车辆、识别人体  100% 的成功率以及如何达到识别任何物体并测量距离  100% 的成功率;而后者距离实现需要解决的问题是大雨和大雪等恶劣条件下的调试以及逐渐摆脱对于高精度地图的依赖。**两种方案看似竞争，实则互补。**技术上的不同方向很有可能形成两种方案的互相启发与互相补充。可见，自动驾驶汽车要安全运作，必须保证多传感器协同工作和信息冗余。因此，多种传感器往往需要协同工作，优势互补，共同组成自动驾驶的环境感知解决方案。

表 2-1 智能车辆主要传感器比较

![image-20211206141033815](https://gitee.com/er-huomeng/img/raw/master/image-20211206141033815.png)

![image-20211206141044310](https://gitee.com/er-huomeng/img/raw/master/image-20211206141044310.png)

表 2-1 智能车辆主要传感器比较

### 2.4 本章小结

本章以目前智能车生产厂家所采用的传感层技术为切入点，通过了解、掌握这些技术的特点、基本原理、适用场景、优缺点并进行比较，进一步说明激光雷达在自动驾驶领域中为何了扮演不可替代的角色。

## 3 激光雷达技术分析

### 3.1 激光雷达分类

对于激光雷达，可以分别按照探测体系、应用方向、线束、基于机械/电子部件分类如下：

![image-20211206141115669](https://gitee.com/er-huomeng/img/raw/master/image-20211206141115669.png)

图 3-1 激光雷达分类图

### 3.2 激光雷达工作原理

LiDAR，是英文 Light Detection And Ranging  的缩写，中文名称为激光雷达。激光雷达作为在激光测距雷达基础上发展起来的一项主动成像雷达技术，如图3-2  所示，通过发射和接收激光束，分析激光遇到目标对象后的折返时间，计算出到目标对象的相对距离，并利用此过程中收集到的目标对象表面大量密集的点的三维坐标、反射率和纹理等信息，快速得到出被测目标的三维模型以及线、面、体等各种相关数据，建立三维点云(Point  Cloud)图，绘制出环境地图，以达到环境感知的目的。由于光速非常快，飞行时间可能非常短，因此要求测量设备具备非常高的精度。从效果上来讲，激光雷达维度(线束)越多，测量精度越高，安全性就越高。

相比于可见光、红外线等传统被动成像技术，激光雷达技术具有如下显著特点：一方面，它颠覆传统了二维投影成像模式，可采集目标表面深度信息，得到目标相对完整的空间信息，经数据处理重构目标三维表面，获得更能反映目标几何外形的三维图形，同时还能获取目标表面反射特性、运动速度等丰富的特征信息，为目标探测、识别、跟踪等数据处理提供充分的信息支持、降低算法难度;另一方面，主动激光技术的应用，使得其具有测量分辨率高，抗干扰能力强、抗隐身能力强、穿透能力强和全天候工作的特点。

![image-20211206141145971](https://gitee.com/er-huomeng/img/raw/master/image-20211206141145971.png)

图 3-2 激光测距原理

大多数激光雷达系统主要包括四部分：激光器、光学扫描器，光电检测器，导航系统。本节将简单说明各部分的原理、功能以及技术指标。

#### 3.2.1 激光器

激光和发光二极管都起源于 20 世纪  60 年代，激光是受激辐射的光放大而来，两者都使用二极管产生不同形式的光，当电通过发光二极管时，发出非相干的可见光，光射向所有的方向;激光器使用高度专业化的二极管，其在电磁光谱的光学部分处或附近产生能量。当这种能量对人眼可见时，我们将其称为“光”，当不可见时，我们将其称为“辐射”，这与放射性物质的辐射不同。来自激光器的能量通过称为受激发射的原子过程被放大到极高的强度，最后将能量变成高度定向的波束，意味着所有的单个能量波被对齐，变为“同相”并且沿相同的方向移动。举个例子的话，发光二极管的能量就像在游乐场的保险杠车;而激光的能量就像赛车，并且它们会同时向同一方向冲出去。发光二极管照明广泛，而激光精确定位，最适合需要聚焦和精确度的任务。

根据激光输出功率和波长、脉冲持续时间的不同，**国际电工委员会(IEC)将激光分为 4 类：**

**Category 4 是最高强度的激光，**可以造成火灾以及对皮肤造成伤害，同时存在漫反射危险，也就是说激光表面的脉冲反射也是危险。

**Category 3 同样对人类有危害，**但是在长时间直射眼睛的情况下才是有危害的，一般人眨眼的频率会保证眼睛在短时间内直射不会受害。但是不会造成火灾以及对皮肤造成伤害。

**Category 2 肉眼可见，**但是通常直射眼睛会不舒服，长时间直射也不安全。

**Category 1m 是第二安全的类型，**如果观察者使用望远镜等光学放大装置直接观察到直径为 1m 的光束就不安全了。

**Category 1 最安全的激光类型，**这个类别包括所有的激光或激光系统，它们的光辐射水平在任何曝光条件下都不会高于眼睛的暴露极限。

#### 3.2.2 光学扫描器

激光雷达成像的速度取决于外部反射的光子经光学扫描部件进入系统的速度。市场上存在许多扫描的方法以改变方位角和仰角，如双振荡平面镜、双轴扫描镜、多面镜等。光学扫描器决定了激光雷达的分辨率和检测范围(角度)[2]。图 3-3 表示 HDL-64E 的光学扫描部件的结构。

![image-20211206141243459](https://gitee.com/er-huomeng/img/raw/master/image-20211206141243459.png)

注：本图参照[3]中图片

图 3-3 激光雷达光学扫描器部分

#### 3.2.3 光电检测器

光电检测器即读取和记录反射回到激光雷达的信号的设备。主要有两种光电检测技术，分别为固态检测器(Solid State Detector)和光电倍增管[2]。

#### 3.2.4 导航系统

当激光雷达安装在移动的平台，如卫星和飞机上时，它需要其它设备的协助以确定设备当前的位置和转向信息，这样才能保证激光雷达测量数据的可用性。卫星导航系统(GNSS, Global Navigation Satellite System)可以提供准确的地理位置信息，惯性测量单元(IMU, Inertial  Measurement Unit )则记录当前位置激光雷达的姿态和转向信息。GNSS 和 IMU  配合使用，可以将激光雷达测量点由相对坐标系转换为绝对坐标系上的位置点，从而应用于不同的系统中[2]。

### 3.3 激光雷达技术指标

#### 3.3.1 线束

为获得尽量详细的点云图，激光雷达必须要快速采集周围环境的数据。一种方式是提高发射机/接收机的采集速度，每个发射机在每秒内可以发送十万以上组脉冲，也就是说在 1 秒内，有 100,000 组脉冲完成一次发射/返回的循环。复杂的激光雷达有高达 64  组发射机/接收机，组就是线(Channel)的意思，线表示激光雷达系统包含独立的发射机/接收机的数目。多线的配置使得激光雷达在每秒内可构建高达百万的数据点。

图 3-4  示例多线激光雷达扫描的点云，图中每个同心圆表示一组激光器扫描的点云。对于两组相邻的激光器而言，其垂直间隔角为常量(下文“垂直角分辨率”将介绍到)。因此距离越远，相邻激光器扫描的点云同心圆间隔越大。也就是说，距离越远，数据的保真度越低。激光雷达对于近处的物体有更高的分辨率[2]。

![image-20211206141312213](https://gitee.com/er-huomeng/img/raw/master/image-20211206141312213.png)

注：本图参照[4]中图片

图 3-4 Velodyne HDL-64 激光雷达系统扫描的点云图

#### 3.3.2 方位角

**方位角(Field of View, FOV)包括水平方位角和垂直方位角，指的是激光雷达在水平和垂直方向的检测角度。**

上面提到线的概念，然而在实际应用中，64 线对于构建周围环境精确的点云是远远不够的，它只能在有限范围内达到足够的精度。但是在制造工艺上，把线数提高到 64  组以上，将大大提高设备的成本，因此不少激光雷达系统采用旋转镜头，如图  3-5，激光雷达的主体部分固定在旋转马达的基座上，工作时不断旋转，即可对周围 360°进行扫描，也就是说这些激光雷达的水平方位角为 360°。

垂直方位角指的是激光雷达垂直方向的检测角度，一般在40°以内[2]。VelodyneHDL-64E 几个激光发射单元之间有一定间隙，如图 3-6 所示。

![image-20211206141330658](https://gitee.com/er-huomeng/img/raw/master/image-20211206141330658.png)

注：本图参照[5]中图 4.2

#### 3.3.3 扫描帧频

激光雷达点云数据更新的频率。对于混合固态激光雷达来说，也就是旋转镜每秒钟旋转的圈数，单位 Hz 。例如，10 Hz 即旋转镜每秒转 10 圈，同一方位的数据点更新 10 次[2]。

#### 3.3.4 角分辨率

角分辨率分为水平角分辨率和垂直角分辨率。水平角分辨率是指水平方向上扫描线间的最小间隔度数。它是随扫描帧频的变化而变化，转速越快，则水平方向上扫描线的间隔越大，水平角分辨率越大。垂直角分辨率指的是垂直方向上两条扫描线的间隔度数[2]。

#### 3.3.5 测量精度

激光雷达的数据手册中的测量精度(Accuracy)常表示为，例如 ±2 cm 的形式。精度表示设备测量位置与实际位置偏差的范围[2]。

#### 3.3.6 探测距离

激光雷达的最大测量距离。在自动驾驶领域应用的激光雷达的测距范围普遍在100~200 m 左右[2]。

#### 3.3.7 数据率

激光雷达每秒钟生成的激光点数，例如：40 线扫描帧频为 20 Hz 的激光雷达，水平角分辨率是 0.45°(每一圈每束激光扫描 800 次)。因此每秒钟生成的激光点数和为：4020800 = 640, 000 points/sec[2]。

### 3.4 激光雷达测试分析

市场上车载激光雷达种类、型号繁杂，其中 Velodyne HDL-64E 是最受欢迎的激光雷达之一，其所使用的激光是 Category 1 类型，以大约  10 赫兹的频率快速旋转。同时，每个激光脉冲的波长为 905 纳米，平均功率为 2 毫瓦，相当于是标准 10 瓦 LED  大灯泡在近光灯设置下的功率输出的 0.02%。这意味着任何单个激光束将在大约 1  毫秒内扫过眼睛，平均功率小于普通的激光指示器。并且由于每个单独的激光器以不同的方向和角度安装，所以多个激光器不能一次同时直射眼睛并增加功率。即使行人有意盯着 Velodyne 传感器，低功耗和快速旋转的组合情况下也是 Category 1 级，十分安全。

另外，它由激光发射机、光学接收机、转台和信息处理系统等组成，激光器将电脉冲变成光脉冲发射出去，光接收机再把从目标反射回来的光脉冲还原成电脉冲，送到显示器。

其基本参数、实际输出数据格式和结构如表 3-1、表3-2 和图 3-7 所示：

表 3-1 Velodyne HDL-64E型激光雷达参数：

![image-20211206141423112](https://gitee.com/er-huomeng/img/raw/master/image-20211206141423112.png)

表 3-2 激光雷达输出数据格式表：

![image-20211206141444998](https://gitee.com/er-huomeng/img/raw/master/image-20211206141444998.png)

图 3-7 Velodyne HDL-64E 激光雷达组成示意图

利用有幸从别处取得的 HDL-64E 的数据，绘制得到点云图的其中一幅如下：

![image-20211206141455593](https://gitee.com/er-huomeng/img/raw/master/image-20211206141455593.png)

图 3-8 HDL-64E 实际数据所绘制的点云图

根据表 3-2 可得，HDL-64E 所输出的数据为点的 X，Y，Z 坐标，激光强度以及激光器的编号，由于对激光雷达的仿真不需要模拟出激光强度的效果，所以只需要对其他四个数据进行获取。

至于点云图的绘制，是对实际数据处理之后按照 Z  轴坐标的不同显示，不过实际数据和仿真采集数据的不同在于，实际数据中的点的坐标都是符合激光雷达数据规范的，仿真需要考虑的是将采集到的点筛选出符合规范的，再显示出来。下一节将会分别对模块仿真、数据处理、数据仿真进行详细说明。

### 3.5 本章小结

本章通过了解激光雷达的分类、基本工作原理、主要技术指标，对用于智能车的车载激光雷达的主要产品进行调研，获得主流产品的主要性能指标参数、测试数据等。

## 4 模块仿真

本文第 3.2 节详细说明了激光雷达的主要组成模块，在对激光雷达仿真时，可以考虑按模块分类并仿真。

实际的激光雷达是先发射激光束再接收返回的激光束而获取到点的坐标，并且其中还要依靠光学扫描器和光学检测器才能完成这一复杂的过程，而仿真的激光雷达只需要模拟激光器，也就是激光发射装置，进而获取到点的坐标，最后绘制成图即可。根据仿真经验，可以考虑使用 OpenGL 中透视投影的一点透视的方式设置相机视角，然后通过编写 shader 从相机中获取点数据。如图 3-1  所示，透视投影的视线(投影线)是从视点(观察点)出发，所有视线从视点出发，视线是不平行的。所以可以用 OpenGL  的配置透视投影的相机来充当激光雷达的观察方式，然后从相机中设法取出在该视角下观察场景的位置信息即可完成激光雷达的模拟。那么如何设置相机呢?首先，在使用 OpenGL 的透视投影的方式获取点的数据时，根据 HDL-64E 的水平方位角为 360°，垂直方位角为 26.8°，扫描最长距离为 120 m，考虑使用四个相机拼合的方式实现，其中每个相机上仰角度为 2°，下俯角度为 24.9°，水平张角为 90°，远处裁剪处为  120，然后获取数据。

![image-20211206141555904](https://gitee.com/er-huomeng/img/raw/master/image-20211206141555904.png)

图 4-1 透视投影原理

根据以上的分析，大致可以将激光雷达的仿真分为两个模块，一是激光发射模块，其中包括了对获取到的数据的处理过程(筛选过程);二是建模模块，用于对激光雷达仿真的精度测试和算法验证。

### 4.1 数据处理

由于本文只对于仿真激光雷达提供一个方向，具体的实现方法是多元的，接下来只对其中一种方法在仿真 HDL-64E 时的实现过程作大致说明。由于我们需要取出点的位置信息，而在 shader 关于顶点信息的只有 gl_Vertex  这个内置变量。经过用例检测后，发现 gl_Vertex  的顶点信息是该点相对于当前模型的相对坐标，若想将其变化为我们需要的位置信息还需进行矩阵变换。

根据公式：相对位置 = 相机的模型矩阵 × 模型的模拟矩阵 × 目标点相对模型的相对坐标。

将模型的投影矩阵右乘 gl_Vertex，再右乘传进的相机的投影矩阵，便得出此点相对于相机视点(即激光雷达的位置)的相对坐标。值得注意的是，由于本算法是在 OSG  中运行的，因为 OSG 中矩阵的右乘等于 OpenGL 的左乘，故造成这里的公式和上文提到的公式不同。

### 4.2 数据传输

数据传输的方法有很多种，比如共享内存、以文件形式输出、利用网络传输等，本节只对实现数据传输的其中一种的实现过程加以说明。一般来说，激光雷达仿真需要实现动态的实时场景显示和点云图显示。动态的实时场景显示，可以考虑多加一个相机进行显示。而点云图的绘制可以根据四个相机取到的数据，不以文件形式输出，而是将数据写进内存，直接从内存里获得点数据信息并利用 OpenGL  绘制出来。从内存里直接取数据则需要做到共享内存，也就是要满足进程间的通信，在渲染场景时将数据写在一个内存地址里，绘制点云图时利用这个内存地址找到点数据的存储地址并取出数据，这样的方式可以使得渲染和绘制的效率都提高，要做到动态绘制时也更为方便，但进程间的先后关系需要做一定的控制，否则容易出现绘制时内存地址里没有数据或者是错误数据的情况。

### 4.3 本章小结

经过归纳、分析前文中的内容，最终得出智能车辆车载激光雷达仿真系统的主要技术要求以及针对于主流产品 Velodyne HDL-64E 的一种基本的仿真思路。