- [高精地图（一），自动驾驶的“天眼” ](https://mp.weixin.qq.com/s?__biz=MzI2NDY3OTExNw==&mid=2247484209&idx=1&sn=de70f8ce43a09692c21b755b6e4c027a&chksm=eaa9b893ddde318598f805681341018e2bb527d87ea70a4c64cc87150153d818fa46d9bedbbd&scene=21#wechat_redirect)

## 1 定义

一种精度可达厘米级（传统电子导航地图精度为米级），提供元素更加详细、属性更加丰富、维度更高、更新频率更快的**高精度、高丰富度、高维度、高新鲜度**的电子地图。一种可以辅助实现更可靠的**融合高精定位**功能，提供**超视距环境感知**能力以及提供**车道级别最优路径规划**的电子地图。

单车上的融合感知系统，受限于传感器物理特性以及恶劣气候影响，只能做到可见即可得，无法获得超视距的感知，也就无法实时掌握极具中国特色的道路特点和交通状况。因此，业界除了特斯拉（马斯克曾说：高精地图是一个很糟糕的想法）以外基本达成共识，高精地图是L3以上自动驾驶系统必备武器，堪比二郎神杨戬的天眼。

有一个形象的比喻：装备高精地图的自动驾驶系统仿佛一个当地开了20年出租的老师傅，不仅车技好，脑子里还有一张当地活地图。而没有高精地图的自动驾驶系统，就像是一个初来乍到的外地老师傅，虽车技了得，但对当地大街小巷实际情况一无所知。

## 2 组成

高精地图需要存储和呈现车辆环境数据和交通运行数据，有静态，有动态。如果都放在一张图层，既不利于制作，也不利于使用。因此标准化的分层就显得尤为重要，每一层体现一种环境要素或交通要素，所有图层叠加后形成可用的高精地图。

而各国标准化组织或协会也一直在致力于这方面的工作，有欧洲的4层分层模型（静态、准静态、准动态、动态），有中国提出的7层分层模型（道路层、交通信息层，道路-车道连接层、车道层、地图特征层、动态感知层、决策支持层）。本文不去深究不同模型的差异，仅从利于逻辑理解的角度介绍业界比较认可的分层逻辑。

目前自动驾驶圈内比较公认的高精地图自下而上可以分成两个大图层，静态数据层和动态数据层。

### 1.1 静态数据层

静态数据层自下而上又可细分为**车道模型**、**道路部件**、**道路属性**三个矢量子层，以及一个**道路环境特征**子层。

**车道模型**，用于精确描述车道间拓扑关系，包括车道基准线、车道连接点、车道交通类型、车道功能类型。车道基准线可以体现不同车道间的关联关系，是局部车道级路径规划的基础；车道连接点可以体现不同路段车道间连接关系，是全局车道级路径规划的基础；车道交通类型定义有普通车道、行车道、超车道、辅助车道等类型。车道功能类型定义有公交车道、HOV车道、潮汐车道等类型。

**道路部件**，主要分为路面标线类和道路设施类。路面标线类包括路面横纵向标线、标线类型，标线颜色、标线材质，清晰程度等。道路设施类包括收费站位置、绿化带位置、防护栏位置、涵洞限高、桥梁限重、地标性建筑位置等。

**道路属性**，包含车道类型的属性和路侧呈现设备属性。车道类型属性包含车道数量、类型、坡度、曲率、航向、高程、侧倾等信息；路侧呈现设备属性包含交通信号灯位置、交通标志位置及含义、兴趣点（斑马线）位置及含义等。

**道路环境特征**，用于记录具备独特环境特征的目标图层，比如交通信号灯、交通标志、地标性建筑等。通过采集的激光点云和相机图像数据进行特性提取，并打上特定的标签，从而生成一张道路环境特征图层。用于支持自动驾驶车辆实时感知结果的特征匹配，从而完成车辆实时融合精准定位。

### 1.2 动态数据层

动态数据层基于万物互联的V2X技术，实时获取交通运行数据、交通管理数据及人、车的实时运动数据。因此由下往上可分为**交通运行数据层**、**交通管理数据层**及**高动态运动层**。

**交通运行数据**包含路口红绿灯实时状态，道路拥堵情况、通行区域天气情况、前方可用充电站、停车场的实时状态等。通过V2I/V2N技术，车载终端OBU从路侧基础设施单元RSU或交管部门大数据云平台实时获取。

**交通管理数据**包含由于道路施工、交通事故、交通拥堵而产生的临时交通标志和交通控制数据，车辆一方面可以通过V2I/V2N技术实时获得交通管控数据，一方面通过自身感知设备将遇到的临时交通管控数据上报图商大数据平台，图商基于此进行交通管理数据层的动态更新。

**高动态数据层**主要包含移动物体数据、车辆行驶状态、车辆操作数据。移动物体数据包含行驶路线上物体的位置，包括车辆、行人、三轮车、电瓶车等；车辆行驶状态包括速度、方向等；车辆操作数据包括启动、加速、减速、转弯、换挡、加速等。基于V2V技术，车辆之间可以实时完成高动态数据的交互。

![image-20220210094202324](https://gitee.com/er-huomeng/l-img/raw/master/l-img/image-20220210094202324.png)

## 3 作用

“天眼”的定义及基本组成均已呈现，下面自然而然的轮到高精地图可以解决的痛点及在其中发挥的作用。而冥冥之中早有安排，高精地图在自动驾驶几大模块中均有不俗的降妖表现。

### 3.1 感知

目前自动驾驶传感器的家族越来越壮大，单个的战力也越来越强大，但仍没有一种或几种融合能解决全场景的感知需求。不是受限硬件物理特性影响，就是受限恶劣气候的影响。

（1）在大雪、暴雨、雾霾天气下，视觉及激光雷达基本失效，毫米波雷达倒是可以继续完成移动障碍物的识别、追踪、聚类，但仅凭它不足以撑起L3以上自动驾驶系统的全部功能；

（2）在车道线、斑马线等交通标线磨损，交通指示牌损坏，红绿灯繁杂的路口，单纯的视觉系统，也将很难准确完成识别。

而融合高精度地图的感知系统，可以突破传感器的性能边界，提供全场景，全气候下的超视距感知。通过高精地图，车辆能够提前了解当前位置前方可能的道路情况，动态调整传感器的功能，从而降低对于传感器的性能要求，合理分配计算资源。公开资料总结的高精地图对感知提升主要有三方面。

（1）在交通信号等识别方面，有了高精地图，感知系统只用在当前车道前方有交通信号灯的时候才启用对应的传感器及识别的深度学习算法，这样不仅可以节省计算资源，提高识别的准确率，而且可以提高感知硬件的整体寿命；

（2）在车道线识别方面，高精地图能够提供车道数、车道宽度等丰富的信息，对于车道线磨损、模糊不清等情况，通过重投影补齐车道线，可以提高车道线的识别能力；

（3）在复杂场景感知方面，通过先验信息，提升相应的感知能力。比如即将行驶到高精地图标注的斑马线“兴趣区”时，感知系统将启用斑马线行人检测深度学习模型，提高各类姿态行人的识别率，同时合理的对车辆的行驶状态进行控制。

### 3.2 定位

单一定位源无论从系统可靠性还是功能安全的角度考虑，都无法满足自动驾驶大规模量产落地的要求。而基于多传感器的融合定位是大势所趋，而高精地图似乎成了融合定位实现的最后一块拼图。

GNSS+IMU+RTK受遮挡等影响，无法实现全场景准确定位；基于激光或相机的特征匹配地位，受限于道路上重复的特征及传感器本身的物理特性，也无法实现全场景准确定位。而引入高精地图的融合定位，可以完美解决绝大部分的Corner Case。

首先通过GNSS+IMU+RTK获得绝对定位，并从高精地图中导入此位置的环境特征图层。通过激光或相机扫描识别的特征与高精地图中记录的环境特征进行匹配融合，从而获取车辆在当前场景下更加准确的定位。此融合一来可以获得更加准确的定位，二来在GNSS卫星被遮挡（隧道），IMU航迹推算误差不断累积情况下，通过高精地图环境特征匹配，既可以获得更加可靠的定位结果，又可以实现对其它传感器误差的纠偏。三来在环境特征重复度特别大的场景下（高速公路），通过GNSS+IMU+RTK实时获取当前位置的高精地图，可以避免环境特征的误匹配。

![image-20220210094115542](https://gitee.com/er-huomeng/l-img/raw/master/l-img/image-20220210094115542.png)

### 3.3 预测

高精地图也可以辅助对道路上其他车辆的轨迹预测。例如如果前方某辆车行驶在实线车道内，可以预测该车辆的变道可能性很小；如果前方车辆行驶在最右侧车道，且前方有高速出口，可以预测车辆有可能驶出高速等。

### 3.4 决策规划

对于如下环岛场景，光靠自身感知系统，是没有办法理解其交通规则，作出合理的决策和控制。而对于有特殊交通规则的道路（限时公交专用车道、潮汐车道等），光靠交通标识牌的识别，一来没有办法提前进行路径规划，二来存在错误的交通规则的识别。

高精地图通过赋予自动驾驶系统更丰富的驾驶经验，在合理的全局路径规划及智能化的局部路径规划下，大幅提升单车通行效率，交通运营效率。

### 3.5 仿真训练

高精地图与虚拟仿真技术的结合，通过极大提高场景构建的效率，可以推动自动驾驶仿真的快速落地、普及。基于高精地图的丰富道路元素信息，使用三维建模软件可以实现静态还原交通基础设施与周边环境。同时利用路采数据，在交通参与要素符合逻辑的情况下自动化生成动态场景元素。

## 4 采集方式

我国国土疆域辽阔，城市数量丰富且道路状况极其复杂。如果只靠具有高精地图采集资质图商有限数量的专业采集车，地图制作的数量注定有限，地图更新的频率注定较低（某头部厂商采用专业采集车3个月才能更新一次全国高速公路及城市快速路的高精度地图）。鉴于此，越来越多的图商采用专业采集+众包采集相结合的方式。

专业采集即采用图商造价百万的测绘车辆，上面全副武装的传感器套件，包括高精度组合导航、高线束激光雷达，高像素感知相机。在标定完成、时间同步完成，运动补偿完成之后，就释放它的缰绳，让它驰骋在祖国的大好山河，去记录一切。

众包采集即利用群众的力量，不管你是BBA还是国产四小龙，都给我一起发功。用那10米精度的GNSS，稍显模糊的相机，误报率有点高的毫米波雷达，去穷游祖国。将这些带有定位信息的车辆行驶轨迹、摄像头图像数据，毫米波雷达目标数据通过车端联网设备上传图商云端平台，图商通过AI技术进行处理，提取道路的结构化信息。

专业采集精度高，数量少，因此适合场景地图的初始绘制。众包采集精度低，数量多，因此适合后续地图的高频更新。