- [当物联网遇上边缘计算](https://bbs.huaweicloud.com/blogs/136224)

​        【摘要】 针对设备直联云端方案的痛点，将边缘计算概念引入物联网解决方案的IoT边缘服务应运而生。本文将会为您介绍IoT边缘的能力与价值。    

边缘，指实体或逻辑概念中离中心较远，靠近边界的部分。在数据处理领域，边缘计算的概念源于云计算，是指在靠近数据源的一侧搭建集网络、计算、存储、应用核心能力为一体的计算节点，就近提供处理数据的能力，而不是将全部数据都交由云端处理。可能有人会提出疑问，云计算的目的不就是为了数据集中到云端进行处理么，为什么现在又要分工到边缘了？为了解决这个疑问，让我们以物联网场景为例，假设以下场景：

- 有家企业想要把自己旗下的一个产业园区建设成智慧园区，将园区中的各种设备（包含视频监控设备、门禁设备、消防设备和水电设备等等）全都接入物联网平台统一管理。但当负责人开始研究各类设备分别如何接入时，发现设备种类实在太多了，而且这些设备全都按照自己独有的行业协议上报数据；相对的，物联网平台支持的通信协议有限，所以，他要把这些五花八门的行业协议统一转换为物联网平台支持的协议，工作量很大。
- 同样是上面的那个企业，负责人在研究门禁系统如何接入了发现另一个问题：门禁系统中的员工数据属于企业隐私数据，将这部分数据传输至云端不符合公司安全策略。但如果只有门禁系统不接入云端，维护成本高，也不利于系统之间的联动。
- 在管理园区的这家企业苦恼的同时，园区内有家车企也遇到了一个难题。这家企业生产基于物联网的自动驾驶汽车，车辆通过车载系统和物联网平台交互获取自动驾驶的指示。控制系统的开发很顺利，但有一个问题无论如何都解决不了：路上的网络信号太不稳定了，若到了信号差的地方或者遇到塞车，数据传到云端再等到命令下发下来，可能会有着几秒的时延，而在复杂的路况下，这几秒的时延是致命的。

上述的问题都是设备直联云端方案的痛点，而通过在物联网解决方案中引入边缘的计算的概念，我们就可以解决这些问题。

### 物联网边缘计算能做什么？

边缘计算是一个概念，讨论它能做什么时，需要给他赋予一个实体。本文中，我们以华为物联网平台推出的边缘计算服务“IoT边缘”为例。IoT边缘通过在靠近物或数据源头的边缘侧，部署融合网络、计算、存储、应用核心能力的边缘节点，就近提供计算和智能服务，满足行业在实时业务、应用智能、安全与隐私保护等方面的基本需求。接下来让我们从三个角度来介绍IoT边缘服务的核心能力。

---开放生态---

边缘节点作为物联网的“小脑”，是一个拥有独立接入和计算能力的服务器，我们一般根据其外形称之为边缘盒子。IoT边缘服务并不强制配套边缘盒子，仅对边缘盒子的硬件规格有一些基本要求，只要是满足要求的硬件，无论型号，均可基于Docker容器方式部署边缘服务软件包，获取边缘侧的设备接入、设备联动和低时延本地闭环管理等基本能力。

![1575355529453618.png](https://bbs-img.huaweicloud.com/blogs/img/1575355529453618.png)

接入方面，IoT边缘服务支持用户自行开发第三方接入协议驱动，通过云端下发至边缘节点运行，实现工业网关行业协议接入。同时，IoT边缘服务还支持用户开发并部署第三方边缘容器应用，拓展边缘节点的能力。通过在硬件、协议、应用等方面都高度开放，IoT边缘服务可以满足各种定制需求，应用于多种物联网场景。

---边云协同---

边缘节点虽拥有独立计算能力，但“小脑”真正的价值，还是需要与“大脑”合作才能发挥，边云协同能力才是IoT边缘服务真正的杀手锏。IoT边缘服务在云端提供图形化的操作界面，支持纳管边缘节点，进行统一应用部署、节点运维和业务管理，大幅降低边缘节点部署与运维的复杂度。

![1575355564307814.png](https://bbs-img.huaweicloud.com/blogs/img/1575355564307814.png)

边缘节点纳管后，即可通过与云端分工合作，实现业务分层处理：例如，在车联网场景中，要求及时处理的业务，如自动驾驶、车路协同等，由边缘节点直接进行计算并返回结果；对时延不敏感、数据量大的业务，如大屏监控、大数据分析等，则交由云端处理。再例如，在园区场景中，涉及用户隐私的数据，在节点本地自闭环处理，所有数据采集、处理及存储在本地节点闭环；非隐私数据予以清洗汇总后，上传至云端进行机器学习及训练，持续优化及更新本地智能算法。通过业务分层处理，将物联网的价值最大化，实现真正的万物互联。

边云协同的能力虽然强大，但边和云之间通过网络连接，若网络出现问题，导致边与云断连，这种情况该如何保障边缘业务？IoT边缘服务提供了边缘节点本地自治能力，网络异常时，云端已下发的规则和AI模型依然可正常运行，确保业务连续性；当网络恢复时，数据再同步到云端。同时，边缘节点还提供本地控制台，无需联网即可登陆，实现边缘节点管理自治。

---边缘智能---

相信眼尖的同学已经注意到了，前文中我们提到了数据清洗、边缘规则和边缘AI，这正是我们接下来要讲的边缘智能能力。

数据清洗是指边缘侧对设备上报的数据进行过滤、去重、聚合等处理后上报云端，针对希望选择性上报数据至云端，降低上云带宽、云端存储计算要求的使用场景。

![1575355580356223.png](https://bbs-img.huaweicloud.com/blogs/img/1575355580356223.png)

具体来说，过滤是指用户指定过滤条件，例如属性A大于10，满足该条件的数据均会被过滤；用户可以同时指定多个条件，条件之间可以是“与”关系（满足全部条件的数据才会被过滤），也可以是“或”关系（满足任一条件就会被过滤）。去重是指当设备连续上报属性值重复的消息时，边缘节点仅会向云端上报第一条。聚合则是指用户可以指定一个时间窗（如一个小时），边缘节点会将这个时间窗内每个设备上报的数据聚合成一条数据上报，并且用户可指定数据中每个属性的聚合方法，例如取最大/最小值，求和，取平均值等。这三种清洗规则的优先级是过滤 > 去重 > 聚合，也就是用户同时设置了这三种清洗规则时，数据会先被过滤，再进行去重，最后聚合后上报。

边缘规则，就是指边缘侧的规则引擎。物联网平台支持将云端创建的设备联动规则下发至边缘侧执行，实现简单业务边缘快速闭环。关于规则引擎和设备联动规则，我们[上一篇博文](https://bbs.huaweicloud.com/blogs/134889)有详细介绍，感兴趣的同学可以去看下。

除了上述两种基于简单逻辑的边缘智能外，IoT边缘服务还支持与华为云企业智能（EI）联动实现边缘侧人工智能。通过边缘侧上报的数据，EI侧对AI进行训练，并将训练完成的AI模型下发至边缘侧执行，典型应用包括人脸识别、车辆识别等视觉系AI模型，实现边缘侧的高度智能化。

### 物联网边缘计算能解决哪些问题？

介绍完IoT边缘的功能后，相信各位已经想到了文章开头的那些问题要怎么解决了吧。其实，问题中的那两个场景（智慧园区和智慧城市）正是物联网边缘计算的主要应用场景。接下来，让我们再一起看下在这两个场景中边缘计算都能解决哪些问题，带来哪些价值。

首先来看下智慧园区场景。![spacer.gif](https://bbs.huaweicloud.com/static/ueditor/themes/default/images/spacer.gif)

![1575355665554909.png](https://bbs-img.huaweicloud.com/blogs/img/1575355665554909.png)

- 园区里门禁、消防、监控等系统由不同的供应商提供，全部都采用了自己的行业协议，整个园区需要接入物联网平台的设备和子系统协议多达十几种，但物联网平台支持的设备接入协议就那几种，要怎么办？通过自建网关适配协议是一个可行的方案，但集成难度依然很高。但如果采用IoT边缘，边缘软件原生+第三方驱动形式可支持的协议类型可多达30+种，且第三方驱动开发简单，可以大幅减低集成难度。
- 各个子系统各司其职，在自己的职责范围内快速响应，但是，一旦遇到了需要多系统联动的时态，由于中间环节的缺失，往往响应速度不够快，造成事件处理效率低下。IoT边缘通过集成各个子系统，在边缘层上实现消防、门禁等业务跨系统联动，大幅提高事件处理效率。
- 设备直接上报数据量过大且涉及用户隐私，不能直接报给物联网平台，需要先在本地处理。若全部由设备自行处理，逻辑复杂且成本高，因此IoT边缘提供的数据清洗能力就成了一个很好的选择，数据经过过滤、去重和聚合后，不仅大大减少了上报数据量，还能保护用户隐私。
- 面部识别等视觉性AI的模型需要大量的数据进行训练，一般都会放在云端，但因为云端离设备较远，带宽需求和时延问题怎么都无法避免。但如果把云端训练好的模型下放到靠近设备的边缘侧，问题便迎刃而解，满足秒级时延体验，降低云边带宽需求。
- 物联网设备依赖云端进行业务管理，但若因为网络故障导致云端失联，如何保证业务连续性？IoT边缘本地会保存已下发的规则和AI模型等，即使与云端断连也可独立运行，确保业务连续性。

然后是智慧交通场景。

![1575355682381556.png](https://bbs-img.huaweicloud.com/blogs/img/1575355682381556.png)

- 在城市交通中，单个车辆能获取的路况信息只是很小一部分，想要做出最合适的判断，还需要结合监控视频、雷达数据、天气情况等信息，再通过智能化算法计算才能得出结果。但路况瞬息万变，若把这部分计算交由云端，对网速的要求调高。IoT边缘服务支持将训练好的AI模型下发到边缘侧，实现实时路况计算，及时提供减速信息、碰撞告警等信息。
- 车路协同场景中，监控视频、雷达数据、车辆信息等数据均采用自己的行业协议进行传输，集成难度大。IoT边缘支持多种行业协议，快速集成，数据融合。
- 智能交通除了需要关注局部，确保交通安全外，还需要放眼全局，提升整体交通效率。IoT边缘可将交通数据清洗后，将有价值的数据上报云端，云端根据全局数据进行分析，为交通指挥者提供有效建议，提升道路通行效率，促进节能减排和便捷监管，支持向端云协同自动驾驶演进。

当物联网遇上边缘计算，很多传统直联方案的问题迎刃而解，物联网有了边，真正成为了一张大网，覆盖了越来越多的领域，为人们带来越来越智能的生活。