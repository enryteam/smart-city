# 龙岩市物联网应用平台建设方案

物联网应用基础服务平台具体包括以下建设内容：

（1）建设物联网应用基础服务平台(M2M平台 ) ，实现软件系统开发与部署。

（2）实现行业终端的适配接入，对采集到的数据实现报警、转发、存数据库等操作。

（3）提供开放的平台和数据结构，为各物联网应用的扩展提供数据。

（4）提供详尽的历史记录，及灵活的报表定制工具，易于生成任意格式的报表。

（5）提供易于扩展的、分布式平台框架及冗余运行模式，支持大规模、大数据量的应用。

（6）提供强大的服务支持能力及通用的 M2M业务生成框架，为物联网应用开发提供可视化的集成开发工具，提高二次开发效率。

（7）提供强大的用户及权限管理，保证系统运行的安全性。

（8）实现对现有部分行业终端的接入调试、数据处理及监控管理。

# 总体技术要求

许多物联网应用业务是垂直管理的，不同业务、不同行业应用、行业用户是单独构件自己的业务。这种垂直的应用网络存在开发、部署、维护成本高，应用融合困难，行业应用自成体系，各终端设备厂家提供的接口不同，不能真正形成规模化、产业化，也不能完全体现物联网的价值。

针对物联网应用垂直管理的种种弊端，龙岩市要求通过建设 M2M平台，实现对物联网应用提供核心支撑平台和提供终端远程管理、运行监控、告警管理、协议适配、业务数据传输、行业应用接入等综合服务功能。

# M2M 平台定位要求

M2M平台提供物联网各行业应用对接入层、通讯层以及行业应用基础层的通用解决方案，基于 M2M平台各行业应用实现自己的业务逻辑处理。

## 1、提供统一的终端接入平台

通过 M2M平台，为所有物联网应用终端提供的统一的数据接入方案。 

数据接入支持多种通讯设备、通讯协议，对接收到的数据进行辨识、分发，以及报警分析等预处理。

## 2、提供统一的应用基础运行平台

物联网应用软件与传统的应用软件相比，有底层终端数量多、上层行业应用复杂的特点，各种行业终端数量规模往往能达到百万甚至更高级别，要求 M2M平台能维护大量共享数据和控制数据，提供物联网应用的统一运行环境，从概念、技术、方法与机制等多个方面无缝集成数据的实时处理与历史记录，实现数据的高时效调度与处理，并保证数据的一致性。

## 3、提供统一的安全认证

以用户信息、系统权限为核心，集成各业务系统的认证信息，提供一个高度集成且统一的认证平台。

## 4、提供统一的数据交换平台

M2M平台提供统一的“数据交换平台”，通过中间件作为粘合剂连接各种业务相关的异构系统、应用以及数据源，满足重要系统之间无缝共享和交换数据的需要。

## 5、提供统一的门户支撑平台

提供一个灵活、规范的信息组织管理平台和全网范围的网络协作环境，实现集成的信息采集、内容管理、信息搜索，能够直接组织各类共享信息和内部业务基础信息，面向不同使用对象，通过门户技术实现个性化服务，实现信息整合应用。

## 6、提供多种业务基础构件

为各行业应用业务提供开发辅助工具、快速定制、地理信息服务、权限管理、数据展现及挖掘等多种平台支撑服务。通过这些基础构件，实现系统的松散耦合，提高系统的灵活性和可扩展性，保障快速开发、降低运营维护成本。

# M2M 平台功能结构

## 1、数据通讯模块

包括数据采集、数据处理、终端控制等功能。所有的终端设备发到平台的数据都由数据通讯模块接收并预处理，是平台与终端设备交互的桥梁。

数据通讯模块支持各种终端设备的通讯协议及动态配置加载、卸载终端设备到系统。

## 2、报警处理模块

报警主要分成两种情况：一种是终端设备直接发上来的报警事件， 另一种是根据用户需要配置到系统中的报警规则产生的报警， 报警规则是根据需求预先设定好的。 

当终端传上来的实时数据触发报警规则时， 应该实时产生报警，并在用户界面给予显示， 报警的延时时间应小于 5 秒。

## 3、策略联动

当系统产生了报警或其他事件时，可以在此模块中设置需要控制联动的设备或人员。不同的设备通过 M2M平台粘合，形成一个有机的整体，提供自动、及时、准确的服务。

## 4、脚本服务

实现动态灵活的设置系统操作或向终端设备发送控制指令。脚本语法需至少支持JavaScript 语法。在脚本中还应该提供各种系统变量，以满足各种脚本需求。

## 5、日程管理

日程管理为系统提供各种有规律的定时操作，提高系统的自动化管理水平。

## 6、数据备份

数据定时压缩备份降低硬盘的使用容量，并可在需要时对备份的数据进行无损还原。

## 7、双机备份

提供双机热备功能，当主站系统出现问题时，从站系统可以接管工作，最大程度保证平台的稳定运行。

## 8、权限管理

对系统的权限资源、用户、角色、角色组进行管理，除了系统管理员外不同的区域有自己的管理员，可以对所在区域以及下属区域进行权限、用户和角色的划分。

## 9、日志管理

具有完善的日志功能，包括操作日志、系统运行日志，能够记录系统异常情况及其他安全事件。

## 10、报表功能

支持两种类别平台报表：一种是专门针对各业务的单独的报表系统， 只能由业务的所属合作伙伴或管理员查询， 关注的是本业务的运营情况； 另一种是把所有业务统一抽取的平台运营分析报表，此种报表对平台所有业务进行运营分析， 可以使管理者对平台的运营状况有总体的认识和了解，为决策提供数据依据。

# 数据通讯模块

所有的终端设备发到平台的数据都由数据通讯模块接收并预处理，数据通讯模块完成实时数据采集、数据处理、终端控制等业务目标，实现数据接入适配、统一数据结构、数据处理等功能。

# 报警处理模块

报警处理模块实现对测量值的范围、变化速度的预警，包括限值报警、变化率报警、偏差报警、异常报警等，以及通过对测量值进行数学运算 ( 报警公式 ) ，然后对运算结果进行报警检查而产生。

支持自动记录报警信息、报警确认信息、报警恢复 ( 报警消除 ) 等信息，按照重要程度可分为多个优先级，如低级、高级、紧急。

报警发生时系统可以通过弹出报警窗口、发出声响、发送短信、电子邮件或打印报警信息等多种方式通知用户，用户可以自由设定报警通知方式。

报警处理模块支持在终端设备侧直接产生的、通过网络上报的报警，并根据用户预设的联动策略方式进行相应操作。

支持报警确认和复位，用不同颜色标示报警状态，包括：

- 未确认、未复位；

- 已确认、未复位的报警；

- 未确认、已复位的报警；

- 已确认、已复位的报警。

用户可通过 B/S 或 C/S 两种客户端根据预定权限设置进行报警信息的查询、操作、跟踪。 

M2M平台会记录所有报警信息，以备用户查询、生成报表。

# 联动策略模块

联动策略模块支持的主要功能要求包括

（1）可配置策略模块启动时要执行的脚本；

（2）可配置可循环执行的脚本，循环时间可以设定；

（3）可配置策略模块停止时要执行的脚本；

（4）可配置日程表设置的日程所要执行的脚本；

（5）可配置当产生报警事件时要执行的脚本；

（6）可配置某项的值改变时所要执行的脚本。当脚本设置的监控项发生改变时，系统自动刷新。

联动策略模块至少支撑以下策略模式：

（1）启动执行：当策略模块启动的时候执行，仅一次。

（2）循环执行：按设定的时间间隔执行。

（3）退出执行：当策略模块退出的时候执行，仅一次。

（4）周期执行：当日程表被触发时执行。

（5）事件执行：当产生报警事件时执行。

（6）值改变执行：根据脚本中包含的项ID，判断当该项的值发生改变时执行。

# 平台接口设计

## 1、与行业终端的接口

M2M平台与行业终端接口应尽量统一，有助于标准体系的形成。如果已有标准的行业，应支持现有标准。

支持的行业终端应包括：城管通终端、环保监控终端等。

支持的协议应包括：工业控制领域中的 OPC、MODBUS、RS232/485 协议，环境保护行业国标 HJ/T212-2005 ，中国移动 M2M终端 WMMP协议等。

M2M平台应实现统一管理终端，实现终端登录会话，实现终端的数据认证与加密。

行业应用平台可通过 M2M平台对终端进行管理与反控，下发指令并反馈执行结果。

## 2、与行业应用的接口

M2M平台作为各物联网行业应用的基础服务平台，应具有完备的接口与各应用交换数据，卖方应提供规范化的接口规范，实现 M2M平台的对外数据交互标准、通用接口，接口形式包括 ESB、RMI接口、 WebService 接口、数据库接口等。

## 3、与其他系统的接口

M2M平台预留与其他系统的信息接口，如上报本系统终端告警数据、行业统计数据等，接口形式包括 ESB、RMI 接口、 WebService 接口、数据库接口等。

# 视频监控业务集成

要求集成视频监控业务和提供视频监控系统接口，遵循有关视频接口规范实现对监控摄像头的控制和视频查看。功能包括摄像头列表、编号，摄像头上 

/ 下/ 左/ 右移动、拉近、拉远，设置摄像头方向、焦点，视频播放、暂停、录制，图象抓拍等。

# GIS 平台集成

要求构建 GIS 平台，实现 GIS 数据装载， M2M集成 GIS 平台，并通过 M2M平台对外提供 GIS 服务。

通过 ESRIArcGISServer 、ArcIMSServer 建立 GIS 平台，需满足以下要求：

（1）空间数据组织与管理：目前，基于关系数据库和对象关系数据库的空间数据库技术是大型 GIS 应用项目中广泛采用的空间数据管理技术。 

M2M平台中空间数据包括基础地理数据与应急专业数据，涉及多部门、多系统的数据融合和共享，其特点为多源、多尺度、异构、海量。因此，GIS 平台要具有大数据量管理能力，而且要支持存储拓扑关系和丰富的几何对象类型。

（2）地图编辑：地图编辑功能是多数GIS 应用必需的功能，组件对象模型强大的地图编辑功能可以省却大量二次开发的精力。

（3）数据格式转换：对应用系统来讲， GIS 软件数据交换能力决定了该系统的开放性，即能否方便地输入其他来源的数据以及输出相应的数据格式， 与其他系统进行数据交换的能力。

（4）多源数据集成：多源数据集成，即无需格式转换直接访问多种数据格式的能力，这是 GIS 应用系统开放能力的另一种体现。

（5）二次开发：组件式开发方式已经成为当前主流 GIS 应用二次开发方式，比较GIS 平台的组件开发能力与灵活性在 GIS 软件选型中至关重要。

（6）跨平台：出于稳定和安全的数据服务和网络发布服务的考虑，各子系统需要采用多种操作系统组成跨平台的网络操作系统。而 GIS 的跨平台性就显得尤为重要。

GIS 平台包括 WebGIS和 GISServer 。GISServer做为服务端，提供地理信息服务，包括了地图服务、要素服务、路径搜索服务、缓冲查询、专题图服务等； GISServer 通过 REST接口的形式，供各种编程语言( 包括 FLEX、C++、Java、VB等) 实现客户程序调用； WebGIS包含在 M2M平台中，用来和 GISServer 通

信，提供地理信息相关的功能，包括地图展现、地图搜索、专题图展示等，实现 M2M平台的不同功能模块对 WebGIS进行定制，提供相对应的功能。

装载龙岩市中心城区地形图和基础数据普查与测绘数据采集建库成果。

采用松耦合方式集成GIS 业务，通过 SOA技术实现 GIS 平台业务集成，并对外提供GIS 服务。