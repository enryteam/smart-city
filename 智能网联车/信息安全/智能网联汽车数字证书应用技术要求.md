# 智能网联汽车数字证书应用技术要求

# 一、智能网联汽车数字证书应用技术研究

## 1.1 智能网联汽车通信场景简介

智能网联汽车（简称 ICV）是指搭载先进的车载传感器、控制器、执行器等装置，融合现代通信与网络技术，实现车与 X（车、路、人、云等）的智能信息交换与共享，具备复杂环境感知、智能决策、协同控制等功能，可实现“安全、高效、舒适、节能”行驶，并最终可实现无人驾驶。 

如图 1 所示，智能网联汽车通信涵盖了车-云通信、车-车通信、车-路通信、车-人通信及车内通信。

![image-20211029104439049](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104439049.png)

车-云通信指车辆的车载设备通过网络与云平台连接，实现云平台与车辆之间的数据交互。车云通信主要应用于车辆导航、车辆远程监控、紧急救援、信息娱乐服务等。另外，汽车软件远程升级是典型的运用车云通信的新型业务，汽车软件升级包由企业云服务平台进行下发，车端在接收与识别到正确的软件升级包后进行软件包的更新。 

车-车通信指车辆间通过车载终端进行的实时通信。最普遍的应用场景是在城市街道与高速公路中，车辆之间相互通信，实现信息和数据的共享。智能汽车计算平台可以通过发送或接收车辆的时速、相对位置、刹车、直行还是左拐等所有与行驶安全相关的数据，甚至包括拍摄周围事物的图片或者音视频等，分析和预判其他车辆的驾驶行为，从而实现主动的安全策略，提升行驶安全，为半自动驾驶、自动驾驶提供数据支撑。此外，车辆也可通过转发自身及前方的实时信息来预防事故的发生，实现改善交通环境、减少交通拥堵的目的。 

车-路通信指车载设备与路边基础设施（红绿灯、交通摄像头、路侧单元等）进行通信，路边基础设施获取附近区域环境的信息并发布各种实时信息。车-路通信应用主要包括交叉路口安全管理、车辆限速控制、电子收费、运输安全管理以及道路施工和限高警示等。智能汽车计算平台通过强大的 CPU 处理接收的信息，结合 GPU 处理通过摄像头识别的图像以及辅助高精地图和云端支持，建立协同式环境感知系统，便于整个智慧城市的搭建。 

车-人通信指车辆中的车载设备和弱势交通群体（包括行人、骑行者等）使用用户设备（如智能手机、可穿戴式设备、自行车 GNSS 信号仪等）进行通信。车与人通信主要应用于交通安全、智能钥匙、位置信息服务、汽车共享等。智能汽车计算平台基于安全通信，通过智能钥匙，实现无钥匙进入和远程启动等功能，同时还要通过强大的计算能力，实时推算行人或者骑行者的行动轨迹，为驾驶员提供驾驶预判，避免发生交通事故。 

车内通信是以车载终端、车内的传感器及电子控制装置为通信主体进行通信而形成车内通信网络，主要涉及 CAN/CANFD、FlexRay、车载以太网等通信协议。以汽车软件远程升级技术为例，车端的网关或 T-Box 在接收到软件升级包后通过车载以太网或 CAN 总线将升级包发送给对应的 ECU，同时还需要将升级进度等信息发送给 HMI 设备，向用户展示升级情况。

## 1.3 数字证书在智能网联汽车的应用现状

从以上对智能网联汽车通信过程中面临的安全威胁及防护措施来看，数字证书可以有效解决智能网联汽车通信过程中的身份认证、消息安全传输、代码安全等安全需求。按照数字证书体系架构，数字证书主要分为 X509 数字证书体系和 V2X 数字证书体系。两种证书体系构建标准不同，签发出来的数字证书无论从编码上还是格式上也都有明显差异，以下分别是两种证书的体系架构图。

![image-20211029104642869](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104642869.png)

![image-20211029104658179](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104658179.png)

X509 证书主要由 X509 CA 签发管理，X509 CA 通常包括证书签发系统、证书注册系统、 密钥管理系统、目录服务器系统以及在线证书状态查询系统。证书的格式遵循 ITUT X.509 国际标准，证书编码是 DER 格式。证书包含一个公开密钥、名称以及证书授权中心的数字签名，一般情况下证书中还包括密钥的有效时间、发证机关的名称、证书的序列号等信息。 

广泛应用于互联网上的电子商务活动和电子政务活动，近些年也多用于车联网的车云通信。 

目前大部分车企已经或正在建设的数字证书体系以 X509CA 为主，面向企业内车辆、TSP 云平台服务器及平台系统管理员、车主 APP 等颁发 X509 证书，提供身份认证服务和证书应用支撑。

V2X 证书主要由 V2X CA 签发管理，V2X CA 架构体系和证书的格式主要参照 T/CCSA307-2021《基于 LTE 的车联网无线通信技术 安全证书管理系统技术要求》，证书编码是 OER格式。与 X509 证书相比，V2X 证书中不包含证书 DN、证书自定义扩展项，但可针对证书应用的权限范围、地理范围等进行设置。V2X 证书是为适应车路协同 V2X 通信构建签发的一套数字证书，为车车、车路、车人直连通信提供高效率、低时延的安全认证，实现 V2X 通信中的身份认证、安全传输、数据完整性、有效性等安全特性，为智能网联汽车应用发展建立一个安全的网络运行环境。目前 V2X 数字证书体系和数字证书应用处于起步建设和试验测试阶段，尚未进入大规模商用。 

以下将分别就数字证书在车联网各通信场景下的应用情况进行梳理分析。

### 1.3.1 数字证书在车云通信中的应用

数字证书在车云通信场景中主要用于实现车辆终端与云端业务系统在通信过程中双方的身份认证以及保证通信数据的安全传输，具体业务场景包括：车云数据交互、车端信息回传、服务端订阅内容推送、车端软件远程升级、车端故障远程诊断等。从目前的应用情况来看，车云通信过程中多以 X509 数字证书应用为主。 

图 4 是基于 X509 数字证书的车云通信场景示例图，智能网联汽车和云平台分别向认证中心申请数字证书，智能网联汽车和云端的安全接入网关基于数字证书验证双方身份，确认双方身份合法性之后之后建立通信。针对敏感数据的传输，可采用安全通道的方式进行传输，或者使用对方证书公钥对数据安全加密后再进行传输，接收方收到密文消息后先使用己方私钥行解密再做相应处理。

![](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104752347.png)

图 5 是 X509 数字证书在汽车软件远程升级过程中的应用，软件提供商、OTA 平台和智能网联汽车分别向认证中心申请数字证书，用于软件升级过程中的身份认证、安全传输等。 

软件供应商在提供升级包给 OTA 平台时，OTA 平台首先利用软件供应商的数字证书验证供应商身份的合法性，确认其身份合法后调用 PKI 服务对新版软件包进行数字签名，并将签名值和 OTA 平台自身的公钥证书保存到软件升级包中。车端的网关或 TBOX 在成功下载接收到升级包后，首先对软件包中的 OTA 平台证书合法性进行验证，然后对升级包进行验签，明确升级包来源的正确性以及升级包的完整性后，再执行升级包的刷写。

![image-20211029104827700](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104827700.png)

### 1.3.2 数字证书在车车通信中的应用

为了满足 V2X 通信对低时延、高运算效率的需求，车车通信场景下对车端的数字证书编码格式、数字证书体量、基于数字证书的签名验签效率等都提出了更高要求。由于注册证书需要绑定车辆身份信息，相对较大，无法满足 V2X 低时延的需求，因此车车通信目前主要基于信息较少的假名证书实现车辆之间的身份验证。 

以下以 V2X 假名证书应用为例，对车车通信场景下的数字证书应用进行分析说明。针对车辆行驶状态信息，需要使用假名 CA 签发给 OBU 的假名证书提供数字签名的保护，假名证书利用密码技术隐藏 OBU 或车辆的身份信息，以保护用户的隐私。发送方的 OBU 首先随机选用一张假名证书，并使用与假名证书对应的私钥对包含有其行驶状态信息的消息进行数字签名，再将该签名消息连同证书一起广播出去。周围接收到该消息的车辆首先验证消息中的签名证书是否有效，再利用通过验证的证书中的公钥验证签名消息中的签名是否正确，然后接收车辆利用通过验证的签名消息中的内容确定消息发送车辆的行驶状态。

![image-20211029104906888](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104906888.png)

### 1.3.3 数字证书在车路通信中的应用

基于 V2X 技术的车路通信指行驶车辆与道路侧的智能通信设备进行信息通信，以完成车端数据同步上传以及路侧端数据的广播下发及通知播报等业务。以下分别针对车路通信的四个典型场景的数字证书应用进行说明。 

#### （1）车辆接收路侧设备的广播消息 

车辆在行驶过程中，需要实时接收周围道路基础设施路侧设备 RSU 所广播的消息，道路设施管理机构需先向道路设施管理机构申请并下载应用证书，并利用应用证书对应的私钥对其播发的消息进行数字签名，并将其广播出去，该广播消息中还包含有应用证书。周围的车辆的车载 OBU 接收到该消息后，车载 OBU 首先验证该广播消息中的路侧设备 RSU 应用证书有效性，如果通过验证，继续利用该 RSU 证书中的公钥验证签名消息中的数字签名，若通过验证，则可以使用该广播消息携带的内容。

![image-20211029104942011](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029104942011.png)

#### （2）特种车辆配置管理路侧设备 

特种车辆（例如警车）需要控制一些道路基础设施的状态（例如交通信号灯）。道路基础设施 RSU 向道路设施管理机构申请应用证书，特种车辆车载 OBU 向道路设施管理机构申请身份证书。特种车辆上的车载 OBU 首先生成控制 RSU 状态的控制指令，并利用其身份证书对应的私钥对该控制指令进行数字签名，然后利用 RSU 的应用证书中的公钥对签名消息进行加密，生成签名加密消息，将签名加密消息和 OBU 身份证书广播出去。RSU 接收到该签名加密消息，首先利用与其公钥证书对应的私钥对消息进行解密，然后验证 OBU 的公钥证书，进而验证消息签名，最终获得控制指令，并执行该控制指令。

![image-20211029105006850](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029105006850.png)

#### （3）车辆 ETC 缴费 

车辆在道路收费口需向道路管理部门结算并缴纳道路使用费用。路侧 RSU 和车辆的车载 OBU 分别向道路收费管理机构申请应用证书和用于道路缴费的身份证书。在道路收费入口，车载 OBU 获得入口处 RSU 的应用证书并使用其身份证书对应的私钥和入口 RSU 应用证书生成签名加密消息，并发送给入口 RSU，入口 RSU 解密并验证 OBU 的签名加密消息，确定 OBU 的起始位置。在道路收费出口，车载 OBU 获得出口 RSU 的应用证书，并使用其身份证书和出口 RSU 应用证书生成签名加密消息，并发送给出口 RSU。出口 RSU 解密并验证 OBU的签名加密消息，确定 OBU 的结束位置。应用根据 OBU 的起始位置和结束位置，结合道路收费标准进行费用计算。

![image-20211029105032753](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029105032753.png)

（4）电动汽车接入充电桩充电 

目前电动汽车接入充电桩充电时，可以采用带外的方式进行通信，双方需互相验证对方的合法性。在车辆与充电桩连接后，充电桩首先验证电动汽车的身份证书是否在黑名单中， 如果不在黑名单中则进行身份认证，车辆对充电桩产生的随机数进行签名，充电桩对签名数据进行验证，验证通过后充电桩对电动汽车产生的随机数进行签名，电动汽车对签名数据进行验证，验证通过则完成充电桩和电动汽车的双向身份认证，这就保证了电动汽车与充电桩双方的合法受信身份，如果认证不通过则进行报警提示。下图是电动汽车接入充电桩充电时双方身份认证示意图。 

![image-20211029105104674](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029105104674.png)

### 1.3.4 数字证书在车内通信的安全应用

目前智能网联汽车内部对数字证书的应用主要体现在以下方面，一是用于车内网中各关联节点之间在通信过程中的身份认证，车内通信节点向 CA 认证中心申请身份证书，并利用证书对应的私钥签名、公钥验签技术实现对通信服务节点的合法性、真实性的确认，保证节点间传输的数据、信息、指令的真实性、完整性、不可篡改性。另外，诊断仪通过接入 OBD接口实现对车内异常的诊断之前，OBD 接口与诊断仪分别向 CA 中心申请数字证书，在接入过程中完成双向身份认证，确保被授权的诊断仪才可访问车辆 OBD 接口。最后，车辆利用数字证书对应的私钥对 ECU 安全启动的固件或操作系统及应用软件进行代码签名保护，确保加载的软件未经篡改。以下是针对三种车内数字证书应用场景的示意图。

![image-20211029105141723](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029105141723.png)

### 1.3.5 数字证书在车人通信中的应用

数字证书在车人通信中的典型应用场景是远程控车。远程控车依托于用户移动设备APP，完成对关联车辆的远程开启、关闭、查看、钥匙分享等业务，移动设备 APP 发出的控车指令经由智能网联汽车服务平台转发到智能网联汽车终端，保证发送控车指令的移动设备APP 的合法性和车辆收到的控车指令的完整性和保密性，是实现远程控车业务安全的关键所在。用户移动设备 APP、智能网联汽车服务平台和智能网联汽车均需向智能网联汽车认证中心申请数字证书，控车指令在用户移动设备 APP 发起端进行签名加密后发往服务平台，服务平台对收到的签名加密指令进行解密验签，验签通过后，再使用服务平台的数字证书对应的私钥和车辆的公钥证书，实现对控车指令的签名加密，并通过公共网络发放车辆终端，车辆终端针对收到的控车指令数据包分别进行解密和验签，确保控车指令的合法性和完整性。

![image-20211029105218498](https://gitee.com/er-huomeng/l-img/raw/master/image-20211029105218498.png)