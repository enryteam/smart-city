# 一、前向碰撞预警

前向碰撞预警（FCW: Forward Collision Warning）是指，主车（HV）在车道上行驶，与在正前方同一车道的远车（RV）存在追尾碰撞危险时，FCW 应用将对 HV 驾驶员进行预警。**本应用适用于普通道路或高速公路等车辆追尾碰撞危险的预警。**

FCW 应用辅助驾驶员避免或减轻前向碰撞，提高道路行驶安全。

FCW 包括如下主要场景： 

![image-20211027101432737](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101432737.png)

## a）HV 行驶，RV 在 HV 同一车道正前方停止： 

1）HV 正常行驶，RV 在位于 HV 同一车道的正前方停止； 

2）HV 和 RV 需具备短程无线通信能力； 

3）HV 行驶过程中在即将与 RV 发生碰撞时，FCW 应用对 HV 驾驶员发出预警，提醒驾驶员与位于正前方的车辆 RV 存在碰撞危险； 

4）预警时机需确保 HV 驾驶员收到预警后，能有足够时间采取措施，避免与 RV 发生追尾碰撞。

## b）HV 行驶，RV 在 HV 相邻车道前方停止： 

![image-20211027101449672](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101449672.png)

1）HV 正常行驶，RV 在位于 HV 相邻车道的前方停止； 

2）HV 和 RV 需具备短程无线通信能力； 

3）HV 行驶过程中不会与 RV 发生碰撞，HV 驾驶员不会收到 FCW 预警信息。

## c）HV 行驶，RV 在 HV 同一车道正前方慢速或减速行驶： 

![image-20211027101457290](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101457290.png)

1）HV 正常行驶，RV 位于 HV 同一车道的正前方慢速或减速行驶； 

2）HV 和 RV 需具备短程无线通信能力； 

3）HV 行驶过程中在即将与 RV 发生碰撞时，FCW 应用对 HV 驾驶员发出预警，提醒驾驶员与位于正前方的车辆 RV 存在碰撞危险； 

4）预警时机需确保 HV 驾驶员收到预警后，能有足够时间采取措施，避免与 RV 发生追尾碰撞。

## d）HV 行驶，HV 视线受阻，RV-1 在 HV 同一车道正前方停止：

![image-20211027101506056](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101506056.png)

1）HV 跟随 RV-2 正常行驶，RV-1 在同一车道上 RV-2 的正前方停止，HV 的视线被 RV-2所遮挡； 

2）HV 和 RV-1 需具备短程无线通信能力，RV-2 是否具备短程无线通信能力不影响应用场景的有效性； 

3）RV-2 为了避开 RV-1 进行变道行驶； 

4）HV 行驶过程中在即将与 RV-1 发生碰撞时，FCW 应用对 HV 驾驶员发出预警，提醒驾驶员与位于正前方的 RV-1 存在碰撞危险； 

5）预警时机需确保HV驾驶员收到预警后，能有足够时间采取措施，避免与RV-1发生追尾碰撞。

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
```

# 二、交叉路口碰撞预警

交叉路口碰撞预警（ICW）是指，主车（HV）驶向交叉路口，与侧向行驶的远车（RV）存在碰撞危险，ICW应用将对HV驾驶员进行预警。**本应用适用于城市及教区普通道路及公路的交叉路口，环道入口，高速入口等交叉路口碰撞危险的预警。**

ICW应用辅助驾驶员避免或减轻侧向碰撞，提高交叉路口通行安全。

HV 驶向交叉路口，若与任意一辆驶向同一路口的 RV 存在碰撞危险时，ICW 应用对 HV 驾驶员进行预警。触发 ICW 功能的 HV 和 RV 位置关系如下图，其中 HV 和 RV 行驶方向不限于垂直交叉（90°），可为一定范围内的多角度交叉。

ICW 基本工作原理如下： 

分析接收到的 RV 消息，筛选出位于交叉路口左侧（intersecting left）或交叉路口右侧（intersecting right）区域的 RV。RV 消息可能是由 RV 发出或从路侧单元获取； 

进一步筛选处于一定距离范围内的 RV 作为潜在威胁车辆； 

计算每一个潜在威胁车辆到达路口的时间（TTI：time-to-intersection）和到达路口的距离（DTI：distance-to-intersection），筛选出与 HV 存在碰撞危险的威胁车辆；

若有多个威胁车辆，则筛选出最紧急的威胁车辆；

系统通过 HMI 对 HV 驾驶员进行相应的碰撞预警。

 ![image-20211027101536440](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101536440.png)

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
```

# 三、左转辅助

左转辅助（LTA：Left Turn Assist）是指，主车（HV）在交叉路口左转，与对向驶来的远车（RV）存在碰撞危险时，LTA 应用将对 HV 驾驶员进行预警。**本应用适用于城市及郊区普通道路及公路的交叉路口。** 

LTA 应用辅助驾驶员避免或减轻侧向碰撞，提高交叉路口通行安全。

LTA 的主要场景为，HV 在交叉路口左转，RV 从对面驶向路口（图 11）。具体描述如下： HV 和 RV 同时从相对的方向驶向交叉路口； 

HV 和 RV 需具备短程无线通信能力；

HV 启动并准备进入路口左转时，若系统检测到与对向来车 RV 存在碰撞危险，LTA 应用对HV 驾驶员发出预警；

预警时机需确保 HV 驾驶员收到预警后，能有足够时间采取措施，避免与 RV 发生碰撞。

![image-20211027101557589](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101557589.png)

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
pBsm->safetyExt->lights = ExteriorLights_leftTurnSignalOn //2 左转
```

# 四、盲区预警/变道辅助

盲区预警/变道预警(BSW/LCW)是指，当主车（HV）的相邻车道上有同向行驶的远车出现在HV盲区时，BSW应用对HV驾驶员进行提醒；当主车（HV）准备实施变道操作时（例如激活转向灯等），若此时相邻车道上有同向行驶到远车（RV）处于或即将进入盲区，LCW应用对HV驾驶员进行预警。**本应用适用于普通道路或高速公路等车辆变道可能存在碰撞危险的预警。**

BSW/LCW应用避免车辆变道时，与相邻车道上的车辆发生侧向碰撞，提高变道安全。

HV和RV同向行驶，HV和RV均为行驶的智能网联车辆，其内置HMI终端屏幕，能够实时查看告警显示结果。

①.HV于道路中央遵循既定轨迹行驶，同时RV从HV的右侧车道以高于HV的速度接近，到达一定范围内，该功能通过HMI对HV驾驶员发出预警，标识盲区内存有其他车辆，且车辆位于HV右侧。

②.触发工况①的告警后，驾驶员打开右转向灯表示变道行为，HMI的告警由盲区告警转变为变道预警。

![image-20211027101619121](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027101619121.png)

考虑安全因素，该场景为测试区演示场景，方式为V2V直接通信（BSM信息包）。

当RV在左侧，右侧车道，且位于HV纵向距离30m之内能够产生盲区告警，并能够从HMI显示的图标上判断出从车位置；此外，当从车位于其他区域时，不再触发该告警，则认为验收场景①通过。

在上述前提下，能够根据从车位置及相应转向灯（左后盲区对应左转向灯，右后盲区对应右转向灯）能够触发变道告警时，认为场景②通过。

说明：报文为BSM广播车辆信息，除车辆size外，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->safetyExt->lights = ExteriorLights_leftTurnSignalOn //2  or ExteriorLights_rightTurnSignalOn : 3
pBsm->size.width = width; //分辨率为cm，国标为5cm
pBsm->size.length = length; //分辨率为cm，国标为5cm
pBsm->size.height = height; //分辨率为cm，国标为5cm
```

# 五、逆向超车预警

逆向超车预警（DNPW）是指，主车（HV）行驶在道路上，因借用逆向车道超车，与逆向车道上的逆向行驶远车（RV）存在碰撞危险时，DNPW应用对HV驾驶员进行预警。**本应用适用于城市及郊区普通道路及公路超车变道碰撞危险的预警。**

DNPW应用于辅助驾驶员避免或减轻超车过程中产生的碰撞，提高逆向超车通行安全。

主要场景：

HV跟随RV-1行驶，HV准备超车，RV-2从相邻逆向车道上行驶而来，HV视线可能被RV-1遮挡。

HV和RV-1，RV-2需具备短程无线通信能力；

当HV打开变道转向灯并准备进入逆行车道时，DNPW应用对HV对驾驶员发出预警，提醒驾驶员与逆向来车RV02存在碰撞危险；

预警时机需确保HV收到预警后，能有足够的时间采取措施，避免与RV-2发生碰撞。

![image-20211027135555482](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135555482.png)

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
```

# 六、紧急制动

紧急制动预警（EBW）是指，主要应用在同一车道上，HV与前方行驶的RV存在一定距离，当前方RV进行紧急制动时，会将这一信息通过短程无线通信广播出来，HV收到广播信息，判断是否会存在危险，向HV驾驶员进行预警，避免因为前方车辆突然紧急刹车造成的追尾事故。**本应用适用于城市及郊区道路及公路。EBW应用辅助驾驶员避免或减轻车辆追尾碰撞，提高道路行驶安全。**

HV和RV同向行驶，HV和RV均为行驶的智能网联车辆，HV内置HMI终端屏幕，能够实时查看告警显示结果。

①.HV于道路中央遵循既定轨迹行驶，同时RV在HV的相同车道以大于20km/h的的速度行驶，且位于HV前方一定范围内，此时，两车正常行驶，无告警弹出。

②.当前方车辆RV进行紧急制动时，RV车载单元会将这一信息通过短程无线通信广播出来。主车接收并检测到前车的紧急状态，若判断与本车有关，则对驾驶员进行预警。当RV制动完成后，告警消失。

③.RV位于HV相邻车道时，采取与②相同操作，HV将判断该紧急情况与本车无关，无告警弹出。

![image-20211027135618615](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135618615.png)

考虑安全因素，该场景为测试区演示场景，方式为V2V直接通信（BSM信息包）。

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
pBsm->brakes.brakePadel = BrakePedalStatus_on; //2
```

# 七、异常车辆提醒

异常车辆提醒（ALW）是指，HV行驶中，当RV发生因车主意外情况点亮双闪警告后方车辆时候，该车可对外广播此类信息，若HV根据收到的消息识别出访车属于车辆异常状态，且可能影响HV行驶路线时，则异常车辆预警应用对HV驾驶员进行预警。**本应用适用于城市、郊区普通道路及高速公路可能发生车辆异常碰撞危险的预警。**

HV和RV同向行驶，HV和RV均为行驶的智能网联车辆，HV内置HMI终端屏幕，能够实时查看告警显示结果。

①.HV于道路中央遵循既定轨迹行驶，同时RV在HV的相同车道以大于20km/h的的速度行驶，且位于HV前方一定范围内，此时，两车正常行驶，无告警弹出。

②.当前方车辆RV点亮双闪，RV车载单元会将这一信息通过短程无线通信广播出来。主车接收并检测到前车的紧急状态，若判断与本车有关，则对驾驶员进行预警。当RV双闪关闭完成后，告警消失。

③.RV位于HV相邻车道时，采取与②相同操作，HV将判断该紧急情况与本车无关，无告警弹出。

![image-20211027135645639](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135645639.png)

考虑安全因素，该场景为测试区演示场景，方式为V2V直接通信（BSM信息包）。

当RV在与HV同向车道，且位于HV纵向距离XXX m之内能够在RV开启双闪警示等后产生告警；此外，当从车位于其他相邻或同车道后方时，不再触发该告警，则认为验收场景②，③通过。

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
pBsm->safetyExt->lights = ExteriorLights_hazardSignalOn  //4
```

# 八、车辆失控预警

HV和RV同向行驶（不限于在同一车道内），若RV出现车辆失控预警且与在后方HV存在碰撞危险时，CLW应用对HV驾驶员进行预警。HV和RV在相邻车道相向行驶，若RV在与HV会车前出现车辆失控，且与相向行驶的HV存在碰撞危险时，CLW应用对HV驾驶员进行预警。触发CLW功能的HV和RV的位置关系如图5（RV可位于HV前方车道的六个区域内）。

HV和RV同向行驶，HV和RV均为行驶的智能网联车辆，HV内置HMI终端屏幕，能够实时查看告警显示结果。

①.HV于道路中央遵循既定轨迹行驶，同时RV在HV的相同车道以大于20km/h的的速度行驶，且位于HV前方一定范围内，此时，两车正常行驶，无告警弹出。

②.当前方车辆RV进行产生制动抱死系统 ABS、车身稳定性系统ESP、牵引力控制系统TCS等紧急情况时（考虑到实际情况，测试时采用模拟数据模拟情景），RV车载单元会将这一信息通过短程无线通信广播出来。主车接收并检测到前车的紧急状态，若判断与本车有关，则对驾驶员进行预警。当RV制动完成后，告警消失。

③.RV位于HV相邻车道时，采取与②相同操作，若判断与本车有关，则对驾驶员进行预警。当RV恢复状态完成后，告警消失。

![image-20211027135805783](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135805783.png)

考虑安全因素，该场景为测试区演示场景，方式为V2V直接通信（BSM信息包）。

当RV在与HV同向车道，且位于HV纵向距离XXX m之内能够通过既定软件或配置文件修改RV的CAN总线数据，从而模拟ABS等失控情况时，后方的HV能够产生失控车辆告警；此外，当从车位于其他相邻或同车道后方时，不再触发该告警，则认为验收场景②通过。

当RV取消ABS信号后，HV不再产生告警，认为场景①通过。

在上述前提下，RV变道至HV相邻车道，RV仍模拟为ABS场景，HV仍然能够触发失控车辆告警时，认为场景③通过。

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
pBsm->safetyExt->events = VehicleEventFlags_eventABSactivated //2
```

# 九、道路危险状况提示

道路危险提示（HLW）是指，HV行驶到潜在危险状况（如桥下存在较深积水、路面有深坑、道路湿滑、前方急转弯等）路段，存在发生事故风险时，HLW应用对HV驾驶员进行预警。**本应用适用于城市道路、郊区道路和高速公路等容易发生危险状况的路段或者临时性存在危险状况的路段。**

HLW应用将道路危险状况及时通知周围车辆，便于驾驶员提前进行处置，提高车辆对危险路况的感知能力，降低驶入该危险区域的车辆发生事故的风险。

HV行驶于RSU信号覆盖区域，路侧模拟或检测前方道路危险情况，如果存在积水，障碍物等情况时：

①.HV驶近该检测到的危险区域，HMI能够收到前方道路危险告警。

②.HV驶离该模拟区域，HMI告警消失。

③．HV在道路危险构造区域的对向车道时，HMI不应当告警。

![image-20211027135831918](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135831918.png)

为保证效果，该场景可于高速验收展示，通信方式为V2I，以RSI传输道路危险信息。

让HV驶向设置或检测出了道路危险路段的区域，在距离危险区域一定阈值范围外（300m）时，HMI无告警提示，当接近300m后，HMI即刻播报道路危险路段提示，能够通过图标显示准确了解道路危险路段情况，认为场景①通过。

HV驶离道路危险区域后，即是危险区域位于HV后方，播报即刻停止，认为场景②通过。

当HV驶于道路危险反向车道时，HV的HMI不会播报任何道路危险信息，认为场景③通过。

说明：与国标基本一致，报文为RSI播报道路危险信息，OBU接收后提取alertType为37的RSI消息，判断是否在告警范围内，告警地点ref_Pos是否在车前方。

```js
pRSI->alertType=37;
pRSI->refPos.lat=lat*1e7;
pRSI->refPos.Long=long*1e7;
pRSI->alertPath[i].Long = (long)(path_lng[i]*1e7);
pRSI->alertPath[i].lat = (long)(path_lat[i]*1e7)
```

# 十、限速提醒（限速预警）

限速预警（SLW：Speed Limit Warning）是指，主车（HV）行驶过程中，在超出限定速度的情况下，SLW 应用对 HV 驾驶员进行预警，提醒驾驶员减速行驶。**本应用适用于普通道路及高速公路等有限速的道路。**

SLW 应用辅助驾驶员避免超速行驶，消除安全隐患，减少事故的发生。

HV行驶于有限速要求的道路区域。

①.HV提速，直至达到最高限速值，HMI播报限速提醒。

②.HV减速，直至小于最高限速值，限速提醒告警图标消失。

③．驶离限速区间，无论以何种方式行驶都不会触发HMI告警。

![image-20211027135851353](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135851353.png)

通信方式为V2I，以RSI传输路侧限速的数据。测试验收前应当提前告知限速的具体区间位置。

当HV行驶于约定的限速区间时，HV加速至大于约定的最高限速，HMI弹出告警，认为场景①通过。

当HV行驶于约定的限速区间时，HV减速至大于约定的最低限速，HMI弹出告警，认为场景②通过。

车辆驶离限速区间后，无论以超过最高速度还是低于最低限速值完成驾驶行为，HMI都不会弹出告警，则认为场景③通过。

说明：与国标基本一致，报文为RSI播报限速消息，OBU接收后提取alertType为39或者90的RSI消息，判断是否在告警路径范围内，告警方向是否是车辆行驶方向，车辆会在告警路径的第一点alertPath[0]进入，从最后一点alertPath[n]驶出，description的第一个和第二个字节用来发送具体限制的最高速度和最低速度，只发一个字节默认是最高速度，若不发description，则不报警。

```js
pRSI->alertType=39 or 90; 
pRSI->refPos.lat=lat*1e7;//lat为度格式的GPS维度，如28.1234567，所以乘以10的7次方转化为整数发送，路径中的数据同理
pRSI->refPos.Long=long*1e7;//long为度格式的GPS经度，如112.1234567，所以乘以10的7次方转化为整数发送，路径中的数据同理
pRSI->alertPath[i].Long = (long)(path_lng[i]*1e7);
pRSI->alertPath[i].lat = (long)(path_lat[i]*1e7)
pRSI->description->buf[0]=speed_limit_max;
pRSI->description->buf[1]=speed_limit_min;
```

# 十一、闯红灯预警

闯红灯预警（RLVW）是指，主车（HV）经过有信号控制的交叉口，车辆存在不按信号灯规定或指示行驶的风险时，RLVW应用对驾驶员进行预警。**本应用适用于城市及郊区道路及公路的交叉路口，环道出入口和可控车道，高速入口和隧道等有信号控制的车道**。闯红灯过程见下图。

![image-20211027135916383](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135916383.png)

主要场景：

当前方又打车遮挡实现或恶劣天气影响视线，或由于其他原因，使HV无法对当前红灯或即刻到来的红灯做出正确判断时，RLVW检测HV当前所处位置和速度等，通过计算预测车头经过路口停止线时信号灯的状态，并向驾驶员进行预警。

![image-20211027135926886](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135926886.png)

当HV驶向具有信号控制的交叉路口，遇到信号灯即将变红或正处在红灯状态，但车辆未能停止再停止线内而继续前行时，RLVW应用将对该车驾驶员进行预警。触发RLVW功能的HV与路口设施关系如下图

![image-20211027135936823](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027135936823.png)

说明：与国标基本一致，报文为MAP和SPAT消息,以下示例仅说明场景使用关键数据，其他数据按国标打包发送。

```js
Map:
pMap->nodes[i].id.region = 1;
pMap->nodes[i].id.id = XX;
pMap->nodes[i].refPos.lat = lat*1e7;
pMap->nodes[i].refPos.lon = lon*1e7;
pMap->nodes[i].inLink[j].movements[k].phaseId = XX;
pMap->nodes[i].inLink[j].laneWidth = 350;

SPAT:
pSPAT->intersections[i].intersectionId.id = XX //和map的nodeId一致
pSPAT->intersections[i].intersectionId.region = 1;
pSPAT->intersections[i].phases[j].id = xx;//和movements[k].phaseId匹配
pSPAT->intersections[i].phases[j].light = LightState_stop_Then_Proceed ;//2 红灯
pSPAT->intersections[i].phases[j].timing.likelyEndTime=xx;
```

# 十二、弱势交通参与者碰撞预警（高速行人/非机动车辆横穿预警）

弱势交通参与者碰撞预警（VRUCW：Vulnerable Road User Collision Warning）是指，主车（HV）在行驶中，与周边行人（P，Pedestrian。含义拓展为广义上的弱势交通参与者，包括行人、自行车、电动自行车等，以下描述以行人为例）存在碰撞危险时，VRUCW 应用将对车辆驾驶员进行预警，也可对行人进行预警。**本应用适用于高速公路的碰撞危险预警。**

VRUCW 应用辅助驾驶员避免或减轻与行人（P）碰撞危险，提高车辆及行人通行安全。

①.行人慢慢走入HV前方的摄像头感知区域，此时HMI上弹出图标告警，且显示本车与行人之间的距离，该距离会随着行人的实际位置而实时变化。

②.行人离开摄像头感知区域或HV驶离行人，此时HMI上告警信号消失。

③．行人位于HV反向车道时，HMI上不应当产生告警干扰驾驶员判断。

![image-20211027140023127](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027140023127.png)

为保证效果，该场景可与高速验收展示，但为确保安全，行人位于应急车道上，通信方式为V2I，以RSM传输路侧感知行人的数据。

当在HV前方同向车道存在行人时，HV的HMI弹出告警，能够根据行人位置移动实时改变车辆与行人的距离，认为场景①通过。

车辆驶离行人后，HMI告警消失，则认为场景②通过。

在HV反向车道出现行人时，HMI告警不弹出，则认为场景③通过。

说明：与国标基本一致，报文为RSM播报参与者信息，OBU接收后提取ptcType为 ParticipantType_pedestrian的list节点实现处理。

```js
pParticipantData->ptcType =ParticipantType_pedestrian;
pParticipantData->ptcId  =MSG_PEDESTRIAN;//1
pParticipantData->source  =SourceType_video;
pParticipantData->pos.offsetLL.present=PositionOffsetLL_PR_position_LatLon;
pParticipantData->pos.offsetLL.choice.position_LatLon.lon =  xx;// 经度*1e7
pParticipantData->pos.offsetLL.choice.position_LatLon.lat =xx;// 纬度*1e7
pParticipantData->accuracy.pos=PositionConfidence_a1cm;
pParticipantData->speed=rsmInfo->participants[i].speed;//行人速度/7.2，无法探知则为0
pParticipantData->heading=rsmInfo->participants[i].heading//行人方向/1.25，无法探知则为0xffff。
pParticipantData->size.width =xx;
pParticipantData->size.length =xx;
```

# 十三、绿波车速引导

绿波车速引导（GLOSA）是指，当装载车载单元（OBU）的HV驶向信号灯控制交叉路口，收到由路侧单元（RSU）发送的道路数据及信号灯实时状态数据时，GLOSA应用将给予驾驶员一个建议车速区间，以使车辆能够经济地，舒适地（不需要停车等待）通过信号路口。**本应用适用于城市及郊区普通道路信号灯控制路口。**

GLOSA应用能辅助驾驶应用，提高车辆通过交叉路口的经济性与舒适性。提升交通系统效率。

主要场景：

GLOSA 主要场景见下图。具体描述如下： 

HV 从远处接近信号灯控制路口； 

路侧通信设备发出局部道路数据信息及从路口信号机处获得信号灯数据信息和实时状态信息； 

GLOSA 应用根据上述信息，给出 HV 前方信号灯的实时状态，并结合 HV 的定位和行驶状态信息，计算出通过路口的引导车速区间。

![image-20211027140047295](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027140047295.png)

说明：与国标基本一致，报文为MAP和SPAT消息,以下示例仅说明场景使用关键数据，其他数据按国标打包发送。

```js
Map:
pMap->nodes[i].id.region = 1;
pMap->nodes[i].id.id = XX;
pMap->nodes[i].refPos.lat = lat*1e7;
pMap->nodes[i].refPos.lon = lon*1e7;
pMap->nodes[i].inLink[j].movements[k].phaseId = XX;
pMap->nodes[i].inLink[j].laneWidth = 350;
 
SPAT:
pSPAT->intersections[i].intersectionId.id = XX //和map的nodeId一致
pSPAT->intersections[i].intersectionId.region = 1;
pSPAT->intersections[i].phases[j].id = xx;//和movements[k].phaseId匹配
pSPAT->intersections[i].phases[j].light = LightState_stop_Then_Proceed ;//2 红灯
pSPAT->intersections[i].phases[j].timing.likelyEndTime=xx;
```

# 十四、车内标牌（道路标识牌检测与响应）

车内标牌（IVS：In-Vehicle Signage）是指，当装载车载单元（OBU）的HV收到由路侧单元（RSU）发送的道路数据以及交通标牌信息，IVS 应用将给予驾驶员相应的交通标牌提示，保证车辆的安全行驶。**本应用适用于任何交通道路场景。**

IVS 能提高车辆行驶的安全性。

HV停于路侧应急带（仅为方便测试，也可以改为行驶的车辆），摄像头观测区域为HV前方一定范围内。

①.当前方一定范围内存在道路指示标牌时HV的HMI上弹出图标进行道路标牌指示，内容与实际标牌保持一致。

②.当HV驶离标牌后，HV的HMI上无该项告警。

③．HV从标牌对~~象~~向车道接近该标牌，HMI上不会弹出相应电子标牌。

![image-20211027140120377](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027140120377.png)

当HV动态行驶至接近标牌且距离标牌300m左右时，达到提前设定的阈值区域，HMI播报电子标牌提醒，标牌信息与路侧一致时，认为场景①通过。

HV驶过标牌，HMI消失，且在其他非该标牌路段不会误报该场景（反向接近也不会报），则认为场景②和③通过。

说明：与国标基本一致，报文为RSI播报标牌消息，OBU接收RSI消息后，会判断alertType是否是标牌枚举中的元素。判断是否在告警路径范围内，告警方向是否是车辆行驶方向，车辆会在告警路径的第一点alertPath[0]进入，从最后一点alertPath[n]驶出，description用来存储具体信息。

```js
pRSI->alertType=XX; 
pRSI->refPos.lat=lat*1e7;//lat为度格式的GPS维度，如28.1234567，所以乘以10的7次方转化为整数发送，路径中的数据同理
pRSI->refPos.Long=long*1e7;//long为度格式的GPS经度，如112.1234567，所以乘以10的7次方转化为整数发送，路径中的数据同理
pRSI->alertPath[i].Long = (long)(path_lng[i]*1e7);
pRSI->alertPath[i].lat = (long)(path_lat[i]*1e7)
pRSI->description->buf[0]=XX;
```

# 十五、拥堵路段通行（前方拥堵提醒）TJW

拥堵路段通行（TJW）是指，主车(HV)从远处接近相应的路侧单元(RSU),路侧单元(RSU)周期性广播局部道路拥堵数据信息；主车OBU接收到RSU发送的拥堵信息，结合本车的定位和行驶状态，计算本车在路网中的信息，并判断前方是否有拥堵，如果有拥堵，则对驾驶员进行前方拥堵的提示。

TJW应用提醒驾驶员前方路段拥堵，有助于驾驶员合理制定行车路线，提高道路通行效率。

HV在道路上沿着既定车道线同向行驶，HV为具备车载单元OBU的智能网联车辆。

①.在HV行驶路径前方，人为模拟出拥堵情景（将拥堵阈值设置较低，人为触发），HV能够收到路侧设备发送过来路侧感知信息包，解析后可以获取拥堵信息，并弹出相应告警信息。

②.人为解除拥堵情况后，告警图标消失。

![image-20211027140141230](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027140141230.png)

说明：报文为RSI播报拥堵信息，车辆会在告警路径的第一点alertPath[0]进入，从最后一点alertPath[n]驶出，OBU接收后提取alertType 为 0x0707的list节点实现处理。

```js
pRsi->alertType =0x0707 //来自《GBT29100-2012道路交通信息服务交通事件分类与编码》
pRsi->refPos.lat = xx;// 纬度 *1e7
pRsi->refPos.Long = xx;// 经度 *1e7
pRsi->alertPath.list存放路径list，决定道路航向角
```

# 十六、紧急车辆提醒

紧急车辆提醒（EVW）是指，主车行驶在道路上，遇到消防车，救护车，警车或者其他紧急车辆呼叫时，通过车-车通讯（V2V）了解到紧急车辆的方位，能有效让行，紧急车辆提醒应用对主车驾驶员进行预警。

HV和RV同向行驶，HV和RV均为行驶的智能网联车辆，且RV模拟为紧急车辆，HV内置HMI终端屏幕，能够实时查看告警显示结果。

①.HV于道路中央遵循既定轨迹行驶，同时RV在HV较远距离以大于20km/h的速度行驶，且位于HV前方一定范围外，此时，两车正常行驶，无告警弹出。

②.当前方车辆RV接近HV且到达一定阈值时，HV触发紧急车辆提醒告警。

③.根据RV位置，HMI告警图标会显示RV的相对位置。

④.RV加速超过HV，并距离达到一定阈值后，告警图标消失。

![image-20211027140300558](https://gitee.com/er-huomeng/l-img/raw/master/image-20211027140300558.png)

说明：报文为BSM广播车辆信息，基本与国标一致，以下只说明场景所需关键数据，其他必备数据和根据国标自动进行打包

```js
pBsm->pos.lat = lat*1e7;
pBsm->pos.Long = lon*1e7;
pBsm->heading = heading/1.25; // heading为度*100
pBsm->speed = speed/7.2; //speed为km*100/h
pBsm->accelSet.Long = acc_lon*10;
```