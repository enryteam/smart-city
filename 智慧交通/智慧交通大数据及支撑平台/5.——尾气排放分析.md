# 尾气排放分析

## 1.1 概述

机动车排放污染已经成为我国城市发展中的一个重要环境问题。随着社会经济的快速发展和人们生活质量的提高，机动车保有量快速增长，巨大的机动车尾气排放量使得机动车尾气逐渐成为城市的主要污染源。因此，对尾气计算进行研究具有一定的意义。

计算机动车尾气排放量时，通常采用规范提供的排放因子法。排放因子法是根据某种车型行驶距离，以及每种污染物排放因子系数来计算污染物排放量。该方法是根据某种车型机动车行驶一段距离后所消耗的油量以及对应的油耗排放系数来计算污染物排放量。

而本系统中采用的是基于Hadoop的城市交通尾气计算模型，这里先介绍下这两种计算方法。

### 1.1.1 传统的计算模型

#### 1.1.1.1 排放因子

JTGB03-006《公路建设项目环境影响评价规范》中提出了如下污染物排放量计算公式。

![image-20210727155146164](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155146164.png)

为定量确定车辆在公路上行驶过程中排放的污染物数量，需确定各种车型在一定速度时的单车污染物排放因子，即每辆车行驶单位里程所排放的污染物数量，排放因子公式根据环评规范中给的排放值范围来拟合。以颗粒物为例，对各车型速度与颗粒物排放进行拟合其拟合结果如表所示：

![image-20210727155203100](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155203100.png)

![image-20210727155209277](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155209277.png)

![image-20210727155216427](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155216427.png)

速度值对于已建公路取调查的平均速度，新建公路取预测速度，预测速度计算公式采用JTGB03.2006规定的公式：

![image-20210727155226469](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155226469.png)

![image-20210727155235854](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155235854.png)

#### 1.1.1.2 油耗计算法

利用各种污染物的排放系数来计算其排放量，称为油耗计算法。油耗法计算公式如下：

![image-20210727155257557](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155257557.png)

**表**6.91**各车型各类排放系数表**

| **车型**       | **CO** | **氮氧化合物** | **颗粒物** | ![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml59492\wps98.jpg) |
| -------------- | ------ | -------------- | ---------- | ------------------------------------------------------------ |
| 小汽车(汽油)   | 287.74 | 11.2           | 0.106      | 2322.21                                                      |
| 中客车(汽油)   | 287.74 | 11.2           | 0.106      | 2322.21                                                      |
| 中客车(柴油)   | 15.11  | 10.35          | 0.493      | 2439.96                                                      |
| 大客车(柴油)   | 30.26  | 49.66          | 1.64       | 2455.85                                                      |
| 小货车(柴油)   | 16.58  | 30.87          | 1.02       | 2455.00                                                      |
| 中货车(柴油)   | 16.58  | 30.87          | 1.02       | 2455.00                                                      |
| 大货车(柴油)   | 30.26  | 49.66          | 1.64       | 2455.85                                                      |
| 特大货车(柴油) | 33.96  | 50.5           | 1.71       | 2468.94                                                      |

### 1.1.2 基于Hadoop的城市交通尾气计算模型

本系统基于hadoop技术的城市交通路网排放数据挖掘，探讨城市交通路网排放的时空分布情况，对实施节能减排的规划具有非常重要的参考意义。

本系统中之所以采用Hadoop技术，是充分结合实验实际情况，考虑了交通数据本身特点，即大部分采集到的交通数据都有一定量的冗余，而且其吞吐量较大。因此在通常情况下，很多企业或部门会采用数据仓库这种技术手段来处理交通数据，而本文所提出的基于Hadoop技术的处理方式相比于数据仓库，有其独特的优势：数据处理时效性更强，基础设备价格廉价，投资较小，更加适合于小规模应用的推广。

#### 1.1.2.1 交通碳排放模型

通过对现有数据进行分析，并参考相应文献资料，本系统采用了基于行驶里程的交通路网碳排放计算模型，其基本表达式为：

![image-20210727155346789](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155346789.png)

![image-20210727155354845](https://gitee.com/er-huomeng/l-img/raw/master/img/image-20210727155354845.png)

#### 1.1.2.2 关键算法实现

根据模型需求构建4个主要模块，即数据清洗、排放计算、聚类分析和制图渲染模块。数据清洗模块主要负责在模型运算前对数据进行清洗，剔除不合理的数据。由于道路线圈收集数据受到车辆速度和自身状况等因素的影响，采集的数据并不总是能够反映真实的交通状况，所以需要进行预处理。排放计算模块根据实验所使用的计算模型，计算每一个时段的路段排放，对结果进行累加，得到以天为单位的CO2据；然后根据以天为单位的排放数据，还可以合成累加生成以月为单位的排放数据以供参考。聚类分析根据CO2排放量，以某一初始值为中心，进行多次迭代运算过程，寻找合适的中心值，将道路分成若干排放等级，为后续的制图渲染模块提供数据基础。制图渲染模块首先将聚类后的数据进行栅格化，然后以CO2放量值为依据进行着色渲染，再经过图块拼接，最后生成实验数据成果图。

Ø 排放计算中的MapReduce处理流程

根据计算的时间精度，可以使用多阶段的MapReduce完成路段排放量计算。Map阶段，使用记录的时间作为Key，根据速度等属性，按照模型计算该时间段内的路段气体排放。Reduce阶段，根据时间段合并规则，对排放进行分时段累加，得到分时段路段排放记录。对于有多重时间精度需要的情况，可以根据原始记录的时间分辨路段。首先计算出最小时间尺度的路段排放记录；然后根据不同的时间精度，对计算结果在此运用类似的MapReduce流程进行合并。

Ø 聚类分析中的 MapReduce 处理流程

聚类分析过程较为繁琐，为了获得较为准确的分类结果，需要进行多次迭代过程。Map阶段，首先给定K个中心值，作为初始运算的基本参照，利用每一个record值，计算排放值与这K个中心值的距离，将其中距离最小的对应类别M作为它的同类。 Reduce阶段，把所有类别相同的值进行重新计算，以获得其新的中心值，进一步地详细分类。按照上述步骤，如此迭代循环，直到所有类别中的数值不再发生变化为止。