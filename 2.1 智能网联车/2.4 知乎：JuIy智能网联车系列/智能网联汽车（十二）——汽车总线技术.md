- [智能网联汽车（十二）——汽车总线技术](https://zhuanlan.zhihu.com/p/378245814)

汽车总线是指汽车内部导线采用总线控制的一种技术，通常称为汽车总线或汽车总线技术。随着电子技术的迅速发展和在汽车上的广泛应用，汽车电子化程度越来越高。从发动机控制系统到传动系控制系统，从行驶、制动、转向控制系统到安全保证系统以及仪表报警系统渐渐形成了一个复杂的大系统。目前，车用总线技术被美国汽车工程师协会SAE下属的汽车网络委员会按照协议特性分为A、B、C、D4类。

![image-20220215143024680](https://gitee.com/er-huomeng/l-img/raw/master/l-img/image-20220215143024680.png)

## **一、LIN总线**

LIN(Local Interconnect  Network,局域互联协议）是由Audi、BMW、Daimler-Chrysler、Motorola、Volcano  Communications  Technologies(VCT通信技术公司）Volkswagen(大众）和Volvo等公司和部门（LIN联合体）提出的一个汽车底层网络协议，是一种新发展的汽车子总线系统，其目的是给出一个价格低廉、性能可靠的低速网，在汽车网络层次结构中作为低端网络的通用协议，并逐渐取代目前各种各样的低端总线系统。这个标准与其相应的开发、测试以及维护平台的应用，将会降低车上电子系统开发、生产、使用和维护的费用。

### **1.LIN总线的通信系统**

LIN包含一个宿主节点（Master)和一个或多个从属节点（Slave)。所有节点都包含一个被分解为发送和接收任务的从属通信任务，而宿主节点还包含一个附加的宿主发送任务。在实时LIN中，通信总是由宿主任务发起的。除了宿主节点的命名外，LIN网络中的节点不使用有关系统设置的任何信息。可以在不要求其他从属节点改变硬件和软件的情况下向LIN中增加节点。宿主节点发送一个包含同步中断、同步字节和消息识别码的消息报头，从属任务在收到和过滤识别码后被激活并开始消息响应的传输。响应包含2个、4个或8个数据字节和一个检查和（checksum)字节。报头和响应部分组成一个消息帧。LIN总线上的所有通信都由主机节点中的主机任务发起，主机任务根据进度表确定当前的通信内容，发送相应的帧头，并为报文帧分配帧通道。总线上的从机节点接收帧头之后，通过解读标识符确定自己是否应该对当前通信做出响应、做出何种响应。基于这种报文滤波的方式，LIN可实现多种数据传输模式，且一个报文帧可以同时被多个节点接收利用。

![img](https://pic4.zhimg.com/80/v2-8a95e56f4613b2bba1cba494ec33a0c7_720w.jpg)

LIN Bus系统结构

### **2.LIN总线特点**

(1)可靠传输。信号传输时间可靠；LIN总线传输速率很高，最高速率可以达到20Kb/s;一个主控器和多个从设备模式不需要仲裁机制。

(2)低成本。LIN总线较少的信号线就可符合国际标准的相关规定；在节点处无需陶瓷振荡器或晶振就可以实现自同步，大大降低使用成本。

(3)在网络上增加新的节点不需要在LIN从节点做硬件和软件更改。

### **3.LIN总线的应用**

LIN总线在汽车上得到广泛应用，如汽车的方向盘相关部件、汽车座椅控制、车门控制系统和车载传感器等。LIN可以很容易地连接到汽车网络中的智能传感器、制动器或光敏器件等，并且得到十分方便的维护和服务。LIN总线的系统用数字信号量将模拟信号量替换，使得LIN总线性能提升很大。

## **二、CAN总线**

CAN总线是ISO国际标准化的串行通信协议。在汽车产业中，出于对安全性、舒适性、方便性、低公害、低成本的要求，各种各样的电子控制系统被开发了出来。由于这些系统之间通信所用的数据类型及对可靠性的要求不尽相同，由多条总线构成的情况很多，线束的数量也随之增加。为适应“减少线束的数量”“通过多个LAN,进行大量数据的高速通信”的需要，CAN总线应运而生。

### **1.CAN总线的通信**

在各节点的CAN总线均可以实现互相自由通信：多主竞争式总线结构是CAN总线的通信特点，CAN总线上任意节点可在任意时刻主动地向网络上其他节点发送信息而不分主次，并且可在各个通信节点之间自由通信。

传统的站地址编码被CAN总线协议废除了，而对通信数据模块进行编码，这种方法的优点是可以使CAN总线的节点个数理论上在网络内没有限制。数据块编码的标识符可以由29或11位二进制数组成，因而有2或2个以上不同的数据块可以被定义，这种数据块编码的方式，还可以使相同的数据被不同的节点同时接收到，这一方式在分布式控制系统中普遍使用。为了保证通信的实时性，使得数据段长度最多为8字节，并且8字节不会占用总线时间过长。为了保证数据通信的可靠性，CAN协议采用了CRC检验并可提供相应的错误处理功能。因为CAN总线的功能强大，所以越来越受到行业的重视。

CAN总线对通信数据的成帧处理的完成：CAN总线通信可完成对通信数据的成帧处理，包括数据块编码、信息传输、位填充、循环沉余检验、优先级判别等工作。在接口中集成了CAN协议的物理层的功能。

### **2.CAN总线的特点**

(1)CAN总线在数据通信传输时没有主从之分，任意一个节点都可以向其他任何节点(一个或多个）发起数据通信，靠各个节点信息优先级先后顺序来决定通信次序。

(2)对于CAN总线上的通信，在多个节点同时发起通信时，优先级高的先通信，优先级低的及时避让，因而通信线路不会拥堵。

(3)CAN总线是两根导线较接连接，可以避免信号干扰，使得信号传输更加可靠。

(4)如果某个节点在通信时发生了严重错误，节点通信能够自动离开总线的功能。

(5)CAN总线是双绞线。CAN总线的实时性要求比较高，因而CAN总线适用于大数据量短距离通信或者长距离小数据量通信。

### **3.CAN总线在设备的应用**

CAN总线可以分为高速CAN和低速CAN,高速CAN系统传输速率为500Kb/s,主要控制ECU、ABS等模块的信号传输；低速CAN系统传输速率为125Kb/s,主要控制仪表、防盗等。

![image-20220215143109428](https://gitee.com/er-huomeng/l-img/raw/master/l-img/image-20220215143109428.png)

## 三、FlexRay总线

高速容错网络协议（FlexRay)是一种用于汽车的高速、可确定性的，具备故障容错能力的总线技术，它将事件触发和时间触发两种方式相结合，具有高效的网络利用率和系统灵活性特点，可以作为新一代汽车内部网络的主干网络。FlexRay总线数据收发采取时间触发和事件触发的方式。利用时间触发通信时，网络中的各个节点预先知道彼此将要进行通信的时间，接收器提前知道报文到达的时间，报文在总线上的时间可以预测出来，FlexRay协议也可以确保将信息延迟和抖动降至最低，尽可能保持传输的同步与可预测。这对需要持续及高速性能的应用（如线控制动、线控转向等）来说是非常重要的。

### **1.FlexRay通信架构**

FlexRay总线将车载网络中的独立完成相应功能的控制单元视为节点，主要有电源供给系统（Power Supply)、主处理器（Host)、固化FlexRay通信控制器（Communication  Controller)、可选的总线监控器（Bus Guardian)和总线驱动器（Bus  Driver)等。主处理器提供和产生数据，并通过FlexRay通信控制器传送出去。其中BD和BG的个数对应于通道数，与通信控制器和微处理器相连。总线监控逻辑必须独立于其他的通信控制器。总线驱动器连接着通信控制器和总线，或是连接总线监控器和总线。节点的两个通信过程如下。

(1)发送数据：Host将有效的数据送给CC,在CC中进行编码，形成数据位流，通过BD发送到相应的通道上。

(2)接收数据：在某一时刻，由BD访问栈，将数据位流送到CC进行解码，将数据部分由CC传送给Host。

![img](https://pic4.zhimg.com/80/v2-3e7176c233998755218c2f897334004b_720w.jpg)

FlexRay 节点

### 2.FlexRay总线的应用

宝马公司在2007款X5系列车型的电子控制减振器系统中首次应用了FlexRay技术，此款车采用基于飞思卡尔的微控制器和恩智浦的收发器，可以监视有关车辆速度、纵向和横向加速度、方向盘角度、车身和轮胎加速度及行驶高度的数据，实现了更好的乘坐舒适性及驾驶时的安全性和高速响应性，此外还将施加给轮胎的负荷变动及底盘的振动均减至最小。

## 四、MOST总线

MOST是Media Oriented Systems Transport的缩写，中文名称为“多媒体传输系统”，是一种用于多媒体数据传输的网络系统，该系统将符合地址的信息传送到某一接收器上，在这一点上，与CAN总线是不同的。

### **1.MOST总线的通信**

MOST网络以光纤为载体，通常是环状拓扑结构，布线只需单根光纤。MOST可提供高达50Mb/s的传输速率，远远超过传统车载网络。常见的MOST网络有3~10个节点。一个时序主控者负责驱动系统时钟、生成帧数据即64字节序列数据。可以同时满足15个不同音频流的播放，环中的每一个节点都代表着多媒体设备。剩下的节点都充当从控者，有一个节点充当用户控制界面或MMI。一般来说，这个节点也是时序主控者。

### **2.MOST总线特点**

(1)传输速度快。

(2)声音、图像的实时处理。

(3)可以与多种网络连接。

(4)在物理层上，传输介质本身是有塑料保护套、内芯为1mm的聚甲基丙烯酸甲酯光纤，允许采用多种拓扑结构，包括星状和环状，汽车基本都采用环状拓扑结构。一个MOST网络中最多可以有64个节点。

![img](https://pic1.zhimg.com/80/v2-9387d3ec1c046bd4c25ef37f17d97ddc_720w.jpg)

MOST系统采用环状拓扑结构

### **3.MOST总线的应用**

MOST总线由于传输数据量大、损耗小、速度快、抗干扰性强，故可连接汽车音响系统、视频导航系统、车载电视、高保真音频放大器、车载电话、CD播放器等模块。因此，目前高端汽车大多数采用MOST系统连接其车载影音娱乐系统。