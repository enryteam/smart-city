- [车联网系统如何架构？](http://www.woshipm.com/pd/1296408.html)

## 一、车联网系统架构

车联网技术的关键功能是驾驶者，可以通过移动设备远程控制汽车、监控汽车的安全性，因此，车、车联网平台以及用户APP端组成一个完整的车联网系统。

![img](http://image.woshipm.com/wp-files/2018/08/x9DN5e4a2yTyrLFy0MBU.png)

每一辆车辆作为一个独立的个体连入车联网系统当中，车辆的中控系统、网关系统以及电控系统是车联网的重要硬件基础，中控系统、网关系统以及电控系统主要有组成如下：

- **中控系统：**空调控制系统、车载娱乐信息系统、车载导航定位系统；
- **网关系统：**T-Box（主要包括GPS/AGPS、SIM，部分自带电源的低功耗GPS）；
- **电控系统：**汽车数字化仪表、车身控制模块BCM、电池管理系统BMS、行车电脑ECU、发动机管理系统EMS……

车联网平台主要功能有车辆信息管理、车辆监控、车辆控制以及车辆数据统计分析。

- **信息管理：**车型、T-Box、电池、传感器、SIM卡等；
- **车辆监控：**位置、故障、CAN数据等；
- **车辆控制：**车锁、车门、车灯、车窗等控制；
- **数据统计：**车速、电量、里程、故障等。

用户APP可以直接与车联网平台数据交互，或者通过第三方业务平台中转数据至车联网平台的，用户APP主要功能是车辆控制，车锁、车门、车灯、车窗的车身系统进行控制。

## 二、车联网系统内部通讯

车载设备控制器与车载T-Box组成局域网络，而车载T-box可以访问互联网，因此车载设备、车联网平台、用户手机APP可以进行相互之间的数据交互。

### 1. T-Box与车辆通讯

**（1）CAN BUS**

- **高速CAN总线：**速率可达到500kb/s，传递信息量较大、速度快，用于驱动系统的，主要连接发动机控制单元、ABS控制单元、安全气囊控制单元、组合仪表等行车系统；
- **低速CAN总线：**速率为100kb/s，用于车身系统，主要连接中控锁、电动门窗、后视镜、车内照明灯等对数据传输速率要求不高的车身系统；

目前汽车上的CAN总线连接方式主要包括高速、低速CAN总线两种，此外中高级轿车还有一些如娱乐系统或智能通讯系统的总线，它们的传输速率更高，可以超过1Mb/s。

**（2）OBD**

OBD能监测发动机、催化转化器、颗粒捕集器、氧传感器、排放控制系统、燃油系统、EGR等系统和部件。

- OBD通过各种与排放有关的部件信息，连接到电控单元ECU，ECU能检测和分析与排放相关故障；
- 当出现排放故障时，ECU记录故障信息和相关代码，并通过故障灯发出警告，告知驾驶员；
- ECU通过标准数据接口，保证对故障信息的访问和处理。

**（3）I/O硬件**

I/O硬件控制车辆是通过继电器的闭合控制车辆的部分系统，主要用于改装车辆。由于车辆主机厂的CAN协议无法获取，只能通过改装车辆，采用T-Box直接与某些系统相连，中间通过继电器的闭合控制。

### 2. 车辆与车联网平台通讯

车辆与车联网平台通过在T-Box上安装的2G、3G、4G网卡可以将车载T-Box连入互联网，将车辆实时的状态数据以报文的形式上报给车联网平台，车联网平台也主动下发指令给T-Box控制车辆。

（1）车辆上报给车联网平台的上行数据包括车辆状态（车辆状态、运行模式、车速、里程、档位、加速踏板行程值、制动踏板状态）、定位数据（经度、纬度、速度等）、BCM状态（中控锁、后备箱、车窗、车灯、喇叭、车门等车身部件状态）、EAS状态（空调状态、AC状态、PTC、循环、风向、风量档位等）。

上报数据的方式主要有：

- 周期性上报，每隔一段时间T-Box主动上报车辆的状态数据；
- 触发式上报，当车辆某些状态数据发生变化时，T-Box上报车辆数据，例如：车辆启动时；
- 即时召读，车联网平台主动查询数据，下发获取数据指令，T-Box即时反馈车辆状态数据；
- 反馈上报，通过车联网平台下发控制指令后，反馈指令执行结果。

（2）车联网平台下发指令给车辆的下行指令主要包括车辆控制（车门、车窗、空调、中控、车灯、后备箱、电机等开关控制）、空调控制（开关、风速、冷热、风向、风量等），分为以下三个步骤：

- 车联网平台下发指令至T-Box；
- T-Box下发指令至车辆系统；
- 执行结果反馈给车联网平台。

### 3. 车联网平台与用户APP通讯

目前用户可直接通过手机APP与车联网平台交互，或者先与独立的业务平台交互，再由业务平台与车联网平台交互，此种方式多用于分时租赁。用户可下发对车辆的控制指令以及获取的车辆的状态数据。

**（1）控制指令**

用户通过APP控制车辆主要是车锁、车门、车窗、后备箱、空调的控制。

**（2）状态数据**

用户需要获取车辆的状态数据主要是车锁、车门、车窗、后备箱、空调的实时状态以及下发控制指令的结果反馈信息。

### 4. 车辆与手机APP直接通讯

车辆与手机蓝牙通讯主要防止车辆在无信号场景下，无法通过网络实现手机对车辆的控制，因此车辆与手机的蓝牙通讯主要实现车辆的门锁控制、启动授权。

**（1）静态绑定**

静态绑定适用于私家车的使用场景，手机和车辆一对一长期绑定。

- 在车联网平台录入车辆信息时录入手机的蓝牙信息以及MAC地址，并将信息下发至车载T-Box，并且将车载蓝牙信息下发至手机，完成车辆与手机蓝牙的绑定。
- 手机申请绑定车载蓝牙，发送手机蓝牙信息以及Mac地址至车联网平台，再由车联网平台转发至车辆T-box中，并且将提前录入车联网平台的车载蓝牙信息发送至手机，完成手机与车辆的蓝牙的绑定。

**（2）动态绑定**

- 车载SIM卡有信号，手机申请绑定车载蓝牙，发送手机蓝牙信息、Mac地址至车联网平台，再由车联网平台转发至车辆T-box中，并将提前录入车联网平台的车载蓝牙信息发送至手机，完成手机与车辆的蓝牙的绑定；
- 车载SIM卡无信号，手机申请绑定车载蓝牙，发送手机蓝牙信息、Mac地址至车联网平台，由车联网平台转发至车辆T-box中但无法接受，此时可将存储在车联网平台中上次用车完成车辆生成的蓝牙配对信息下发至用户手机，完成手机与车辆的蓝牙的绑定。此种方式下每次使用该蓝牙配对信息完便生成新的配对信息。